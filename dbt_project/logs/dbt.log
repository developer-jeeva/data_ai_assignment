[0m12:07:27.916364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0823848B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D08353FDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D08353FC10>]}


============================== 12:07:27.925352 | 667f1762-f4d0-407a-9a21-80d04d016bd2 ==============================
[0m12:07:27.925352 [info ] [MainThread]: Running with dbt=1.11.4
[0m12:07:27.926369 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\jeeva\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt debug', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jeeva\\Desktop\\data_ai_assignment\\dbt_project\\dbt_project\\logs'}
[0m12:07:27.947247 [info ] [MainThread]: dbt version: 1.11.4
[0m12:07:27.955170 [info ] [MainThread]: python version: 3.10.19
[0m12:07:27.956193 [info ] [MainThread]: python path: C:\Users\jeeva\miniconda3\envs\data_ai_assessment\python.exe
[0m12:07:27.956193 [info ] [MainThread]: os info: Windows-10-10.0.26200-SP0
[0m12:07:28.867118 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m12:07:28.867118 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m12:07:28.867118 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m12:07:28.957337 [info ] [MainThread]: Using profiles dir at C:\Users\jeeva\.dbt
[0m12:07:28.957337 [info ] [MainThread]: Using profiles.yml file at C:\Users\jeeva\.dbt\profiles.yml
[0m12:07:28.965396 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\dbt_project\dbt_project.yml
[0m12:07:28.966411 [info ] [MainThread]: adapter type: snowflake
[0m12:07:28.966411 [info ] [MainThread]: adapter version: 1.11.2
[0m12:07:29.116038 [info ] [MainThread]: Configuration:
[0m12:07:29.116038 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:07:29.116038 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:07:29.116038 [info ] [MainThread]: Required dependencies:
[0m12:07:29.116038 [debug] [MainThread]: Executing "git --help"
[0m12:07:29.128486 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m12:07:29.129748 [info ] [MainThread]: Connection:
[0m12:07:29.130527 [info ] [MainThread]:   account: OW84266.ap-sotheast-1
[0m12:07:29.131260 [info ] [MainThread]:   user: JEEVATJ
[0m12:07:29.131260 [info ] [MainThread]:   database: INDUSTRIAL_PROCUREMENT_DB
[0m12:07:29.131260 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m12:07:29.131260 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m12:07:29.131260 [info ] [MainThread]:   schema: ANALYTICS
[0m12:07:29.131260 [info ] [MainThread]:   authenticator: None
[0m12:07:29.135245 [info ] [MainThread]:   oauth_client_id: None
[0m12:07:29.136273 [info ] [MainThread]:   query_tag: None
[0m12:07:29.136273 [info ] [MainThread]:   client_session_keep_alive: False
[0m12:07:29.136273 [info ] [MainThread]:   host: None
[0m12:07:29.136273 [info ] [MainThread]:   port: None
[0m12:07:29.136273 [info ] [MainThread]:   proxy_host: None
[0m12:07:29.136273 [info ] [MainThread]:   proxy_port: None
[0m12:07:29.136273 [info ] [MainThread]:   protocol: None
[0m12:07:29.136273 [info ] [MainThread]:   connect_retries: 1
[0m12:07:29.136273 [info ] [MainThread]:   connect_timeout: None
[0m12:07:29.136273 [info ] [MainThread]:   retry_on_database_errors: False
[0m12:07:29.136273 [info ] [MainThread]:   retry_all: False
[0m12:07:29.144142 [info ] [MainThread]:   insecure_mode: False
[0m12:07:29.145148 [info ] [MainThread]:   reuse_connections: True
[0m12:07:29.146162 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m12:07:29.146162 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m12:07:29.147116 [info ] [MainThread]: Registered adapter: snowflake=1.11.2
[0m12:07:29.685638 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m12:07:29.998053 [debug] [MainThread]: Using snowflake connection "debug"
[0m12:07:29.998053 [debug] [MainThread]: On debug: select 1 as id
[0m12:07:29.998053 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:07:31.578607 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m12:07:31.578607 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m12:07:31.578607 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m12:07:31.578607 [info ] [MainThread]: [31m2 checks failed:[0m
[0m12:07:31.585759 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH and that the user has permissions to run it: "git"

[0m12:07:31.586272 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  290404 (08001): 404 Not Found: post OW84266.ap-sotheast-1.snowflakecomputing.com:443/session/v1/login-request

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m12:07:31.586272 [debug] [MainThread]: Command `dbt debug` failed at 12:07:31.586272 after 3.79 seconds
[0m12:07:31.586272 [debug] [MainThread]: Connection 'debug' was left open.
[0m12:07:31.586272 [debug] [MainThread]: On debug: No close available on handle
[0m12:07:31.586272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0823848B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D09402DC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D08332F910>]}
[0m12:07:31.586272 [debug] [MainThread]: Flushing usage events
[0m12:07:32.906620 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:11:50.666901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4DDF34A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4DEFEFFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4DEFEFDC0>]}


============================== 12:11:50.682631 | 9bfdc465-5821-4f90-84c0-aace7920b324 ==============================
[0m12:11:50.682631 [info ] [MainThread]: Running with dbt=1.11.4
[0m12:11:50.682631 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\jeeva\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt debug', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jeeva\\Desktop\\data_ai_assignment\\dbt_project\\dbt_project\\logs'}
[0m12:11:50.698426 [info ] [MainThread]: dbt version: 1.11.4
[0m12:11:50.698426 [info ] [MainThread]: python version: 3.10.19
[0m12:11:50.698426 [info ] [MainThread]: python path: C:\Users\jeeva\miniconda3\envs\data_ai_assessment\python.exe
[0m12:11:50.698426 [info ] [MainThread]: os info: Windows-10-10.0.26200-SP0
[0m12:11:51.620143 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m12:11:51.620143 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m12:11:51.620143 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m12:11:51.696476 [info ] [MainThread]: Using profiles dir at C:\Users\jeeva\.dbt
[0m12:11:51.696476 [info ] [MainThread]: Using profiles.yml file at C:\Users\jeeva\.dbt\profiles.yml
[0m12:11:51.696476 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\dbt_project\dbt_project.yml
[0m12:11:51.712120 [info ] [MainThread]: adapter type: snowflake
[0m12:11:51.712120 [info ] [MainThread]: adapter version: 1.11.2
[0m12:11:51.838797 [info ] [MainThread]: Configuration:
[0m12:11:51.854889 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:11:51.855503 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:11:51.855503 [info ] [MainThread]: Required dependencies:
[0m12:11:51.855503 [debug] [MainThread]: Executing "git --help"
[0m12:11:51.855503 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m12:11:51.855503 [info ] [MainThread]: Connection:
[0m12:11:51.855503 [info ] [MainThread]:   account: rlxazxg-ow84266
[0m12:11:51.855503 [info ] [MainThread]:   user: JEEVATJ
[0m12:11:51.855503 [info ] [MainThread]:   database: INDUSTRIAL_PROCUREMENT_DB
[0m12:11:51.855503 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m12:11:51.855503 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m12:11:51.855503 [info ] [MainThread]:   schema: ANALYTICS
[0m12:11:51.870845 [info ] [MainThread]:   authenticator: None
[0m12:11:51.870845 [info ] [MainThread]:   oauth_client_id: None
[0m12:11:51.870845 [info ] [MainThread]:   query_tag: None
[0m12:11:51.870845 [info ] [MainThread]:   client_session_keep_alive: False
[0m12:11:51.870845 [info ] [MainThread]:   host: None
[0m12:11:51.870845 [info ] [MainThread]:   port: None
[0m12:11:51.870845 [info ] [MainThread]:   proxy_host: None
[0m12:11:51.870845 [info ] [MainThread]:   proxy_port: None
[0m12:11:51.870845 [info ] [MainThread]:   protocol: None
[0m12:11:51.870845 [info ] [MainThread]:   connect_retries: 1
[0m12:11:51.870845 [info ] [MainThread]:   connect_timeout: None
[0m12:11:51.870845 [info ] [MainThread]:   retry_on_database_errors: False
[0m12:11:51.870845 [info ] [MainThread]:   retry_all: False
[0m12:11:51.870845 [info ] [MainThread]:   insecure_mode: False
[0m12:11:51.870845 [info ] [MainThread]:   reuse_connections: True
[0m12:11:51.870845 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m12:11:51.870845 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m12:11:51.870845 [info ] [MainThread]: Registered adapter: snowflake=1.11.2
[0m12:11:52.394000 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m12:11:52.718181 [debug] [MainThread]: Using snowflake connection "debug"
[0m12:11:52.718181 [debug] [MainThread]: On debug: select 1 as id
[0m12:11:52.718181 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:11:53.524314 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m12:11:53.524314 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m12:11:53.524314 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m12:11:53.524314 [info ] [MainThread]: [31m2 checks failed:[0m
[0m12:11:53.532180 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH and that the user has permissions to run it: "git"

[0m12:11:53.532180 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: rlxazxg-ow84266.snowflakecomputing.com:443. Incorrect username or password was specified.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m12:11:53.532180 [debug] [MainThread]: Command `dbt debug` failed at 12:11:53.532180 after 2.97 seconds
[0m12:11:53.532180 [debug] [MainThread]: Connection 'debug' was left open.
[0m12:11:53.532180 [debug] [MainThread]: On debug: No close available on handle
[0m12:11:53.532180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4DDF34A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4EFC23A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4DE847580>]}
[0m12:11:53.532180 [debug] [MainThread]: Flushing usage events
[0m12:11:54.826463 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:13:09.524511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B43E9B760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B45219CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B45219B10>]}


============================== 12:13:09.533074 | aaf14be9-3f97-4528-8433-528590e7db75 ==============================
[0m12:13:09.533074 [info ] [MainThread]: Running with dbt=1.11.4
[0m12:13:09.533074 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jeeva\\.dbt', 'invocation_command': 'dbt debug', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jeeva\\Desktop\\data_ai_assignment\\dbt_project\\dbt_project\\logs'}
[0m12:13:09.548845 [info ] [MainThread]: dbt version: 1.11.4
[0m12:13:09.548845 [info ] [MainThread]: python version: 3.10.19
[0m12:13:09.548845 [info ] [MainThread]: python path: C:\Users\jeeva\miniconda3\envs\data_ai_assessment\python.exe
[0m12:13:09.548845 [info ] [MainThread]: os info: Windows-10-10.0.26200-SP0
[0m12:13:10.453687 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m12:13:10.453687 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m12:13:10.453687 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m12:13:10.532791 [info ] [MainThread]: Using profiles dir at C:\Users\jeeva\.dbt
[0m12:13:10.548723 [info ] [MainThread]: Using profiles.yml file at C:\Users\jeeva\.dbt\profiles.yml
[0m12:13:10.548723 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\dbt_project\dbt_project.yml
[0m12:13:10.548723 [info ] [MainThread]: adapter type: snowflake
[0m12:13:10.548723 [info ] [MainThread]: adapter version: 1.11.2
[0m12:13:10.691752 [info ] [MainThread]: Configuration:
[0m12:13:10.691752 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:13:10.691752 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:13:10.691752 [info ] [MainThread]: Required dependencies:
[0m12:13:10.691752 [debug] [MainThread]: Executing "git --help"
[0m12:13:10.705397 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m12:13:10.707403 [info ] [MainThread]: Connection:
[0m12:13:10.708821 [info ] [MainThread]:   account: rlxazxg-ow84266
[0m12:13:10.708821 [info ] [MainThread]:   user: jeevatj
[0m12:13:10.708821 [info ] [MainThread]:   database: INDUSTRIAL_PROCUREMENT_DB
[0m12:13:10.708821 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m12:13:10.708821 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m12:13:10.708821 [info ] [MainThread]:   schema: ANALYTICS
[0m12:13:10.708821 [info ] [MainThread]:   authenticator: None
[0m12:13:10.708821 [info ] [MainThread]:   oauth_client_id: None
[0m12:13:10.708821 [info ] [MainThread]:   query_tag: None
[0m12:13:10.708821 [info ] [MainThread]:   client_session_keep_alive: False
[0m12:13:10.708821 [info ] [MainThread]:   host: None
[0m12:13:10.708821 [info ] [MainThread]:   port: None
[0m12:13:10.708821 [info ] [MainThread]:   proxy_host: None
[0m12:13:10.708821 [info ] [MainThread]:   proxy_port: None
[0m12:13:10.708821 [info ] [MainThread]:   protocol: None
[0m12:13:10.708821 [info ] [MainThread]:   connect_retries: 1
[0m12:13:10.708821 [info ] [MainThread]:   connect_timeout: None
[0m12:13:10.708821 [info ] [MainThread]:   retry_on_database_errors: False
[0m12:13:10.708821 [info ] [MainThread]:   retry_all: False
[0m12:13:10.723323 [info ] [MainThread]:   insecure_mode: False
[0m12:13:10.723323 [info ] [MainThread]:   reuse_connections: True
[0m12:13:10.723323 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m12:13:10.723323 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m12:13:10.726243 [info ] [MainThread]: Registered adapter: snowflake=1.11.2
[0m12:13:11.257405 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m12:13:11.570943 [debug] [MainThread]: Using snowflake connection "debug"
[0m12:13:11.570943 [debug] [MainThread]: On debug: select 1 as id
[0m12:13:11.570943 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:13:12.304589 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.732 seconds
[0m12:13:12.306602 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:13:12.306602 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:13:12.306602 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH and that the user has permissions to run it: "git"

[0m12:13:12.306602 [debug] [MainThread]: Command `dbt debug` failed at 12:13:12.306602 after 2.89 seconds
[0m12:13:12.312227 [debug] [MainThread]: Connection 'debug' was left open.
[0m12:13:12.312227 [debug] [MainThread]: On debug: Close
[0m12:13:12.539181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B43E9B760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B44AC5C60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B44A9EF80>]}
[0m12:13:12.545174 [debug] [MainThread]: Flushing usage events
[0m12:13:13.942319 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:17:46.706667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB52D84850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB53E3BDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB53E3BBE0>]}


============================== 12:17:46.706667 | 77a3a2f3-1a16-465c-afb8-59eecaa6cdfc ==============================
[0m12:17:46.706667 [info ] [MainThread]: Running with dbt=1.11.4
[0m12:17:46.706667 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jeeva\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt debug', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jeeva\\Desktop\\data_ai_assignment\\dbt_project\\dbt_project\\logs'}
[0m12:17:46.722653 [info ] [MainThread]: dbt version: 1.11.4
[0m12:17:46.722653 [info ] [MainThread]: python version: 3.10.19
[0m12:17:46.722653 [info ] [MainThread]: python path: C:\Users\jeeva\miniconda3\envs\data_ai_assessment\python.exe
[0m12:17:46.722653 [info ] [MainThread]: os info: Windows-10-10.0.26200-SP0
[0m12:17:47.627285 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m12:17:47.627285 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m12:17:47.627285 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m12:17:47.707148 [info ] [MainThread]: Using profiles dir at C:\Users\jeeva\.dbt
[0m12:17:47.723300 [info ] [MainThread]: Using profiles.yml file at C:\Users\jeeva\.dbt\profiles.yml
[0m12:17:47.723300 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\dbt_project\dbt_project.yml
[0m12:17:47.725817 [info ] [MainThread]: adapter type: snowflake
[0m12:17:47.725817 [info ] [MainThread]: adapter version: 1.11.2
[0m12:17:47.865965 [info ] [MainThread]: Configuration:
[0m12:17:47.865965 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:17:47.865965 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:17:47.865965 [info ] [MainThread]: Required dependencies:
[0m12:17:47.865965 [debug] [MainThread]: Executing "git --help"
[0m12:17:47.881767 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m12:17:47.881767 [info ] [MainThread]: Connection:
[0m12:17:47.881767 [info ] [MainThread]:   account: rlxazxg-ow84266
[0m12:17:47.881767 [info ] [MainThread]:   user: jeevatj
[0m12:17:47.881767 [info ] [MainThread]:   database: INDUSTRIAL_PROCUREMENT_DB
[0m12:17:47.881767 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m12:17:47.881767 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m12:17:47.881767 [info ] [MainThread]:   schema: ANALYTICS
[0m12:17:47.881767 [info ] [MainThread]:   authenticator: None
[0m12:17:47.881767 [info ] [MainThread]:   oauth_client_id: None
[0m12:17:47.881767 [info ] [MainThread]:   query_tag: None
[0m12:17:47.881767 [info ] [MainThread]:   client_session_keep_alive: False
[0m12:17:47.881767 [info ] [MainThread]:   host: None
[0m12:17:47.881767 [info ] [MainThread]:   port: None
[0m12:17:47.881767 [info ] [MainThread]:   proxy_host: None
[0m12:17:47.881767 [info ] [MainThread]:   proxy_port: None
[0m12:17:47.881767 [info ] [MainThread]:   protocol: None
[0m12:17:47.881767 [info ] [MainThread]:   connect_retries: 1
[0m12:17:47.881767 [info ] [MainThread]:   connect_timeout: None
[0m12:17:47.897532 [info ] [MainThread]:   retry_on_database_errors: False
[0m12:17:47.897532 [info ] [MainThread]:   retry_all: False
[0m12:17:47.897532 [info ] [MainThread]:   insecure_mode: False
[0m12:17:47.897532 [info ] [MainThread]:   reuse_connections: True
[0m12:17:47.897532 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m12:17:47.897532 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m12:17:47.897532 [info ] [MainThread]: Registered adapter: snowflake=1.11.2
[0m12:17:48.441841 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m12:17:48.750908 [debug] [MainThread]: Using snowflake connection "debug"
[0m12:17:48.750908 [debug] [MainThread]: On debug: select 1 as id
[0m12:17:48.750908 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:17:49.813000 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.067 seconds
[0m12:17:49.813000 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:17:49.813000 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:17:49.813000 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH and that the user has permissions to run it: "git"

[0m12:17:49.813000 [debug] [MainThread]: Command `dbt debug` failed at 12:17:49.813000 after 3.22 seconds
[0m12:17:49.813000 [debug] [MainThread]: Connection 'debug' was left open.
[0m12:17:49.813000 [debug] [MainThread]: On debug: Close
[0m12:17:49.944081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB52D84850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB536D1630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB537640A0>]}
[0m12:17:49.944081 [debug] [MainThread]: Flushing usage events
[0m12:17:51.304309 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:24:37.919797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001871ECD0BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001871FD8FC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001871FD8FF10>]}


============================== 12:24:37.925090 | 910c0c95-6d4b-4ee0-a241-9d4508be2dfc ==============================
[0m12:24:37.925090 [info ] [MainThread]: Running with dbt=1.11.4
[0m12:24:37.925090 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jeeva\\.dbt', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt debug', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jeeva\\Desktop\\data_ai_assignment\\dbt_project\\logs'}
[0m12:24:37.950187 [info ] [MainThread]: dbt version: 1.11.4
[0m12:24:37.950799 [info ] [MainThread]: python version: 3.10.19
[0m12:24:37.950799 [info ] [MainThread]: python path: C:\Users\jeeva\miniconda3\envs\data_ai_assessment\python.exe
[0m12:24:37.950799 [info ] [MainThread]: os info: Windows-10-10.0.26200-SP0
[0m12:24:38.917224 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m12:24:38.917224 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m12:24:38.917224 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m12:24:39.013360 [info ] [MainThread]: Using profiles dir at C:\Users\jeeva\.dbt
[0m12:24:39.013360 [info ] [MainThread]: Using profiles.yml file at C:\Users\jeeva\.dbt\profiles.yml
[0m12:24:39.013360 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\dbt_project.yml
[0m12:24:39.013360 [info ] [MainThread]: adapter type: snowflake
[0m12:24:39.013360 [info ] [MainThread]: adapter version: 1.11.2
[0m12:24:39.155330 [info ] [MainThread]: Configuration:
[0m12:24:39.155330 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:24:39.155330 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:24:39.155330 [info ] [MainThread]: Required dependencies:
[0m12:24:39.155330 [debug] [MainThread]: Executing "git --help"
[0m12:24:39.212164 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Set `HEAD` or the index to a known state\n   switch     Switch branches\n   tag        Create, list, delete or verify tags\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:24:39.212164 [debug] [MainThread]: STDERR: "b''"
[0m12:24:39.212164 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:24:39.212164 [info ] [MainThread]: Connection:
[0m12:24:39.212164 [info ] [MainThread]:   account: rlxazxg-ow84266
[0m12:24:39.212164 [info ] [MainThread]:   user: jeevatj
[0m12:24:39.212164 [info ] [MainThread]:   database: INDUSTRIAL_PROCUREMENT_DB
[0m12:24:39.218762 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m12:24:39.218762 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m12:24:39.218762 [info ] [MainThread]:   schema: ANALYTICS
[0m12:24:39.218762 [info ] [MainThread]:   authenticator: None
[0m12:24:39.218762 [info ] [MainThread]:   oauth_client_id: None
[0m12:24:39.218762 [info ] [MainThread]:   query_tag: None
[0m12:24:39.218762 [info ] [MainThread]:   client_session_keep_alive: False
[0m12:24:39.218762 [info ] [MainThread]:   host: None
[0m12:24:39.218762 [info ] [MainThread]:   port: None
[0m12:24:39.218762 [info ] [MainThread]:   proxy_host: None
[0m12:24:39.218762 [info ] [MainThread]:   proxy_port: None
[0m12:24:39.218762 [info ] [MainThread]:   protocol: None
[0m12:24:39.218762 [info ] [MainThread]:   connect_retries: 1
[0m12:24:39.218762 [info ] [MainThread]:   connect_timeout: None
[0m12:24:39.218762 [info ] [MainThread]:   retry_on_database_errors: False
[0m12:24:39.218762 [info ] [MainThread]:   retry_all: False
[0m12:24:39.218762 [info ] [MainThread]:   insecure_mode: False
[0m12:24:39.218762 [info ] [MainThread]:   reuse_connections: True
[0m12:24:39.218762 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m12:24:39.218762 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m12:24:39.218762 [info ] [MainThread]: Registered adapter: snowflake=1.11.2
[0m12:24:39.767889 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m12:24:40.062212 [debug] [MainThread]: Using snowflake connection "debug"
[0m12:24:40.062212 [debug] [MainThread]: On debug: select 1 as id
[0m12:24:40.062212 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:24:41.432770 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.366 seconds
[0m12:24:41.436566 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:24:41.438589 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:24:41.438589 [debug] [MainThread]: Command `dbt debug` succeeded at 12:24:41.438589 after 3.63 seconds
[0m12:24:41.438589 [debug] [MainThread]: Connection 'debug' was left open.
[0m12:24:41.438589 [debug] [MainThread]: On debug: Close
[0m12:24:41.564980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001871ECD0BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001871F64A5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001871FD8E800>]}
[0m12:24:41.566996 [debug] [MainThread]: Flushing usage events
[0m12:24:43.536980 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:41:01.876304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249470A4B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002494816BC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002494816BFD0>]}


============================== 12:41:01.876304 | ff663261-4481-4f4c-a0b0-0fada67aa7d7 ==============================
[0m12:41:01.876304 [info ] [MainThread]: Running with dbt=1.11.4
[0m12:41:01.876304 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\jeeva\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jeeva\\Desktop\\data_ai_assignment\\dbt_project\\logs'}
[0m12:41:02.781297 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m12:41:02.781297 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m12:41:02.781297 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m12:41:03.101622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff663261-4481-4f4c-a0b0-0fada67aa7d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249480E46D0>]}
[0m12:41:03.195394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff663261-4481-4f4c-a0b0-0fada67aa7d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024947F4FDF0>]}
[0m12:41:03.195394 [info ] [MainThread]: Registered adapter: snowflake=1.11.2
[0m12:41:03.745774 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m12:41:03.748234 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:41:03.749249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ff663261-4481-4f4c-a0b0-0fada67aa7d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024958DBD870>]}
[0m12:41:05.660586 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_project.dim_product' (models\marts\dim_product.sql) depends on a node named 'stg_product_catalog' which was not found
[0m12:41:05.676678 [debug] [MainThread]: Command `dbt run` failed at 12:41:05.676678 after 3.90 seconds
[0m12:41:05.676678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249470A4B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249591E9ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024959406B30>]}
[0m12:41:05.676678 [debug] [MainThread]: Flushing usage events
[0m12:41:07.068426 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:42:13.258352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C697FD3940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C699354A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6993548B0>]}


============================== 12:42:13.272080 | 9f428685-2b4f-4e49-8f3d-996f0fad7160 ==============================
[0m12:42:13.272080 [info ] [MainThread]: Running with dbt=1.11.4
[0m12:42:13.272080 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\jeeva\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jeeva\\Desktop\\data_ai_assignment\\dbt_project\\logs'}
[0m12:42:14.144773 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m12:42:14.144773 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m12:42:14.144773 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m12:42:14.433657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f428685-2b4f-4e49-8f3d-996f0fad7160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6990E4CD0>]}
[0m12:42:14.511561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f428685-2b4f-4e49-8f3d-996f0fad7160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C699354640>]}
[0m12:42:14.511561 [info ] [MainThread]: Registered adapter: snowflake=1.11.2
[0m12:42:15.051075 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m12:42:15.066845 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:42:15.066845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9f428685-2b4f-4e49-8f3d-996f0fad7160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6A9FA4F70>]}
[0m12:42:17.112415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f428685-2b4f-4e49-8f3d-996f0fad7160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6AB8B4160>]}
[0m12:42:17.270919 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\manifest.json
[0m12:42:17.283301 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\semantic_manifest.json
[0m12:42:17.314682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f428685-2b4f-4e49-8f3d-996f0fad7160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6AB8B5DB0>]}
[0m12:42:17.318286 [info ] [MainThread]: Found 5 models, 4 data tests, 1 source, 522 macros
[0m12:42:17.318973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f428685-2b4f-4e49-8f3d-996f0fad7160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6AB8B65C0>]}
[0m12:42:17.318973 [info ] [MainThread]: 
[0m12:42:17.318973 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:42:17.323311 [info ] [MainThread]: 
[0m12:42:17.323311 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:42:17.329816 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_INDUSTRIAL_PROCUREMENT_DB'
[0m12:42:17.570161 [debug] [ThreadPool]: Using snowflake connection "list_INDUSTRIAL_PROCUREMENT_DB"
[0m12:42:17.570161 [debug] [ThreadPool]: On list_INDUSTRIAL_PROCUREMENT_DB: show terse schemas in database INDUSTRIAL_PROCUREMENT_DB
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_INDUSTRIAL_PROCUREMENT_DB"} */
[0m12:42:17.571167 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:18.371160 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.811 seconds
[0m12:42:18.387096 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS'
[0m12:42:18.418938 [debug] [ThreadPool]: Using snowflake connection "list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS"
[0m12:42:18.418938 [debug] [ThreadPool]: On list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS: show objects in INDUSTRIAL_PROCUREMENT_DB.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS"} */;
[0m12:42:18.418938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:19.119866 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.687 seconds
[0m12:42:19.119866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f428685-2b4f-4e49-8f3d-996f0fad7160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C696A1CF40>]}
[0m12:42:19.129015 [debug] [Thread-2 (]: Began running node model.dbt_project.my_first_dbt_model
[0m12:42:19.129015 [info ] [Thread-2 (]: 1 of 5 START sql table model ANALYTICS.my_first_dbt_model ...................... [RUN]
[0m12:42:19.129015 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_project.my_first_dbt_model'
[0m12:42:19.129015 [debug] [Thread-2 (]: Began compiling node model.dbt_project.my_first_dbt_model
[0m12:42:19.144756 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.my_first_dbt_model"
[0m12:42:19.144756 [debug] [Thread-2 (]: Began executing node model.dbt_project.my_first_dbt_model
[0m12:42:19.192277 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.my_first_dbt_model"
[0m12:42:19.192277 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.my_first_dbt_model"
[0m12:42:19.192277 [debug] [Thread-2 (]: On model.dbt_project.my_first_dbt_model: create or replace transient table INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.my_first_dbt_model
    
    
    
    as (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )

/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */;
[0m12:42:19.192277 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:42:20.565256 [debug] [Thread-2 (]: SQL status: SUCCESS 2 in 1.367 seconds
[0m12:42:20.596199 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f428685-2b4f-4e49-8f3d-996f0fad7160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6AC025CF0>]}
[0m12:42:20.596199 [info ] [Thread-2 (]: 1 of 5 OK created sql table model ANALYTICS.my_first_dbt_model ................. [[32mSUCCESS 2[0m in 1.46s]
[0m12:42:20.597837 [debug] [Thread-2 (]: Finished running node model.dbt_project.my_first_dbt_model
[0m12:42:20.597837 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_product_catalog
[0m12:42:20.597837 [info ] [Thread-2 (]: 2 of 5 START sql view model ANALYTICS.stg_product_catalog ...................... [RUN]
[0m12:42:20.597837 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.my_first_dbt_model, now model.dbt_project.stg_product_catalog)
[0m12:42:20.597837 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_product_catalog
[0m12:42:20.597837 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_product_catalog"
[0m12:42:20.607693 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_product_catalog
[0m12:42:20.623823 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_product_catalog"
[0m12:42:20.639972 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.stg_product_catalog"
[0m12:42:20.639972 [debug] [Thread-2 (]: On model.dbt_project.stg_product_catalog: create or replace   view INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog
  
  
  
  
  as (
    WITH base AS (
    SELECT
        ingestion_id,

        raw_product_json:title::string               AS product_name,
        raw_product_json:productBrand::string        AS brand,
        raw_product_json:sku::string                 AS sku,
        raw_product_json:inStock::boolean            AS in_stock,

        -- clean rating (0 means no rating)
        NULLIF(raw_product_json:rating:average::float, 0) AS avg_rating,
        raw_product_json:rating:totalReviews::int AS review_count,

        -- prices
        raw_product_json:pricing:prices[0]:value::number(10,2) AS selling_price,
        raw_product_json:pricing:prices[1]:value::number(10,2) AS tax_exclusive_price,

        scraped_at,
        page_url,
        category

    FROM INDUSTRIAL_PROCUREMENT_DB.RAW.product_ingestion

),

country AS (

    SELECT
        r.ingestion_id,
        nv.value:value::string AS country_of_origin

    FROM INDUSTRIAL_PROCUREMENT_DB.RAW.product_ingestion r,
    LATERAL FLATTEN(input => r.raw_product_json:familyData:nonVariants) nv
    WHERE nv.value:name::string = 'Country of Origin'
)

SELECT
    b.*,
    c.country_of_origin
FROM base b
LEFT JOIN country c
ON b.ingestion_id = c.ingestion_id
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_product_catalog"} */;
[0m12:42:20.851294 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.218 seconds
[0m12:42:20.863900 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f428685-2b4f-4e49-8f3d-996f0fad7160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C696ECE410>]}
[0m12:42:20.863900 [info ] [Thread-2 (]: 2 of 5 OK created sql view model ANALYTICS.stg_product_catalog ................. [[32mSUCCESS 1[0m in 0.27s]
[0m12:42:20.879979 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_product_catalog
[0m12:42:20.882007 [debug] [Thread-2 (]: Began running node model.dbt_project.my_second_dbt_model
[0m12:42:20.882007 [info ] [Thread-2 (]: 3 of 5 START sql view model ANALYTICS.my_second_dbt_model ...................... [RUN]
[0m12:42:20.882007 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_product_catalog, now model.dbt_project.my_second_dbt_model)
[0m12:42:20.882007 [debug] [Thread-2 (]: Began compiling node model.dbt_project.my_second_dbt_model
[0m12:42:20.882007 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.my_second_dbt_model"
[0m12:42:20.882007 [debug] [Thread-2 (]: Began executing node model.dbt_project.my_second_dbt_model
[0m12:42:20.882007 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.my_second_dbt_model"
[0m12:42:20.895759 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.my_second_dbt_model"
[0m12:42:20.895759 [debug] [Thread-2 (]: On model.dbt_project.my_second_dbt_model: create or replace   view INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.my_second_dbt_model
  
  
  
  
  as (
    -- Use the `ref` function to select from other models

select *
from INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.my_first_dbt_model
where id = 1
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_second_dbt_model"} */;
[0m12:42:21.487875 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.595 seconds
[0m12:42:21.487875 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f428685-2b4f-4e49-8f3d-996f0fad7160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6AB86F3D0>]}
[0m12:42:21.487875 [info ] [Thread-2 (]: 3 of 5 OK created sql view model ANALYTICS.my_second_dbt_model ................. [[32mSUCCESS 1[0m in 0.61s]
[0m12:42:21.487875 [debug] [Thread-2 (]: Finished running node model.dbt_project.my_second_dbt_model
[0m12:42:21.487875 [debug] [Thread-2 (]: Began running node model.dbt_project.dim_product
[0m12:42:21.487875 [info ] [Thread-2 (]: 4 of 5 START sql view model ANALYTICS.dim_product .............................. [RUN]
[0m12:42:21.487875 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.my_second_dbt_model, now model.dbt_project.dim_product)
[0m12:42:21.487875 [debug] [Thread-2 (]: Began compiling node model.dbt_project.dim_product
[0m12:42:21.503892 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.dim_product"
[0m12:42:21.503892 [debug] [Thread-2 (]: Began executing node model.dbt_project.dim_product
[0m12:42:21.503892 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.dim_product"
[0m12:42:21.503892 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.dim_product"
[0m12:42:21.516112 [debug] [Thread-2 (]: On model.dbt_project.dim_product: create or replace   view INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.dim_product
  
  
  
  
  as (
    WITH deduplicated AS (

    SELECT
        sku,
        ANY_VALUE(product_name) AS product_name,
        ANY_VALUE(brand) AS brand,
        ANY_VALUE(category) AS category,
        ANY_VALUE(page_url) AS product_url,
        ANY_VALUE(country_of_origin) AS country_of_origin

    FROM INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog
    WHERE sku IS NOT NULL
    GROUP BY sku

)

SELECT
    MD5(sku) AS product_id,
    *
FROM deduplicated
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_product"} */;
[0m12:42:21.791382 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.278 seconds
[0m12:42:21.791382 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f428685-2b4f-4e49-8f3d-996f0fad7160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6AC1027A0>]}
[0m12:42:21.791382 [info ] [Thread-2 (]: 4 of 5 OK created sql view model ANALYTICS.dim_product ......................... [[32mSUCCESS 1[0m in 0.30s]
[0m12:42:21.791382 [debug] [Thread-2 (]: Finished running node model.dbt_project.dim_product
[0m12:42:21.791382 [debug] [Thread-2 (]: Began running node model.dbt_project.fct_product_snapshot
[0m12:42:21.791382 [info ] [Thread-2 (]: 5 of 5 START sql view model ANALYTICS.fct_product_snapshot ..................... [RUN]
[0m12:42:21.791382 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_product, now model.dbt_project.fct_product_snapshot)
[0m12:42:21.791382 [debug] [Thread-2 (]: Began compiling node model.dbt_project.fct_product_snapshot
[0m12:42:21.807465 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.fct_product_snapshot"
[0m12:42:21.807465 [debug] [Thread-2 (]: Began executing node model.dbt_project.fct_product_snapshot
[0m12:42:21.807465 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.fct_product_snapshot"
[0m12:42:21.807465 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.fct_product_snapshot"
[0m12:42:21.807465 [debug] [Thread-2 (]: On model.dbt_project.fct_product_snapshot: create or replace   view INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.fct_product_snapshot
  
  
  
  
  as (
    SELECT
    d.product_id,
    s.selling_price,
    s.tax_exclusive_price,
    s.avg_rating,
    s.review_count,
    s.in_stock,
    s.scraped_at
FROM INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog s
JOIN INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.dim_product d
    ON s.sku = d.sku
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_product_snapshot"} */;
[0m12:42:22.098087 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.287 seconds
[0m12:42:22.098087 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f428685-2b4f-4e49-8f3d-996f0fad7160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6AC133370>]}
[0m12:42:22.098087 [info ] [Thread-2 (]: 5 of 5 OK created sql view model ANALYTICS.fct_product_snapshot ................ [[32mSUCCESS 1[0m in 0.31s]
[0m12:42:22.098087 [debug] [Thread-2 (]: Finished running node model.dbt_project.fct_product_snapshot
[0m12:42:22.113934 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:42:22.113934 [debug] [MainThread]: Connection 'list_INDUSTRIAL_PROCUREMENT_DB' was left open.
[0m12:42:22.113934 [debug] [MainThread]: On list_INDUSTRIAL_PROCUREMENT_DB: Close
[0m12:42:22.225644 [debug] [MainThread]: Connection 'list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS' was left open.
[0m12:42:22.225644 [debug] [MainThread]: On list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS: Close
[0m12:42:22.359634 [debug] [MainThread]: Connection 'model.dbt_project.fct_product_snapshot' was left open.
[0m12:42:22.366936 [debug] [MainThread]: On model.dbt_project.fct_product_snapshot: Close
[0m12:42:22.500674 [info ] [MainThread]: 
[0m12:42:22.500674 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 5.18 seconds (5.18s).
[0m12:42:22.514531 [debug] [MainThread]: Command end result
[0m12:42:22.546507 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\manifest.json
[0m12:42:22.564723 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\semantic_manifest.json
[0m12:42:22.572746 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\run_results.json
[0m12:42:22.574751 [info ] [MainThread]: 
[0m12:42:22.574751 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:42:22.574751 [info ] [MainThread]: 
[0m12:42:22.574751 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m12:42:22.578219 [debug] [MainThread]: Command `dbt run` succeeded at 12:42:22.578219 after 9.42 seconds
[0m12:42:22.578219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C697FD3940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C69524A0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C698373DF0>]}
[0m12:42:22.578219 [debug] [MainThread]: Flushing usage events
[0m12:42:24.164364 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:47:45.917323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202D59D0BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202D6A97CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202D6A97EE0>]}


============================== 12:47:45.917323 | d5ea6e79-0017-4048-ab38-c90cd11666c0 ==============================
[0m12:47:45.917323 [info ] [MainThread]: Running with dbt=1.11.4
[0m12:47:45.917323 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\jeeva\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jeeva\\Desktop\\data_ai_assignment\\dbt_project\\logs'}
[0m12:47:46.841372 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m12:47:46.841372 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m12:47:46.845204 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m12:47:47.112500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5ea6e79-0017-4048-ab38-c90cd11666c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202D6A17490>]}
[0m12:47:47.193265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5ea6e79-0017-4048-ab38-c90cd11666c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202D637D450>]}
[0m12:47:47.193265 [info ] [MainThread]: Registered adapter: snowflake=1.11.2
[0m12:47:47.736230 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m12:47:48.125781 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 0 files added, 0 files changed.
[0m12:47:48.125781 [debug] [MainThread]: Partial parsing: deleted file: dbt_project://models\example\my_second_dbt_model.sql
[0m12:47:48.127786 [debug] [MainThread]: Partial parsing: deleted file: dbt_project://models\example\my_first_dbt_model.sql
[0m12:47:48.223926 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_project.example
[0m12:47:48.255522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5ea6e79-0017-4048-ab38-c90cd11666c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202E7BA0190>]}
[0m12:47:48.366641 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\manifest.json
[0m12:47:48.383753 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\semantic_manifest.json
[0m12:47:48.415001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5ea6e79-0017-4048-ab38-c90cd11666c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202E7B10A60>]}
[0m12:47:48.416035 [info ] [MainThread]: Found 3 models, 1 source, 522 macros
[0m12:47:48.416035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5ea6e79-0017-4048-ab38-c90cd11666c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202E7B10BB0>]}
[0m12:47:48.418620 [info ] [MainThread]: 
[0m12:47:48.418620 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:47:48.418620 [info ] [MainThread]: 
[0m12:47:48.418620 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:47:48.418620 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_INDUSTRIAL_PROCUREMENT_DB'
[0m12:47:48.672215 [debug] [ThreadPool]: Using snowflake connection "list_INDUSTRIAL_PROCUREMENT_DB"
[0m12:47:48.675990 [debug] [ThreadPool]: On list_INDUSTRIAL_PROCUREMENT_DB: show terse schemas in database INDUSTRIAL_PROCUREMENT_DB
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_INDUSTRIAL_PROCUREMENT_DB"} */
[0m12:47:48.675990 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:49.418994 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.754 seconds
[0m12:47:49.434947 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS'
[0m12:47:49.451595 [debug] [ThreadPool]: Using snowflake connection "list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS"
[0m12:47:49.452136 [debug] [ThreadPool]: On list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS: show objects in INDUSTRIAL_PROCUREMENT_DB.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS"} */;
[0m12:47:49.452136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:50.082061 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.639 seconds
[0m12:47:50.082061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5ea6e79-0017-4048-ab38-c90cd11666c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202D45AB850>]}
[0m12:47:50.098058 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_product_catalog
[0m12:47:50.098058 [info ] [Thread-2 (]: 1 of 3 START sql view model ANALYTICS.stg_product_catalog ...................... [RUN]
[0m12:47:50.098058 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_project.stg_product_catalog'
[0m12:47:50.098058 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_product_catalog
[0m12:47:50.114198 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_product_catalog"
[0m12:47:50.114198 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_product_catalog
[0m12:47:50.148132 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_product_catalog"
[0m12:47:50.148132 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.stg_product_catalog"
[0m12:47:50.148132 [debug] [Thread-2 (]: On model.dbt_project.stg_product_catalog: create or replace   view INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog
  
  
  
  
  as (
    WITH base AS (
    SELECT
        ingestion_id,

        raw_product_json:title::string               AS product_name,
        raw_product_json:productBrand::string        AS brand,
        raw_product_json:sku::string                 AS sku,
        raw_product_json:inStock::boolean            AS in_stock,

        -- clean rating (0 means no rating)
        NULLIF(raw_product_json:rating:average::float, 0) AS avg_rating,
        raw_product_json:rating:totalReviews::int AS review_count,

        -- prices
        raw_product_json:pricing:prices[0]:value::number(10,2) AS selling_price,
        raw_product_json:pricing:prices[1]:value::number(10,2) AS tax_exclusive_price,

        scraped_at,
        page_url,
        category

    FROM INDUSTRIAL_PROCUREMENT_DB.RAW.product_ingestion

),

country AS (

    SELECT
        r.ingestion_id,
        nv.value:value::string AS country_of_origin

    FROM INDUSTRIAL_PROCUREMENT_DB.RAW.product_ingestion r,
    LATERAL FLATTEN(input => r.raw_product_json:familyData:nonVariants) nv
    WHERE nv.value:name::string = 'Country of Origin'
)

SELECT
    b.*,
    c.country_of_origin
FROM base b
LEFT JOIN country c
ON b.ingestion_id = c.ingestion_id
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_product_catalog"} */;
[0m12:47:50.148132 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:47:52.325943 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.169 seconds
[0m12:47:52.355768 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5ea6e79-0017-4048-ab38-c90cd11666c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202D6A96D40>]}
[0m12:47:52.357516 [info ] [Thread-2 (]: 1 of 3 OK created sql view model ANALYTICS.stg_product_catalog ................. [[32mSUCCESS 1[0m in 2.26s]
[0m12:47:52.357516 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_product_catalog
[0m12:47:52.357516 [debug] [Thread-2 (]: Began running node model.dbt_project.dim_product
[0m12:47:52.357516 [info ] [Thread-2 (]: 2 of 3 START sql view model ANALYTICS.dim_product .............................. [RUN]
[0m12:47:52.357516 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_product_catalog, now model.dbt_project.dim_product)
[0m12:47:52.357516 [debug] [Thread-2 (]: Began compiling node model.dbt_project.dim_product
[0m12:47:52.357516 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.dim_product"
[0m12:47:52.357516 [debug] [Thread-2 (]: Began executing node model.dbt_project.dim_product
[0m12:47:52.373615 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.dim_product"
[0m12:47:52.373615 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.dim_product"
[0m12:47:52.373615 [debug] [Thread-2 (]: On model.dbt_project.dim_product: create or replace   view INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.dim_product
  
  
  
  
  as (
    WITH deduplicated AS (

    SELECT
        sku,
        ANY_VALUE(product_name) AS product_name,
        ANY_VALUE(brand) AS brand,
        ANY_VALUE(category) AS category,
        ANY_VALUE(page_url) AS product_url,
        ANY_VALUE(country_of_origin) AS country_of_origin

    FROM INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog
    WHERE sku IS NOT NULL
    GROUP BY sku

)

SELECT
    MD5(sku) AS product_id,
    *
FROM deduplicated
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_product"} */;
[0m12:47:52.926303 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.559 seconds
[0m12:47:52.938380 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5ea6e79-0017-4048-ab38-c90cd11666c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202E7572D40>]}
[0m12:47:52.938380 [info ] [Thread-2 (]: 2 of 3 OK created sql view model ANALYTICS.dim_product ......................... [[32mSUCCESS 1[0m in 0.58s]
[0m12:47:52.938380 [debug] [Thread-2 (]: Finished running node model.dbt_project.dim_product
[0m12:47:52.938380 [debug] [Thread-2 (]: Began running node model.dbt_project.fct_product_snapshot
[0m12:47:52.938380 [info ] [Thread-2 (]: 3 of 3 START sql view model ANALYTICS.fct_product_snapshot ..................... [RUN]
[0m12:47:52.938380 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_product, now model.dbt_project.fct_product_snapshot)
[0m12:47:52.938380 [debug] [Thread-2 (]: Began compiling node model.dbt_project.fct_product_snapshot
[0m12:47:52.938380 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.fct_product_snapshot"
[0m12:47:52.938380 [debug] [Thread-2 (]: Began executing node model.dbt_project.fct_product_snapshot
[0m12:47:52.954311 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.fct_product_snapshot"
[0m12:47:52.954311 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.fct_product_snapshot"
[0m12:47:52.954311 [debug] [Thread-2 (]: On model.dbt_project.fct_product_snapshot: create or replace   view INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.fct_product_snapshot
  
  
  
  
  as (
    SELECT
    d.product_id,
    s.selling_price,
    s.tax_exclusive_price,
    s.avg_rating,
    s.review_count,
    s.in_stock,
    s.scraped_at
FROM INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog s
JOIN INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.dim_product d
    ON s.sku = d.sku
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_product_snapshot"} */;
[0m12:47:54.003970 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.051 seconds
[0m12:47:54.003970 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5ea6e79-0017-4048-ab38-c90cd11666c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202E938FFA0>]}
[0m12:47:54.003970 [info ] [Thread-2 (]: 3 of 3 OK created sql view model ANALYTICS.fct_product_snapshot ................ [[32mSUCCESS 1[0m in 1.07s]
[0m12:47:54.003970 [debug] [Thread-2 (]: Finished running node model.dbt_project.fct_product_snapshot
[0m12:47:54.003970 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:47:54.003970 [debug] [MainThread]: Connection 'list_INDUSTRIAL_PROCUREMENT_DB' was left open.
[0m12:47:54.003970 [debug] [MainThread]: On list_INDUSTRIAL_PROCUREMENT_DB: Close
[0m12:47:54.132694 [debug] [MainThread]: Connection 'list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS' was left open.
[0m12:47:54.132694 [debug] [MainThread]: On list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS: Close
[0m12:47:54.294273 [debug] [MainThread]: Connection 'model.dbt_project.fct_product_snapshot' was left open.
[0m12:47:54.294273 [debug] [MainThread]: On model.dbt_project.fct_product_snapshot: Close
[0m12:47:55.383464 [info ] [MainThread]: 
[0m12:47:55.383464 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 6.96 seconds (6.96s).
[0m12:47:55.393910 [debug] [MainThread]: Command end result
[0m12:47:55.425862 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\manifest.json
[0m12:47:55.425862 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\semantic_manifest.json
[0m12:47:55.425862 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\run_results.json
[0m12:47:55.425862 [info ] [MainThread]: 
[0m12:47:55.425862 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:47:55.441768 [info ] [MainThread]: 
[0m12:47:55.441768 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m12:47:55.441768 [debug] [MainThread]: Command `dbt run` succeeded at 12:47:55.441768 after 9.62 seconds
[0m12:47:55.441768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202D59D0BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202E7AE9810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202E7AE9690>]}
[0m12:47:55.441768 [debug] [MainThread]: Flushing usage events
[0m12:47:56.765339 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:50:46.866071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF8E3E5210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF8F4B03D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF8F4B01F0>]}


============================== 12:50:46.881995 | ddbe1844-dae6-4229-b9c3-653fd9cb64aa ==============================
[0m12:50:46.881995 [info ] [MainThread]: Running with dbt=1.11.4
[0m12:50:46.881995 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jeeva\\.dbt', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jeeva\\Desktop\\data_ai_assignment\\dbt_project\\logs'}
[0m12:50:47.787975 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m12:50:47.787975 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m12:50:47.787975 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m12:50:48.074011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ddbe1844-dae6-4229-b9c3-653fd9cb64aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF8BD797E0>]}
[0m12:50:48.169845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ddbe1844-dae6-4229-b9c3-653fd9cb64aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF8ED9C0A0>]}
[0m12:50:48.169845 [info ] [MainThread]: Registered adapter: snowflake=1.11.2
[0m12:50:48.717297 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m12:50:48.947747 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:50:48.947747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ddbe1844-dae6-4229-b9c3-653fd9cb64aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF9FF5F850>]}
[0m12:50:50.639342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ddbe1844-dae6-4229-b9c3-653fd9cb64aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFA17F3820>]}
[0m12:50:50.750539 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\manifest.json
[0m12:50:50.750539 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\semantic_manifest.json
[0m12:50:50.792482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ddbe1844-dae6-4229-b9c3-653fd9cb64aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFA1871030>]}
[0m12:50:50.794490 [info ] [MainThread]: Found 3 models, 1 source, 522 macros
[0m12:50:50.794490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddbe1844-dae6-4229-b9c3-653fd9cb64aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFA18710C0>]}
[0m12:50:50.796891 [info ] [MainThread]: 
[0m12:50:50.798396 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:50:50.798396 [info ] [MainThread]: 
[0m12:50:50.798396 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:50:50.798396 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_INDUSTRIAL_PROCUREMENT_DB'
[0m12:50:51.052534 [debug] [ThreadPool]: Using snowflake connection "list_INDUSTRIAL_PROCUREMENT_DB"
[0m12:50:51.054281 [debug] [ThreadPool]: On list_INDUSTRIAL_PROCUREMENT_DB: show terse schemas in database INDUSTRIAL_PROCUREMENT_DB
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_INDUSTRIAL_PROCUREMENT_DB"} */
[0m12:50:51.054281 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:50:51.913937 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.859 seconds
[0m12:50:51.915683 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS'
[0m12:50:51.931804 [debug] [ThreadPool]: Using snowflake connection "list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS"
[0m12:50:51.931804 [debug] [ThreadPool]: On list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS: show objects in INDUSTRIAL_PROCUREMENT_DB.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS"} */;
[0m12:50:51.931804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:50:52.591949 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.663 seconds
[0m12:50:52.591949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ddbe1844-dae6-4229-b9c3-653fd9cb64aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF8BBD6410>]}
[0m12:50:52.607625 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_product_catalog
[0m12:50:52.607625 [info ] [Thread-2 (]: 1 of 3 START sql view model ANALYTICS.stg_product_catalog ...................... [RUN]
[0m12:50:52.607625 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_project.stg_product_catalog'
[0m12:50:52.607625 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_product_catalog
[0m12:50:52.607625 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_product_catalog"
[0m12:50:52.607625 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_product_catalog
[0m12:50:52.655105 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_product_catalog"
[0m12:50:52.655105 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.stg_product_catalog"
[0m12:50:52.655105 [debug] [Thread-2 (]: On model.dbt_project.stg_product_catalog: create or replace   view INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog
  
  
  
  
  as (
    WITH base AS (
    SELECT
        ingestion_id,

        raw_product_json:title::string               AS product_name,
        raw_product_json:productBrand::string        AS brand,
        raw_product_json:sku::string                 AS sku,
        raw_product_json:inStock::boolean            AS in_stock,

        -- clean rating (0 means no rating)
        NULLIF(raw_product_json:rating:average::float, 0) AS avg_rating,
        raw_product_json:rating:totalReviews::int AS review_count,

        -- prices
        raw_product_json:pricing:prices[0]:value::number(10,2) AS selling_price,
        raw_product_json:pricing:prices[1]:value::number(10,2) AS tax_exclusive_price,

        scraped_at,
        page_url,
        category

    FROM INDUSTRIAL_PROCUREMENT_DB.RAW.product_ingestion

),

country AS (

    SELECT
        r.ingestion_id,
        nv.value:value::string AS country_of_origin

    FROM INDUSTRIAL_PROCUREMENT_DB.RAW.product_ingestion r,
    LATERAL FLATTEN(input => r.raw_product_json:familyData:nonVariants) nv
    WHERE nv.value:name::string = 'Country of Origin'
)

SELECT
    b.*,
    c.country_of_origin
FROM base b
LEFT JOIN country c
ON b.ingestion_id = c.ingestion_id
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_product_catalog"} */;
[0m12:50:52.655105 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:50:53.201949 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.554 seconds
[0m12:50:53.233932 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddbe1844-dae6-4229-b9c3-653fd9cb64aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFA1F61D20>]}
[0m12:50:53.233932 [info ] [Thread-2 (]: 1 of 3 OK created sql view model ANALYTICS.stg_product_catalog ................. [[32mSUCCESS 1[0m in 0.63s]
[0m12:50:53.233932 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_product_catalog
[0m12:50:53.249660 [debug] [Thread-2 (]: Began running node model.dbt_project.dim_product
[0m12:50:53.249660 [info ] [Thread-2 (]: 2 of 3 START sql view model ANALYTICS.dim_product .............................. [RUN]
[0m12:50:53.249660 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_product_catalog, now model.dbt_project.dim_product)
[0m12:50:53.249660 [debug] [Thread-2 (]: Began compiling node model.dbt_project.dim_product
[0m12:50:53.257754 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.dim_product"
[0m12:50:53.257754 [debug] [Thread-2 (]: Began executing node model.dbt_project.dim_product
[0m12:50:53.261766 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.dim_product"
[0m12:50:53.265518 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.dim_product"
[0m12:50:53.265518 [debug] [Thread-2 (]: On model.dbt_project.dim_product: create or replace   view INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.dim_product
  
  
  
  
  as (
    WITH deduplicated AS (

    SELECT
        sku,
        ANY_VALUE(product_name) AS product_name,
        ANY_VALUE(brand) AS brand,
        ANY_VALUE(category) AS category,
        ANY_VALUE(page_url) AS product_url,
        ANY_VALUE(country_of_origin) AS country_of_origin

    FROM INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog
    WHERE sku IS NOT NULL
    GROUP BY sku

)

SELECT
    MD5(sku) AS product_id,
    *
FROM deduplicated
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_product"} */;
[0m12:50:53.507344 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.254 seconds
[0m12:50:53.523112 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddbe1844-dae6-4229-b9c3-653fd9cb64aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF8CFC93F0>]}
[0m12:50:53.523112 [info ] [Thread-2 (]: 2 of 3 OK created sql view model ANALYTICS.dim_product ......................... [[32mSUCCESS 1[0m in 0.27s]
[0m12:50:53.523112 [debug] [Thread-2 (]: Finished running node model.dbt_project.dim_product
[0m12:50:53.523112 [debug] [Thread-2 (]: Began running node model.dbt_project.fct_product_snapshot
[0m12:50:53.523112 [info ] [Thread-2 (]: 3 of 3 START sql view model ANALYTICS.fct_product_snapshot ..................... [RUN]
[0m12:50:53.523112 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_product, now model.dbt_project.fct_product_snapshot)
[0m12:50:53.523112 [debug] [Thread-2 (]: Began compiling node model.dbt_project.fct_product_snapshot
[0m12:50:53.540248 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.fct_product_snapshot"
[0m12:50:53.540248 [debug] [Thread-2 (]: Began executing node model.dbt_project.fct_product_snapshot
[0m12:50:53.540248 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.fct_product_snapshot"
[0m12:50:53.540248 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.fct_product_snapshot"
[0m12:50:53.540248 [debug] [Thread-2 (]: On model.dbt_project.fct_product_snapshot: create or replace   view INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.fct_product_snapshot
  
  
  
  
  as (
    SELECT
    d.product_id,
    s.selling_price,
    s.tax_exclusive_price,
    s.avg_rating,
    s.review_count,
    s.in_stock,
    s.scraped_at
FROM INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog s
JOIN INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.dim_product d
    ON s.sku = d.sku
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_product_snapshot"} */;
[0m12:50:53.912534 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.363 seconds
[0m12:50:53.916548 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddbe1844-dae6-4229-b9c3-653fd9cb64aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFA1F61D20>]}
[0m12:50:53.916548 [info ] [Thread-2 (]: 3 of 3 OK created sql view model ANALYTICS.fct_product_snapshot ................ [[32mSUCCESS 1[0m in 0.39s]
[0m12:50:53.916548 [debug] [Thread-2 (]: Finished running node model.dbt_project.fct_product_snapshot
[0m12:50:53.916548 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:50:53.916548 [debug] [MainThread]: Connection 'list_INDUSTRIAL_PROCUREMENT_DB' was left open.
[0m12:50:53.916548 [debug] [MainThread]: On list_INDUSTRIAL_PROCUREMENT_DB: Close
[0m12:50:54.040219 [debug] [MainThread]: Connection 'list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS' was left open.
[0m12:50:54.040219 [debug] [MainThread]: On list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS: Close
[0m12:50:54.168676 [debug] [MainThread]: Connection 'model.dbt_project.fct_product_snapshot' was left open.
[0m12:50:54.184810 [debug] [MainThread]: On model.dbt_project.fct_product_snapshot: Close
[0m12:50:54.329480 [info ] [MainThread]: 
[0m12:50:54.329480 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 3.53 seconds (3.53s).
[0m12:50:54.345273 [debug] [MainThread]: Command end result
[0m12:50:54.377024 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\manifest.json
[0m12:50:54.392858 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\semantic_manifest.json
[0m12:50:54.406610 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\run_results.json
[0m12:50:54.406610 [info ] [MainThread]: 
[0m12:50:54.406610 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:50:54.408616 [info ] [MainThread]: 
[0m12:50:54.408616 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m12:50:54.408616 [debug] [MainThread]: Command `dbt run` succeeded at 12:50:54.408616 after 7.65 seconds
[0m12:50:54.408616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF8E3E5210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF8CB64070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF8ED9C0A0>]}
[0m12:50:54.411880 [debug] [MainThread]: Flushing usage events
[0m12:50:55.740253 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:52:09.766467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2D7EB5B70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2D8879FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2D887BD90>]}


============================== 12:52:09.778039 | 9ad3183e-b85d-413b-b371-bf0a251faaef ==============================
[0m12:52:09.778039 [info ] [MainThread]: Running with dbt=1.11.4
[0m12:52:09.778039 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jeeva\\.dbt', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt test', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jeeva\\Desktop\\data_ai_assignment\\dbt_project\\logs'}
[0m12:52:10.666203 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m12:52:10.666203 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m12:52:10.666203 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m12:52:10.937651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ad3183e-b85d-413b-b371-bf0a251faaef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2D8ECF400>]}
[0m12:52:11.017190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ad3183e-b85d-413b-b371-bf0a251faaef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2D8F07CA0>]}
[0m12:52:11.017190 [info ] [MainThread]: Registered adapter: snowflake=1.11.2
[0m12:52:11.555995 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m12:52:11.901177 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:52:11.901177 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m12:52:11.901177 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:52:11.957545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ad3183e-b85d-413b-b371-bf0a251faaef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2EA048130>]}
[0m12:52:12.076025 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\manifest.json
[0m12:52:12.079777 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\semantic_manifest.json
[0m12:52:12.122391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ad3183e-b85d-413b-b371-bf0a251faaef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2EA04B250>]}
[0m12:52:12.122391 [info ] [MainThread]: Found 3 models, 1 source, 522 macros
[0m12:52:12.122391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ad3183e-b85d-413b-b371-bf0a251faaef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2E9FCAAA0>]}
[0m12:52:12.122391 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:52:12.127256 [debug] [MainThread]: Command end result
[0m12:52:12.158984 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\manifest.json
[0m12:52:12.160991 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\semantic_manifest.json
[0m12:52:12.168136 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\run_results.json
[0m12:52:12.168136 [debug] [MainThread]: Command `dbt test` succeeded at 12:52:12.168136 after 2.50 seconds
[0m12:52:12.168136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2D7EB5B70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2D8F07CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2D7FAA8C0>]}
[0m12:52:12.170142 [debug] [MainThread]: Flushing usage events
[0m12:52:13.508569 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:54:41.596613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADA1E0F190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADA3178460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADA3178280>]}


============================== 12:54:41.596613 | 941f6909-c6a3-4568-b3ae-b79a5e414d08 ==============================
[0m12:54:41.596613 [info ] [MainThread]: Running with dbt=1.11.4
[0m12:54:41.612569 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jeeva\\.dbt', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt test', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jeeva\\Desktop\\data_ai_assignment\\dbt_project\\logs'}
[0m12:54:42.659116 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m12:54:42.659116 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m12:54:42.659116 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m12:54:42.930899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '941f6909-c6a3-4568-b3ae-b79a5e414d08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADA215EAD0>]}
[0m12:54:43.009887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '941f6909-c6a3-4568-b3ae-b79a5e414d08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADB3BC8A90>]}
[0m12:54:43.025600 [info ] [MainThread]: Registered adapter: snowflake=1.11.2
[0m12:54:43.536042 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m12:54:43.886981 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:54:43.888986 [debug] [MainThread]: Partial parsing: added file: dbt_project://models\schema.yml
[0m12:54:44.137881 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on
'fct_product_snapshot' in package 'dbt_project' (models\schema.yml). Arguments
to generic tests should be nested under the `arguments` property.
[0m12:54:44.137881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '941f6909-c6a3-4568-b3ae-b79a5e414d08', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADB43F5B10>]}
[0m12:54:44.312160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '941f6909-c6a3-4568-b3ae-b79a5e414d08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADB451A830>]}
[0m12:54:44.454186 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\manifest.json
[0m12:54:44.454186 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\semantic_manifest.json
[0m12:54:44.505274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '941f6909-c6a3-4568-b3ae-b79a5e414d08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADB451A6E0>]}
[0m12:54:44.505274 [info ] [MainThread]: Found 3 models, 9 data tests, 1 source, 522 macros
[0m12:54:44.505274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '941f6909-c6a3-4568-b3ae-b79a5e414d08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADB44E1C60>]}
[0m12:54:44.505274 [info ] [MainThread]: 
[0m12:54:44.505274 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:54:44.505274 [info ] [MainThread]: 
[0m12:54:44.505274 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:54:44.519711 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS'
[0m12:54:44.771599 [debug] [ThreadPool]: Using snowflake connection "list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS"
[0m12:54:44.773347 [debug] [ThreadPool]: On list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS: show objects in INDUSTRIAL_PROCUREMENT_DB.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS"} */;
[0m12:54:44.773347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:45.573249 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.813 seconds
[0m12:54:45.589180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '941f6909-c6a3-4568-b3ae-b79a5e414d08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADB451A6E0>]}
[0m12:54:45.589180 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_dim_product_product_id.02b1f06816
[0m12:54:45.589180 [info ] [Thread-2 (]: 1 of 9 START test not_null_dim_product_product_id .............................. [RUN]
[0m12:54:45.589180 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_project.not_null_dim_product_product_id.02b1f06816'
[0m12:54:45.589180 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_dim_product_product_id.02b1f06816
[0m12:54:45.605116 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_product_product_id.02b1f06816"
[0m12:54:45.605116 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_dim_product_product_id.02b1f06816
[0m12:54:45.636606 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_dim_product_product_id.02b1f06816"
[0m12:54:45.636606 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_project.not_null_dim_product_product_id.02b1f06816"
[0m12:54:45.636606 [debug] [Thread-2 (]: On test.dbt_project.not_null_dim_product_product_id.02b1f06816: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.dim_product
where product_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_dim_product_product_id.02b1f06816"} */
[0m12:54:45.636606 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:54:46.959695 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.319 seconds
[0m12:54:46.973781 [info ] [Thread-2 (]: 1 of 9 PASS not_null_dim_product_product_id .................................... [[32mPASS[0m in 1.38s]
[0m12:54:46.973781 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_dim_product_product_id.02b1f06816
[0m12:54:46.973781 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_dim_product_sku.deecb558ac
[0m12:54:46.973781 [info ] [Thread-2 (]: 2 of 9 START test not_null_dim_product_sku ..................................... [RUN]
[0m12:54:46.973781 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_product_product_id.02b1f06816, now test.dbt_project.not_null_dim_product_sku.deecb558ac)
[0m12:54:46.973781 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_dim_product_sku.deecb558ac
[0m12:54:46.989519 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_product_sku.deecb558ac"
[0m12:54:46.989519 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_dim_product_sku.deecb558ac
[0m12:54:46.989519 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_dim_product_sku.deecb558ac"
[0m12:54:46.989519 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_project.not_null_dim_product_sku.deecb558ac"
[0m12:54:46.989519 [debug] [Thread-2 (]: On test.dbt_project.not_null_dim_product_sku.deecb558ac: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sku
from INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.dim_product
where sku is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_dim_product_sku.deecb558ac"} */
[0m12:54:47.218364 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.217 seconds
[0m12:54:47.228483 [info ] [Thread-2 (]: 2 of 9 PASS not_null_dim_product_sku ........................................... [[32mPASS[0m in 0.25s]
[0m12:54:47.234310 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_dim_product_sku.deecb558ac
[0m12:54:47.236332 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_fct_product_snapshot_product_id.404631bb0e
[0m12:54:47.238351 [info ] [Thread-2 (]: 3 of 9 START test not_null_fct_product_snapshot_product_id ..................... [RUN]
[0m12:54:47.238351 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_product_sku.deecb558ac, now test.dbt_project.not_null_fct_product_snapshot_product_id.404631bb0e)
[0m12:54:47.238351 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_fct_product_snapshot_product_id.404631bb0e
[0m12:54:47.247645 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_fct_product_snapshot_product_id.404631bb0e"
[0m12:54:47.247645 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_fct_product_snapshot_product_id.404631bb0e
[0m12:54:47.253093 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_fct_product_snapshot_product_id.404631bb0e"
[0m12:54:47.255108 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_project.not_null_fct_product_snapshot_product_id.404631bb0e"
[0m12:54:47.257208 [debug] [Thread-2 (]: On test.dbt_project.not_null_fct_product_snapshot_product_id.404631bb0e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.fct_product_snapshot
where product_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_fct_product_snapshot_product_id.404631bb0e"} */
[0m12:54:47.779006 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.534 seconds
[0m12:54:47.779006 [info ] [Thread-2 (]: 3 of 9 PASS not_null_fct_product_snapshot_product_id ........................... [[32mPASS[0m in 0.54s]
[0m12:54:47.794943 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_fct_product_snapshot_product_id.404631bb0e
[0m12:54:47.794943 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_fct_product_snapshot_scraped_at.55b12f8257
[0m12:54:47.796775 [info ] [Thread-2 (]: 4 of 9 START test not_null_fct_product_snapshot_scraped_at ..................... [RUN]
[0m12:54:47.796775 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_fct_product_snapshot_product_id.404631bb0e, now test.dbt_project.not_null_fct_product_snapshot_scraped_at.55b12f8257)
[0m12:54:47.796775 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_fct_product_snapshot_scraped_at.55b12f8257
[0m12:54:47.796775 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_fct_product_snapshot_scraped_at.55b12f8257"
[0m12:54:47.796775 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_fct_product_snapshot_scraped_at.55b12f8257
[0m12:54:47.796775 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_fct_product_snapshot_scraped_at.55b12f8257"
[0m12:54:47.810923 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_project.not_null_fct_product_snapshot_scraped_at.55b12f8257"
[0m12:54:47.810923 [debug] [Thread-2 (]: On test.dbt_project.not_null_fct_product_snapshot_scraped_at.55b12f8257: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select scraped_at
from INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.fct_product_snapshot
where scraped_at is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_fct_product_snapshot_scraped_at.55b12f8257"} */
[0m12:54:48.004019 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.202 seconds
[0m12:54:48.019991 [info ] [Thread-2 (]: 4 of 9 PASS not_null_fct_product_snapshot_scraped_at ........................... [[32mPASS[0m in 0.22s]
[0m12:54:48.019991 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_fct_product_snapshot_scraped_at.55b12f8257
[0m12:54:48.019991 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_product_catalog_ingestion_id.4f666912e8
[0m12:54:48.019991 [info ] [Thread-2 (]: 5 of 9 START test not_null_stg_product_catalog_ingestion_id .................... [RUN]
[0m12:54:48.019991 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_fct_product_snapshot_scraped_at.55b12f8257, now test.dbt_project.not_null_stg_product_catalog_ingestion_id.4f666912e8)
[0m12:54:48.019991 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_product_catalog_ingestion_id.4f666912e8
[0m12:54:48.019991 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_product_catalog_ingestion_id.4f666912e8"
[0m12:54:48.019991 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_product_catalog_ingestion_id.4f666912e8
[0m12:54:48.035700 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_product_catalog_ingestion_id.4f666912e8"
[0m12:54:48.035700 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_project.not_null_stg_product_catalog_ingestion_id.4f666912e8"
[0m12:54:48.035700 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_product_catalog_ingestion_id.4f666912e8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ingestion_id
from INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog
where ingestion_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_product_catalog_ingestion_id.4f666912e8"} */
[0m12:54:48.165650 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.132 seconds
[0m12:54:48.165650 [info ] [Thread-2 (]: 5 of 9 PASS not_null_stg_product_catalog_ingestion_id .......................... [[32mPASS[0m in 0.15s]
[0m12:54:48.165650 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_product_catalog_ingestion_id.4f666912e8
[0m12:54:48.165650 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_product_catalog_sku.af3b21f368
[0m12:54:48.165650 [info ] [Thread-2 (]: 6 of 9 START test not_null_stg_product_catalog_sku ............................. [RUN]
[0m12:54:48.165650 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_product_catalog_ingestion_id.4f666912e8, now test.dbt_project.not_null_stg_product_catalog_sku.af3b21f368)
[0m12:54:48.165650 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_product_catalog_sku.af3b21f368
[0m12:54:48.181282 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_product_catalog_sku.af3b21f368"
[0m12:54:48.181282 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_product_catalog_sku.af3b21f368
[0m12:54:48.181282 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_product_catalog_sku.af3b21f368"
[0m12:54:48.181282 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_project.not_null_stg_product_catalog_sku.af3b21f368"
[0m12:54:48.181282 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_product_catalog_sku.af3b21f368: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sku
from INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog
where sku is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_product_catalog_sku.af3b21f368"} */
[0m12:54:48.374025 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.181 seconds
[0m12:54:48.377915 [error] [Thread-2 (]: 6 of 9 FAIL 25 not_null_stg_product_catalog_sku ................................ [[31mFAIL 25[0m in 0.21s]
[0m12:54:48.377915 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_product_catalog_sku.af3b21f368
[0m12:54:48.377915 [debug] [Thread-2 (]: Began running node test.dbt_project.relationships_fct_product_snapshot_product_id__product_id__ref_dim_product_.b5b14dc249
[0m12:54:48.377915 [info ] [Thread-2 (]: 7 of 9 START test relationships_fct_product_snapshot_product_id__product_id__ref_dim_product_  [RUN]
[0m12:54:48.377915 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_product_catalog_sku.af3b21f368, now test.dbt_project.relationships_fct_product_snapshot_product_id__product_id__ref_dim_product_.b5b14dc249)
[0m12:54:48.377915 [debug] [Thread-2 (]: Began compiling node test.dbt_project.relationships_fct_product_snapshot_product_id__product_id__ref_dim_product_.b5b14dc249
[0m12:54:48.377915 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.relationships_fct_product_snapshot_product_id__product_id__ref_dim_product_.b5b14dc249"
[0m12:54:48.391234 [debug] [Thread-2 (]: Began executing node test.dbt_project.relationships_fct_product_snapshot_product_id__product_id__ref_dim_product_.b5b14dc249
[0m12:54:48.394262 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.relationships_fct_product_snapshot_product_id__product_id__ref_dim_product_.b5b14dc249"
[0m12:54:48.396269 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_project.relationships_fct_product_snapshot_product_id__product_id__ref_dim_product_.b5b14dc249"
[0m12:54:48.398276 [debug] [Thread-2 (]: On test.dbt_project.relationships_fct_product_snapshot_product_id__product_id__ref_dim_product_.b5b14dc249: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.fct_product_snapshot
    where product_id is not null
),

parent as (
    select product_id as to_field
    from INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_fct_product_snapshot_product_id__product_id__ref_dim_product_.b5b14dc249"} */
[0m12:54:48.794319 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.403 seconds
[0m12:54:48.794319 [info ] [Thread-2 (]: 7 of 9 PASS relationships_fct_product_snapshot_product_id__product_id__ref_dim_product_  [[32mPASS[0m in 0.42s]
[0m12:54:48.794319 [debug] [Thread-2 (]: Finished running node test.dbt_project.relationships_fct_product_snapshot_product_id__product_id__ref_dim_product_.b5b14dc249
[0m12:54:48.794319 [debug] [Thread-2 (]: Began running node test.dbt_project.unique_dim_product_product_id.46495bf7fe
[0m12:54:48.794319 [info ] [Thread-2 (]: 8 of 9 START test unique_dim_product_product_id ................................ [RUN]
[0m12:54:48.794319 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_fct_product_snapshot_product_id__product_id__ref_dim_product_.b5b14dc249, now test.dbt_project.unique_dim_product_product_id.46495bf7fe)
[0m12:54:48.794319 [debug] [Thread-2 (]: Began compiling node test.dbt_project.unique_dim_product_product_id.46495bf7fe
[0m12:54:48.810023 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.unique_dim_product_product_id.46495bf7fe"
[0m12:54:48.810023 [debug] [Thread-2 (]: Began executing node test.dbt_project.unique_dim_product_product_id.46495bf7fe
[0m12:54:48.810023 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.unique_dim_product_product_id.46495bf7fe"
[0m12:54:48.827318 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_project.unique_dim_product_product_id.46495bf7fe"
[0m12:54:48.829065 [debug] [Thread-2 (]: On test.dbt_project.unique_dim_product_product_id.46495bf7fe: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.dim_product
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_dim_product_product_id.46495bf7fe"} */
[0m12:54:49.035744 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.215 seconds
[0m12:54:49.035744 [info ] [Thread-2 (]: 8 of 9 PASS unique_dim_product_product_id ...................................... [[32mPASS[0m in 0.24s]
[0m12:54:49.035744 [debug] [Thread-2 (]: Finished running node test.dbt_project.unique_dim_product_product_id.46495bf7fe
[0m12:54:49.035744 [debug] [Thread-2 (]: Began running node test.dbt_project.unique_stg_product_catalog_ingestion_id.99dfc026eb
[0m12:54:49.035744 [info ] [Thread-2 (]: 9 of 9 START test unique_stg_product_catalog_ingestion_id ...................... [RUN]
[0m12:54:49.035744 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_dim_product_product_id.46495bf7fe, now test.dbt_project.unique_stg_product_catalog_ingestion_id.99dfc026eb)
[0m12:54:49.051671 [debug] [Thread-2 (]: Began compiling node test.dbt_project.unique_stg_product_catalog_ingestion_id.99dfc026eb
[0m12:54:49.051671 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.unique_stg_product_catalog_ingestion_id.99dfc026eb"
[0m12:54:49.051671 [debug] [Thread-2 (]: Began executing node test.dbt_project.unique_stg_product_catalog_ingestion_id.99dfc026eb
[0m12:54:49.051671 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.unique_stg_product_catalog_ingestion_id.99dfc026eb"
[0m12:54:49.051671 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_project.unique_stg_product_catalog_ingestion_id.99dfc026eb"
[0m12:54:49.051671 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_product_catalog_ingestion_id.99dfc026eb: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    ingestion_id as unique_field,
    count(*) as n_records

from INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog
where ingestion_id is not null
group by ingestion_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_product_catalog_ingestion_id.99dfc026eb"} */
[0m12:54:49.276650 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.210 seconds
[0m12:54:49.276650 [info ] [Thread-2 (]: 9 of 9 PASS unique_stg_product_catalog_ingestion_id ............................ [[32mPASS[0m in 0.24s]
[0m12:54:49.276650 [debug] [Thread-2 (]: Finished running node test.dbt_project.unique_stg_product_catalog_ingestion_id.99dfc026eb
[0m12:54:49.276650 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:54:49.276650 [debug] [MainThread]: Connection 'list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS' was left open.
[0m12:54:49.276650 [debug] [MainThread]: On list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS: Close
[0m12:54:49.405974 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_product_catalog_ingestion_id.99dfc026eb' was left open.
[0m12:54:49.405974 [debug] [MainThread]: On test.dbt_project.unique_stg_product_catalog_ingestion_id.99dfc026eb: Close
[0m12:54:49.517695 [info ] [MainThread]: 
[0m12:54:49.517695 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 5.01 seconds (5.01s).
[0m12:54:49.533564 [debug] [MainThread]: Command end result
[0m12:54:49.565496 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\manifest.json
[0m12:54:49.565496 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\semantic_manifest.json
[0m12:54:49.581173 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\run_results.json
[0m12:54:49.581173 [info ] [MainThread]: 
[0m12:54:49.581173 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:54:49.581173 [info ] [MainThread]: 
[0m12:54:49.581173 [error] [MainThread]: [31mFailure in test not_null_stg_product_catalog_sku (models\schema.yml)[0m
[0m12:54:49.581173 [error] [MainThread]:   Got 25 results, configured to fail if != 0
[0m12:54:49.581173 [info ] [MainThread]: 
[0m12:54:49.581173 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\schema.yml\not_null_stg_product_catalog_sku.sql
[0m12:54:49.581173 [info ] [MainThread]: 
[0m12:54:49.581173 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=9
[0m12:54:49.581173 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:54:49.581173 [debug] [MainThread]: Command `dbt test` failed at 12:54:49.581173 after 8.09 seconds
[0m12:54:49.597072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADA1E0F190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADB3D26950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADA215E740>]}
[0m12:54:49.597072 [debug] [MainThread]: Flushing usage events
[0m12:54:50.931073 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:59:09.377617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002164CA14A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002164DADBC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002164DADBF10>]}


============================== 12:59:09.377617 | 8c598685-d37a-4668-81f3-033c8fbffb0a ==============================
[0m12:59:09.377617 [info ] [MainThread]: Running with dbt=1.11.4
[0m12:59:09.377617 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jeeva\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jeeva\\Desktop\\data_ai_assignment\\dbt_project\\logs'}
[0m12:59:10.283271 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m12:59:10.283271 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m12:59:10.283271 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m12:59:10.570546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c598685-d37a-4668-81f3-033c8fbffb0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002164DA4ED10>]}
[0m12:59:10.650074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c598685-d37a-4668-81f3-033c8fbffb0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002165E4FB940>]}
[0m12:59:10.650074 [info ] [MainThread]: Registered adapter: snowflake=1.11.2
[0m12:59:11.174114 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m12:59:11.555556 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:59:11.555556 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models\staging\stg_product_catalog.sql
[0m12:59:12.129796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c598685-d37a-4668-81f3-033c8fbffb0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002165FF957E0>]}
[0m12:59:12.273143 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\manifest.json
[0m12:59:12.273143 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\semantic_manifest.json
[0m12:59:12.304959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c598685-d37a-4668-81f3-033c8fbffb0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002165FF97100>]}
[0m12:59:12.304959 [info ] [MainThread]: Found 3 models, 9 data tests, 1 source, 522 macros
[0m12:59:12.304959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c598685-d37a-4668-81f3-033c8fbffb0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002165FF97070>]}
[0m12:59:12.304959 [info ] [MainThread]: 
[0m12:59:12.304959 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:59:12.304959 [info ] [MainThread]: 
[0m12:59:12.304959 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:59:12.321049 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_INDUSTRIAL_PROCUREMENT_DB'
[0m12:59:12.561150 [debug] [ThreadPool]: Using snowflake connection "list_INDUSTRIAL_PROCUREMENT_DB"
[0m12:59:12.565084 [debug] [ThreadPool]: On list_INDUSTRIAL_PROCUREMENT_DB: show terse schemas in database INDUSTRIAL_PROCUREMENT_DB
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_INDUSTRIAL_PROCUREMENT_DB"} */
[0m12:59:12.565084 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:13.357929 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.792 seconds
[0m12:59:13.357929 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS'
[0m12:59:13.397908 [debug] [ThreadPool]: Using snowflake connection "list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS"
[0m12:59:13.397908 [debug] [ThreadPool]: On list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS: show objects in INDUSTRIAL_PROCUREMENT_DB.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS"} */;
[0m12:59:13.397908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:13.807712 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.408 seconds
[0m12:59:13.807712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c598685-d37a-4668-81f3-033c8fbffb0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002165E4FBE20>]}
[0m12:59:13.823831 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_product_catalog
[0m12:59:13.823831 [info ] [Thread-2 (]: 1 of 3 START sql view model ANALYTICS.stg_product_catalog ...................... [RUN]
[0m12:59:13.823831 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_project.stg_product_catalog'
[0m12:59:13.823831 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_product_catalog
[0m12:59:13.855565 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_product_catalog"
[0m12:59:13.855565 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_product_catalog
[0m12:59:13.887495 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_product_catalog"
[0m12:59:13.887495 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.stg_product_catalog"
[0m12:59:13.887495 [debug] [Thread-2 (]: On model.dbt_project.stg_product_catalog: create or replace   view INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog
  
  
  
  
  as (
    WITH base AS (

    SELECT
        ingestion_id,

        raw_product_json:title::string               AS product_name,
        raw_product_json:productBrand::string        AS brand,
        raw_product_json:sku::string                 AS sku,
        raw_product_json:inStock::boolean            AS in_stock,

        NULLIF(raw_product_json:rating:average::float, 0) AS avg_rating,
        raw_product_json:rating:totalReviews::int AS review_count,

        raw_product_json:pricing:prices[0]:value::number(10,2) AS selling_price,
        raw_product_json:pricing:prices[1]:value::number(10,2) AS tax_exclusive_price,

        scraped_at,
        page_url,
        category

    FROM INDUSTRIAL_PROCUREMENT_DB.RAW.product_ingestion
    WHERE raw_product_json:sku IS NOT NULL

),

country AS (

    SELECT
        r.ingestion_id,
        nv.value:value::string AS country_of_origin

    FROM INDUSTRIAL_PROCUREMENT_DB.RAW.product_ingestion r,
    LATERAL FLATTEN(input => r.raw_product_json:familyData:nonVariants) nv
    WHERE nv.value:name::string = 'Country of Origin'
)

SELECT
    b.*,
    c.country_of_origin
FROM base b
LEFT JOIN country c
ON b.ingestion_id = c.ingestion_id
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_product_catalog"} */;
[0m12:59:13.887495 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:59:14.394202 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.501 seconds
[0m12:59:14.436072 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c598685-d37a-4668-81f3-033c8fbffb0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002164DAD9060>]}
[0m12:59:14.436072 [info ] [Thread-2 (]: 1 of 3 OK created sql view model ANALYTICS.stg_product_catalog ................. [[32mSUCCESS 1[0m in 0.61s]
[0m12:59:14.436072 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_product_catalog
[0m12:59:14.436072 [debug] [Thread-2 (]: Began running node model.dbt_project.dim_product
[0m12:59:14.436072 [info ] [Thread-2 (]: 2 of 3 START sql view model ANALYTICS.dim_product .............................. [RUN]
[0m12:59:14.436072 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_product_catalog, now model.dbt_project.dim_product)
[0m12:59:14.436072 [debug] [Thread-2 (]: Began compiling node model.dbt_project.dim_product
[0m12:59:14.453995 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.dim_product"
[0m12:59:14.453995 [debug] [Thread-2 (]: Began executing node model.dbt_project.dim_product
[0m12:59:14.460014 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.dim_product"
[0m12:59:14.460014 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.dim_product"
[0m12:59:14.462020 [debug] [Thread-2 (]: On model.dbt_project.dim_product: create or replace   view INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.dim_product
  
  
  
  
  as (
    WITH deduplicated AS (

    SELECT
        sku,
        ANY_VALUE(product_name) AS product_name,
        ANY_VALUE(brand) AS brand,
        ANY_VALUE(category) AS category,
        ANY_VALUE(page_url) AS product_url,
        ANY_VALUE(country_of_origin) AS country_of_origin

    FROM INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog
    WHERE sku IS NOT NULL
    GROUP BY sku

)

SELECT
    MD5(sku) AS product_id,
    *
FROM deduplicated
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_product"} */;
[0m12:59:14.714175 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.251 seconds
[0m12:59:14.714175 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c598685-d37a-4668-81f3-033c8fbffb0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021660737E80>]}
[0m12:59:14.714175 [info ] [Thread-2 (]: 2 of 3 OK created sql view model ANALYTICS.dim_product ......................... [[32mSUCCESS 1[0m in 0.28s]
[0m12:59:14.714175 [debug] [Thread-2 (]: Finished running node model.dbt_project.dim_product
[0m12:59:14.714175 [debug] [Thread-2 (]: Began running node model.dbt_project.fct_product_snapshot
[0m12:59:14.714175 [info ] [Thread-2 (]: 3 of 3 START sql view model ANALYTICS.fct_product_snapshot ..................... [RUN]
[0m12:59:14.714175 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_product, now model.dbt_project.fct_product_snapshot)
[0m12:59:14.714175 [debug] [Thread-2 (]: Began compiling node model.dbt_project.fct_product_snapshot
[0m12:59:14.724244 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.fct_product_snapshot"
[0m12:59:14.724244 [debug] [Thread-2 (]: Began executing node model.dbt_project.fct_product_snapshot
[0m12:59:14.724244 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.fct_product_snapshot"
[0m12:59:14.724244 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.fct_product_snapshot"
[0m12:59:14.724244 [debug] [Thread-2 (]: On model.dbt_project.fct_product_snapshot: create or replace   view INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.fct_product_snapshot
  
  
  
  
  as (
    SELECT
    d.product_id,
    s.selling_price,
    s.tax_exclusive_price,
    s.avg_rating,
    s.review_count,
    s.in_stock,
    s.scraped_at
FROM INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog s
JOIN INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.dim_product d
    ON s.sku = d.sku
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_product_snapshot"} */;
[0m12:59:15.030293 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.302 seconds
[0m12:59:15.030293 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c598685-d37a-4668-81f3-033c8fbffb0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002164CAA53C0>]}
[0m12:59:15.030293 [info ] [Thread-2 (]: 3 of 3 OK created sql view model ANALYTICS.fct_product_snapshot ................ [[32mSUCCESS 1[0m in 0.32s]
[0m12:59:15.030293 [debug] [Thread-2 (]: Finished running node model.dbt_project.fct_product_snapshot
[0m12:59:15.046360 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:59:15.046360 [debug] [MainThread]: Connection 'list_INDUSTRIAL_PROCUREMENT_DB' was left open.
[0m12:59:15.046360 [debug] [MainThread]: On list_INDUSTRIAL_PROCUREMENT_DB: Close
[0m12:59:15.159641 [debug] [MainThread]: Connection 'list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS' was left open.
[0m12:59:15.175372 [debug] [MainThread]: On list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS: Close
[0m12:59:15.304893 [debug] [MainThread]: Connection 'model.dbt_project.fct_product_snapshot' was left open.
[0m12:59:15.304893 [debug] [MainThread]: On model.dbt_project.fct_product_snapshot: Close
[0m12:59:15.433896 [info ] [MainThread]: 
[0m12:59:15.433896 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 3.13 seconds (3.13s).
[0m12:59:15.433896 [debug] [MainThread]: Command end result
[0m12:59:15.465682 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\manifest.json
[0m12:59:15.481593 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\semantic_manifest.json
[0m12:59:15.481593 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\run_results.json
[0m12:59:15.481593 [info ] [MainThread]: 
[0m12:59:15.481593 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:59:15.497311 [info ] [MainThread]: 
[0m12:59:15.497311 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m12:59:15.497311 [debug] [MainThread]: Command `dbt run` succeeded at 12:59:15.497311 after 6.22 seconds
[0m12:59:15.497311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002164CA14A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002165FFD7B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002165E66AB60>]}
[0m12:59:15.497311 [debug] [MainThread]: Flushing usage events
[0m12:59:16.832071 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:59:36.056259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D21004790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D220CBFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D220CBDF0>]}


============================== 12:59:36.056259 | 77759ec2-826a-4d4f-9394-b0a19a654923 ==============================
[0m12:59:36.056259 [info ] [MainThread]: Running with dbt=1.11.4
[0m12:59:36.056259 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jeeva\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt test', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jeeva\\Desktop\\data_ai_assignment\\dbt_project\\logs'}
[0m12:59:36.946933 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m12:59:36.946933 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m12:59:36.946933 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m12:59:37.217485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77759ec2-826a-4d4f-9394-b0a19a654923', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D32B05540>]}
[0m12:59:37.312878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77759ec2-826a-4d4f-9394-b0a19a654923', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D32B28970>]}
[0m12:59:37.316047 [info ] [MainThread]: Registered adapter: snowflake=1.11.2
[0m12:59:37.855947 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m12:59:38.236647 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:59:38.237653 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m12:59:38.237653 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:59:38.324626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77759ec2-826a-4d4f-9394-b0a19a654923', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D331B0130>]}
[0m12:59:38.472669 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\manifest.json
[0m12:59:38.474416 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\semantic_manifest.json
[0m12:59:38.506189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77759ec2-826a-4d4f-9394-b0a19a654923', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D331B0FA0>]}
[0m12:59:38.506189 [info ] [MainThread]: Found 3 models, 9 data tests, 1 source, 522 macros
[0m12:59:38.506189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77759ec2-826a-4d4f-9394-b0a19a654923', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D331B3310>]}
[0m12:59:38.518925 [info ] [MainThread]: 
[0m12:59:38.518925 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:59:38.518925 [info ] [MainThread]: 
[0m12:59:38.522096 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:59:38.522096 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS'
[0m12:59:38.775901 [debug] [ThreadPool]: Using snowflake connection "list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS"
[0m12:59:38.778641 [debug] [ThreadPool]: On list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS: show objects in INDUSTRIAL_PROCUREMENT_DB.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS"} */;
[0m12:59:38.778641 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:49.248191 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 10.472 seconds
[0m12:59:49.248191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77759ec2-826a-4d4f-9394-b0a19a654923', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D331B0FA0>]}
[0m12:59:49.263945 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_dim_product_product_id.02b1f06816
[0m12:59:49.263945 [info ] [Thread-2 (]: 1 of 9 START test not_null_dim_product_product_id .............................. [RUN]
[0m12:59:49.263945 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_project.not_null_dim_product_product_id.02b1f06816'
[0m12:59:49.263945 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_dim_product_product_id.02b1f06816
[0m12:59:49.295768 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_product_product_id.02b1f06816"
[0m12:59:49.295768 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_dim_product_product_id.02b1f06816
[0m12:59:49.311644 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_dim_product_product_id.02b1f06816"
[0m12:59:49.327353 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_project.not_null_dim_product_product_id.02b1f06816"
[0m12:59:49.327353 [debug] [Thread-2 (]: On test.dbt_project.not_null_dim_product_product_id.02b1f06816: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.dim_product
where product_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_dim_product_product_id.02b1f06816"} */
[0m12:59:49.327353 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:59:50.118396 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.789 seconds
[0m12:59:50.132056 [info ] [Thread-2 (]: 1 of 9 PASS not_null_dim_product_product_id .................................... [[32mPASS[0m in 0.87s]
[0m12:59:50.134154 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_dim_product_product_id.02b1f06816
[0m12:59:50.134154 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_dim_product_sku.deecb558ac
[0m12:59:50.134154 [info ] [Thread-2 (]: 2 of 9 START test not_null_dim_product_sku ..................................... [RUN]
[0m12:59:50.134154 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_product_product_id.02b1f06816, now test.dbt_project.not_null_dim_product_sku.deecb558ac)
[0m12:59:50.134154 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_dim_product_sku.deecb558ac
[0m12:59:50.134154 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_product_sku.deecb558ac"
[0m12:59:50.134154 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_dim_product_sku.deecb558ac
[0m12:59:50.148160 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_dim_product_sku.deecb558ac"
[0m12:59:50.148160 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_project.not_null_dim_product_sku.deecb558ac"
[0m12:59:50.148160 [debug] [Thread-2 (]: On test.dbt_project.not_null_dim_product_sku.deecb558ac: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sku
from INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.dim_product
where sku is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_dim_product_sku.deecb558ac"} */
[0m12:59:50.363862 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.213 seconds
[0m12:59:50.365868 [info ] [Thread-2 (]: 2 of 9 PASS not_null_dim_product_sku ........................................... [[32mPASS[0m in 0.23s]
[0m12:59:50.367874 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_dim_product_sku.deecb558ac
[0m12:59:50.367874 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_fct_product_snapshot_product_id.404631bb0e
[0m12:59:50.369882 [info ] [Thread-2 (]: 3 of 9 START test not_null_fct_product_snapshot_product_id ..................... [RUN]
[0m12:59:50.369882 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_product_sku.deecb558ac, now test.dbt_project.not_null_fct_product_snapshot_product_id.404631bb0e)
[0m12:59:50.371639 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_fct_product_snapshot_product_id.404631bb0e
[0m12:59:50.371639 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_fct_product_snapshot_product_id.404631bb0e"
[0m12:59:50.371639 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_fct_product_snapshot_product_id.404631bb0e
[0m12:59:50.371639 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_fct_product_snapshot_product_id.404631bb0e"
[0m12:59:50.371639 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_project.not_null_fct_product_snapshot_product_id.404631bb0e"
[0m12:59:50.371639 [debug] [Thread-2 (]: On test.dbt_project.not_null_fct_product_snapshot_product_id.404631bb0e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.fct_product_snapshot
where product_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_fct_product_snapshot_product_id.404631bb0e"} */
[0m12:59:50.698475 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.312 seconds
[0m12:59:50.703516 [info ] [Thread-2 (]: 3 of 9 PASS not_null_fct_product_snapshot_product_id ........................... [[32mPASS[0m in 0.33s]
[0m12:59:50.707537 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_fct_product_snapshot_product_id.404631bb0e
[0m12:59:50.707537 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_fct_product_snapshot_scraped_at.55b12f8257
[0m12:59:50.709547 [info ] [Thread-2 (]: 4 of 9 START test not_null_fct_product_snapshot_scraped_at ..................... [RUN]
[0m12:59:50.711556 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_fct_product_snapshot_product_id.404631bb0e, now test.dbt_project.not_null_fct_product_snapshot_scraped_at.55b12f8257)
[0m12:59:50.711556 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_fct_product_snapshot_scraped_at.55b12f8257
[0m12:59:50.719326 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_fct_product_snapshot_scraped_at.55b12f8257"
[0m12:59:50.719326 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_fct_product_snapshot_scraped_at.55b12f8257
[0m12:59:50.719326 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_fct_product_snapshot_scraped_at.55b12f8257"
[0m12:59:50.719326 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_project.not_null_fct_product_snapshot_scraped_at.55b12f8257"
[0m12:59:50.719326 [debug] [Thread-2 (]: On test.dbt_project.not_null_fct_product_snapshot_scraped_at.55b12f8257: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select scraped_at
from INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.fct_product_snapshot
where scraped_at is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_fct_product_snapshot_scraped_at.55b12f8257"} */
[0m12:59:50.911073 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.190 seconds
[0m12:59:50.911073 [info ] [Thread-2 (]: 4 of 9 PASS not_null_fct_product_snapshot_scraped_at ........................... [[32mPASS[0m in 0.20s]
[0m12:59:50.926294 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_fct_product_snapshot_scraped_at.55b12f8257
[0m12:59:50.926294 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_product_catalog_ingestion_id.4f666912e8
[0m12:59:50.928300 [info ] [Thread-2 (]: 5 of 9 START test not_null_stg_product_catalog_ingestion_id .................... [RUN]
[0m12:59:50.928300 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_fct_product_snapshot_scraped_at.55b12f8257, now test.dbt_project.not_null_stg_product_catalog_ingestion_id.4f666912e8)
[0m12:59:50.928300 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_product_catalog_ingestion_id.4f666912e8
[0m12:59:50.928300 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_product_catalog_ingestion_id.4f666912e8"
[0m12:59:50.928300 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_product_catalog_ingestion_id.4f666912e8
[0m12:59:50.928300 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_product_catalog_ingestion_id.4f666912e8"
[0m12:59:50.942296 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_project.not_null_stg_product_catalog_ingestion_id.4f666912e8"
[0m12:59:50.942296 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_product_catalog_ingestion_id.4f666912e8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ingestion_id
from INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog
where ingestion_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_product_catalog_ingestion_id.4f666912e8"} */
[0m12:59:51.081663 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.141 seconds
[0m12:59:51.088085 [info ] [Thread-2 (]: 5 of 9 PASS not_null_stg_product_catalog_ingestion_id .......................... [[32mPASS[0m in 0.16s]
[0m12:59:51.088085 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_product_catalog_ingestion_id.4f666912e8
[0m12:59:51.088085 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_product_catalog_sku.af3b21f368
[0m12:59:51.088085 [info ] [Thread-2 (]: 6 of 9 START test not_null_stg_product_catalog_sku ............................. [RUN]
[0m12:59:51.088085 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_product_catalog_ingestion_id.4f666912e8, now test.dbt_project.not_null_stg_product_catalog_sku.af3b21f368)
[0m12:59:51.088085 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_product_catalog_sku.af3b21f368
[0m12:59:51.088085 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_product_catalog_sku.af3b21f368"
[0m12:59:51.088085 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_product_catalog_sku.af3b21f368
[0m12:59:51.088085 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_product_catalog_sku.af3b21f368"
[0m12:59:51.104072 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_project.not_null_stg_product_catalog_sku.af3b21f368"
[0m12:59:51.104072 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_product_catalog_sku.af3b21f368: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sku
from INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog
where sku is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_product_catalog_sku.af3b21f368"} */
[0m12:59:51.265576 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.174 seconds
[0m12:59:51.281512 [info ] [Thread-2 (]: 6 of 9 PASS not_null_stg_product_catalog_sku ................................... [[32mPASS[0m in 0.19s]
[0m12:59:51.281512 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_product_catalog_sku.af3b21f368
[0m12:59:51.281512 [debug] [Thread-2 (]: Began running node test.dbt_project.relationships_fct_product_snapshot_product_id__product_id__ref_dim_product_.b5b14dc249
[0m12:59:51.281512 [info ] [Thread-2 (]: 7 of 9 START test relationships_fct_product_snapshot_product_id__product_id__ref_dim_product_  [RUN]
[0m12:59:51.281512 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_product_catalog_sku.af3b21f368, now test.dbt_project.relationships_fct_product_snapshot_product_id__product_id__ref_dim_product_.b5b14dc249)
[0m12:59:51.281512 [debug] [Thread-2 (]: Began compiling node test.dbt_project.relationships_fct_product_snapshot_product_id__product_id__ref_dim_product_.b5b14dc249
[0m12:59:51.297344 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.relationships_fct_product_snapshot_product_id__product_id__ref_dim_product_.b5b14dc249"
[0m12:59:51.297344 [debug] [Thread-2 (]: Began executing node test.dbt_project.relationships_fct_product_snapshot_product_id__product_id__ref_dim_product_.b5b14dc249
[0m12:59:51.297344 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.relationships_fct_product_snapshot_product_id__product_id__ref_dim_product_.b5b14dc249"
[0m12:59:51.297344 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_project.relationships_fct_product_snapshot_product_id__product_id__ref_dim_product_.b5b14dc249"
[0m12:59:51.297344 [debug] [Thread-2 (]: On test.dbt_project.relationships_fct_product_snapshot_product_id__product_id__ref_dim_product_.b5b14dc249: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.fct_product_snapshot
    where product_id is not null
),

parent as (
    select product_id as to_field
    from INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_fct_product_snapshot_product_id__product_id__ref_dim_product_.b5b14dc249"} */
[0m12:59:51.718474 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.416 seconds
[0m12:59:51.732451 [info ] [Thread-2 (]: 7 of 9 PASS relationships_fct_product_snapshot_product_id__product_id__ref_dim_product_  [[32mPASS[0m in 0.45s]
[0m12:59:51.732451 [debug] [Thread-2 (]: Finished running node test.dbt_project.relationships_fct_product_snapshot_product_id__product_id__ref_dim_product_.b5b14dc249
[0m12:59:51.732451 [debug] [Thread-2 (]: Began running node test.dbt_project.unique_dim_product_product_id.46495bf7fe
[0m12:59:51.732451 [info ] [Thread-2 (]: 8 of 9 START test unique_dim_product_product_id ................................ [RUN]
[0m12:59:51.732451 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_fct_product_snapshot_product_id__product_id__ref_dim_product_.b5b14dc249, now test.dbt_project.unique_dim_product_product_id.46495bf7fe)
[0m12:59:51.748530 [debug] [Thread-2 (]: Began compiling node test.dbt_project.unique_dim_product_product_id.46495bf7fe
[0m12:59:51.748530 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.unique_dim_product_product_id.46495bf7fe"
[0m12:59:51.748530 [debug] [Thread-2 (]: Began executing node test.dbt_project.unique_dim_product_product_id.46495bf7fe
[0m12:59:51.764239 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.unique_dim_product_product_id.46495bf7fe"
[0m12:59:51.764239 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_project.unique_dim_product_product_id.46495bf7fe"
[0m12:59:51.764239 [debug] [Thread-2 (]: On test.dbt_project.unique_dim_product_product_id.46495bf7fe: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.dim_product
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_dim_product_product_id.46495bf7fe"} */
[0m12:59:51.989839 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.218 seconds
[0m12:59:51.989839 [info ] [Thread-2 (]: 8 of 9 PASS unique_dim_product_product_id ...................................... [[32mPASS[0m in 0.26s]
[0m12:59:51.989839 [debug] [Thread-2 (]: Finished running node test.dbt_project.unique_dim_product_product_id.46495bf7fe
[0m12:59:51.989839 [debug] [Thread-2 (]: Began running node test.dbt_project.unique_stg_product_catalog_ingestion_id.99dfc026eb
[0m12:59:51.989839 [info ] [Thread-2 (]: 9 of 9 START test unique_stg_product_catalog_ingestion_id ...................... [RUN]
[0m12:59:51.989839 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_dim_product_product_id.46495bf7fe, now test.dbt_project.unique_stg_product_catalog_ingestion_id.99dfc026eb)
[0m12:59:51.989839 [debug] [Thread-2 (]: Began compiling node test.dbt_project.unique_stg_product_catalog_ingestion_id.99dfc026eb
[0m12:59:51.989839 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.unique_stg_product_catalog_ingestion_id.99dfc026eb"
[0m12:59:51.989839 [debug] [Thread-2 (]: Began executing node test.dbt_project.unique_stg_product_catalog_ingestion_id.99dfc026eb
[0m12:59:52.005835 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.unique_stg_product_catalog_ingestion_id.99dfc026eb"
[0m12:59:52.005835 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_project.unique_stg_product_catalog_ingestion_id.99dfc026eb"
[0m12:59:52.005835 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_product_catalog_ingestion_id.99dfc026eb: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    ingestion_id as unique_field,
    count(*) as n_records

from INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog
where ingestion_id is not null
group by ingestion_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_product_catalog_ingestion_id.99dfc026eb"} */
[0m12:59:52.196162 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.184 seconds
[0m12:59:52.199910 [info ] [Thread-2 (]: 9 of 9 PASS unique_stg_product_catalog_ingestion_id ............................ [[32mPASS[0m in 0.21s]
[0m12:59:52.199910 [debug] [Thread-2 (]: Finished running node test.dbt_project.unique_stg_product_catalog_ingestion_id.99dfc026eb
[0m12:59:52.202719 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:59:52.202719 [debug] [MainThread]: Connection 'list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS' was left open.
[0m12:59:52.202719 [debug] [MainThread]: On list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS: Close
[0m13:00:01.789708 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_product_catalog_ingestion_id.99dfc026eb' was left open.
[0m13:00:01.789708 [debug] [MainThread]: On test.dbt_project.unique_stg_product_catalog_ingestion_id.99dfc026eb: Close
[0m13:00:01.933994 [info ] [MainThread]: 
[0m13:00:01.933994 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 23.41 seconds (23.41s).
[0m13:00:01.933994 [debug] [MainThread]: Command end result
[0m13:00:01.966049 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\manifest.json
[0m13:00:01.981745 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\semantic_manifest.json
[0m13:00:01.985036 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\run_results.json
[0m13:00:01.985036 [info ] [MainThread]: 
[0m13:00:01.985036 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:00:01.985036 [info ] [MainThread]: 
[0m13:00:01.985036 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m13:00:01.997740 [debug] [MainThread]: Command `dbt test` succeeded at 13:00:01.997740 after 26.04 seconds
[0m13:00:01.997740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D21004790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D1FC4A4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D3314A8F0>]}
[0m13:00:01.997740 [debug] [MainThread]: Flushing usage events
[0m13:00:03.440039 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:03:49.130926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8FF85FF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C880D35090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C880D34EB0>]}


============================== 14:03:49.147002 | d8a5bcfc-f0ba-4f45-aa1d-f82e110b33ba ==============================
[0m14:03:49.147002 [info ] [MainThread]: Running with dbt=1.11.4
[0m14:03:49.147002 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jeeva\\.dbt', 'use_colors': 'True', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jeeva\\Desktop\\data_ai_assignment\\dbt_project\\logs'}
[0m14:03:50.080603 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:03:50.080603 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:03:50.080603 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:03:50.368218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8a5bcfc-f0ba-4f45-aa1d-f82e110b33ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8917AD960>]}
[0m14:03:50.463458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8a5bcfc-f0ba-4f45-aa1d-f82e110b33ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C880CF73A0>]}
[0m14:03:50.463458 [info ] [MainThread]: Registered adapter: snowflake=1.11.2
[0m14:03:51.004428 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m14:03:51.383306 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:03:51.383306 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models\staging\stg_product_catalog.sql
[0m14:03:51.952468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8a5bcfc-f0ba-4f45-aa1d-f82e110b33ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C893200D30>]}
[0m14:03:52.098791 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\manifest.json
[0m14:03:52.101260 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\semantic_manifest.json
[0m14:03:52.135152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8a5bcfc-f0ba-4f45-aa1d-f82e110b33ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C893203670>]}
[0m14:03:52.135152 [info ] [MainThread]: Found 3 models, 9 data tests, 1 source, 522 macros
[0m14:03:52.135152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8a5bcfc-f0ba-4f45-aa1d-f82e110b33ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C893203700>]}
[0m14:03:52.135152 [info ] [MainThread]: 
[0m14:03:52.135152 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:03:52.135152 [info ] [MainThread]: 
[0m14:03:52.135152 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:03:52.145874 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_INDUSTRIAL_PROCUREMENT_DB'
[0m14:03:52.419455 [debug] [ThreadPool]: Using snowflake connection "list_INDUSTRIAL_PROCUREMENT_DB"
[0m14:03:52.423530 [debug] [ThreadPool]: On list_INDUSTRIAL_PROCUREMENT_DB: show terse schemas in database INDUSTRIAL_PROCUREMENT_DB
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_INDUSTRIAL_PROCUREMENT_DB"} */
[0m14:03:52.423530 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:03:53.201021 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.777 seconds
[0m14:03:53.204783 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS'
[0m14:03:53.229446 [debug] [ThreadPool]: Using snowflake connection "list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS"
[0m14:03:53.229446 [debug] [ThreadPool]: On list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS: show objects in INDUSTRIAL_PROCUREMENT_DB.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS"} */;
[0m14:03:53.229446 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:03:53.895867 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.672 seconds
[0m14:03:53.906621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8a5bcfc-f0ba-4f45-aa1d-f82e110b33ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8FCB11720>]}
[0m14:03:53.923068 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_product_catalog
[0m14:03:53.923068 [info ] [Thread-2 (]: 1 of 3 START sql view model ANALYTICS.stg_product_catalog ...................... [RUN]
[0m14:03:53.937943 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_project.stg_product_catalog'
[0m14:03:53.937943 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_product_catalog
[0m14:03:53.937943 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_product_catalog"
[0m14:03:53.937943 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_product_catalog
[0m14:03:53.970056 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_product_catalog"
[0m14:03:53.985720 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.stg_product_catalog"
[0m14:03:53.985720 [debug] [Thread-2 (]: On model.dbt_project.stg_product_catalog: create or replace   view INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog
  
  
  
  
  as (
    WITH base AS (

    SELECT
        ingestion_id,

        raw_product_json:title::string               AS product_name,
        REPLACE(raw_product_json:productBrand::string, 'By ', '') AS brand
        COALESCE(
            raw_product_json:addToCart:action:params:sku::string,
            raw_product_json:sku::string
        ) AS sku,
        raw_product_json:inStock::boolean            AS in_stock,

        NULLIF(raw_product_json:rating:average::float, 0) AS avg_rating,
        raw_product_json:rating:totalReviews::int AS review_count,

        raw_product_json:pricing:prices[0]:value::number(10,2) AS selling_price,
        raw_product_json:pricing:prices[1]:value::number(10,2) AS tax_exclusive_price,

        scraped_at,
        page_url,
        category

    FROM INDUSTRIAL_PROCUREMENT_DB.RAW.product_ingestion
    WHERE raw_product_json:addToCart:action:params:sku IS NOT NULL


),

country AS (

    SELECT
        r.ingestion_id,
        nv.value:value::string AS country_of_origin

    FROM INDUSTRIAL_PROCUREMENT_DB.RAW.product_ingestion r,
    LATERAL FLATTEN(input => r.raw_product_json:familyData:nonVariants) nv
    WHERE nv.value:name::string = 'Country of Origin'
)

SELECT
    b.*,
    c.country_of_origin
FROM base b
LEFT JOIN country c
ON b.ingestion_id = c.ingestion_id
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_product_catalog"} */;
[0m14:03:53.985720 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:03:54.390320 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c25661-3202-5533-0000-0013dc7e7645
[0m14:03:54.390320 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 8 unexpected 'COALESCE'.
syntax error line 15 at position 12 unexpected 'raw_product_json'.
syntax error line 17 at position 10 unexpected 'AS'.
[0m14:03:54.390320 [debug] [Thread-2 (]: Database Error in model stg_product_catalog (models\staging\stg_product_catalog.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 8 unexpected 'COALESCE'.
  syntax error line 15 at position 12 unexpected 'raw_product_json'.
  syntax error line 17 at position 10 unexpected 'AS'.
  compiled code at target\run\dbt_project\models\staging\stg_product_catalog.sql
[0m14:03:54.405011 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8a5bcfc-f0ba-4f45-aa1d-f82e110b33ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8938C3AF0>]}
[0m14:03:54.405011 [error] [Thread-2 (]: 1 of 3 ERROR creating sql view model ANALYTICS.stg_product_catalog ............. [[31mERROR[0m in 0.45s]
[0m14:03:54.405011 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_product_catalog
[0m14:03:54.405011 [debug] [Thread-5 (]: Marking all children of 'model.dbt_project.stg_product_catalog' to be skipped because of status 'error'.  Reason: Database Error in model stg_product_catalog (models\staging\stg_product_catalog.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 8 unexpected 'COALESCE'.
  syntax error line 15 at position 12 unexpected 'raw_product_json'.
  syntax error line 17 at position 10 unexpected 'AS'.
  compiled code at target\run\dbt_project\models\staging\stg_product_catalog.sql.
[0m14:03:54.405011 [debug] [Thread-2 (]: Began running node model.dbt_project.dim_product
[0m14:03:54.405011 [info ] [Thread-2 (]: 2 of 3 SKIP relation ANALYTICS.dim_product ..................................... [[33mSKIP[0m]
[0m14:03:54.405011 [debug] [Thread-2 (]: Finished running node model.dbt_project.dim_product
[0m14:03:54.405011 [debug] [Thread-2 (]: Began running node model.dbt_project.fct_product_snapshot
[0m14:03:54.405011 [info ] [Thread-2 (]: 3 of 3 SKIP relation ANALYTICS.fct_product_snapshot ............................ [[33mSKIP[0m]
[0m14:03:54.405011 [debug] [Thread-2 (]: Finished running node model.dbt_project.fct_product_snapshot
[0m14:03:54.405011 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:03:54.405011 [debug] [MainThread]: Connection 'list_INDUSTRIAL_PROCUREMENT_DB' was left open.
[0m14:03:54.405011 [debug] [MainThread]: On list_INDUSTRIAL_PROCUREMENT_DB: Close
[0m14:03:54.534769 [debug] [MainThread]: Connection 'list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS' was left open.
[0m14:03:54.536790 [debug] [MainThread]: On list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS: Close
[0m14:03:54.697269 [debug] [MainThread]: Connection 'model.dbt_project.stg_product_catalog' was left open.
[0m14:03:54.709853 [debug] [MainThread]: On model.dbt_project.stg_product_catalog: Close
[0m14:03:54.839006 [info ] [MainThread]: 
[0m14:03:54.855105 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 2.70 seconds (2.70s).
[0m14:03:54.855105 [debug] [MainThread]: Command end result
[0m14:03:54.886689 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\manifest.json
[0m14:03:54.902513 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\semantic_manifest.json
[0m14:03:54.902513 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\run_results.json
[0m14:03:54.902513 [info ] [MainThread]: 
[0m14:03:54.902513 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:03:54.902513 [info ] [MainThread]: 
[0m14:03:54.902513 [error] [MainThread]: [31mFailure in model stg_product_catalog (models\staging\stg_product_catalog.sql)[0m
[0m14:03:54.902513 [error] [MainThread]:   Database Error in model stg_product_catalog (models\staging\stg_product_catalog.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 8 unexpected 'COALESCE'.
  syntax error line 15 at position 12 unexpected 'raw_product_json'.
  syntax error line 17 at position 10 unexpected 'AS'.
  compiled code at target\run\dbt_project\models\staging\stg_product_catalog.sql
[0m14:03:54.902513 [info ] [MainThread]: 
[0m14:03:54.918377 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\staging\stg_product_catalog.sql
[0m14:03:54.918377 [info ] [MainThread]: 
[0m14:03:54.918377 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=3
[0m14:03:54.918377 [debug] [MainThread]: Command `dbt run` failed at 14:03:54.918377 after 5.90 seconds
[0m14:03:54.918377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8FF85FF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8917AFDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8FFC15DE0>]}
[0m14:03:54.918377 [debug] [MainThread]: Flushing usage events
[0m14:03:56.289146 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:04:36.154343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011D8D49A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011E997C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011E997E50>]}


============================== 14:04:36.154343 | 43d4bf9a-7f45-401c-9500-77ae5f03f453 ==============================
[0m14:04:36.154343 [info ] [MainThread]: Running with dbt=1.11.4
[0m14:04:36.154343 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\jeeva\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jeeva\\Desktop\\data_ai_assignment\\dbt_project\\logs'}
[0m14:04:37.056527 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:04:37.056527 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:04:37.056527 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:04:37.327109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43d4bf9a-7f45-401c-9500-77ae5f03f453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011E997B80>]}
[0m14:04:37.406455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43d4bf9a-7f45-401c-9500-77ae5f03f453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011E1E09D0>]}
[0m14:04:37.422578 [info ] [MainThread]: Registered adapter: snowflake=1.11.2
[0m14:04:37.964291 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m14:04:38.353658 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:04:38.353658 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models\staging\stg_product_catalog.sql
[0m14:04:38.927719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43d4bf9a-7f45-401c-9500-77ae5f03f453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002012FE7D750>]}
[0m14:04:39.075864 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\manifest.json
[0m14:04:39.077870 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\semantic_manifest.json
[0m14:04:39.113194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43d4bf9a-7f45-401c-9500-77ae5f03f453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002012FA2A800>]}
[0m14:04:39.113194 [info ] [MainThread]: Found 3 models, 9 data tests, 1 source, 522 macros
[0m14:04:39.113194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43d4bf9a-7f45-401c-9500-77ae5f03f453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002012FA2AB90>]}
[0m14:04:39.116304 [info ] [MainThread]: 
[0m14:04:39.117815 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:04:39.117815 [info ] [MainThread]: 
[0m14:04:39.117815 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:04:39.125255 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_INDUSTRIAL_PROCUREMENT_DB'
[0m14:04:39.369814 [debug] [ThreadPool]: Using snowflake connection "list_INDUSTRIAL_PROCUREMENT_DB"
[0m14:04:39.369814 [debug] [ThreadPool]: On list_INDUSTRIAL_PROCUREMENT_DB: show terse schemas in database INDUSTRIAL_PROCUREMENT_DB
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_INDUSTRIAL_PROCUREMENT_DB"} */
[0m14:04:39.369814 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:40.230350 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.863 seconds
[0m14:04:40.238597 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS'
[0m14:04:40.255393 [debug] [ThreadPool]: Using snowflake connection "list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS"
[0m14:04:40.255393 [debug] [ThreadPool]: On list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS: show objects in INDUSTRIAL_PROCUREMENT_DB.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS"} */;
[0m14:04:40.257398 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:41.037774 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.784 seconds
[0m14:04:41.053563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43d4bf9a-7f45-401c-9500-77ae5f03f453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002012F354F10>]}
[0m14:04:41.053563 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_product_catalog
[0m14:04:41.053563 [info ] [Thread-2 (]: 1 of 3 START sql view model ANALYTICS.stg_product_catalog ...................... [RUN]
[0m14:04:41.053563 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_project.stg_product_catalog'
[0m14:04:41.053563 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_product_catalog
[0m14:04:41.069438 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_product_catalog"
[0m14:04:41.069438 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_product_catalog
[0m14:04:41.101157 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_product_catalog"
[0m14:04:41.101157 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.stg_product_catalog"
[0m14:04:41.101157 [debug] [Thread-2 (]: On model.dbt_project.stg_product_catalog: create or replace   view INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog
  
  
  
  
  as (
    WITH base AS (

    SELECT
        ingestion_id,

        raw_product_json:title::string               AS product_name,
        REPLACE(raw_product_json:productBrand::string, 'By ', '') AS brand,
        COALESCE(
            raw_product_json:addToCart:action:params:sku::string,
            raw_product_json:sku::string
        ) AS sku,
        raw_product_json:inStock::boolean            AS in_stock,

        NULLIF(raw_product_json:rating:average::float, 0) AS avg_rating,
        raw_product_json:rating:totalReviews::int AS review_count,

        raw_product_json:pricing:prices[0]:value::number(10,2) AS selling_price,
        raw_product_json:pricing:prices[1]:value::number(10,2) AS tax_exclusive_price,

        scraped_at,
        page_url,
        category

    FROM INDUSTRIAL_PROCUREMENT_DB.RAW.product_ingestion
    WHERE raw_product_json:addToCart:action:params:sku IS NOT NULL


),

country AS (

    SELECT
        r.ingestion_id,
        nv.value:value::string AS country_of_origin

    FROM INDUSTRIAL_PROCUREMENT_DB.RAW.product_ingestion r,
    LATERAL FLATTEN(input => r.raw_product_json:familyData:nonVariants) nv
    WHERE nv.value:name::string = 'Country of Origin'
)

SELECT
    b.*,
    c.country_of_origin
FROM base b
LEFT JOIN country c
ON b.ingestion_id = c.ingestion_id
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_product_catalog"} */;
[0m14:04:41.101157 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:04:41.680256 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.566 seconds
[0m14:04:41.728163 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43d4bf9a-7f45-401c-9500-77ae5f03f453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011E93CDF0>]}
[0m14:04:41.728163 [info ] [Thread-2 (]: 1 of 3 OK created sql view model ANALYTICS.stg_product_catalog ................. [[32mSUCCESS 1[0m in 0.67s]
[0m14:04:41.728163 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_product_catalog
[0m14:04:41.728163 [debug] [Thread-2 (]: Began running node model.dbt_project.dim_product
[0m14:04:41.728163 [info ] [Thread-2 (]: 2 of 3 START sql view model ANALYTICS.dim_product .............................. [RUN]
[0m14:04:41.728163 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_product_catalog, now model.dbt_project.dim_product)
[0m14:04:41.728163 [debug] [Thread-2 (]: Began compiling node model.dbt_project.dim_product
[0m14:04:41.728163 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.dim_product"
[0m14:04:41.728163 [debug] [Thread-2 (]: Began executing node model.dbt_project.dim_product
[0m14:04:41.744238 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.dim_product"
[0m14:04:41.744238 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.dim_product"
[0m14:04:41.744238 [debug] [Thread-2 (]: On model.dbt_project.dim_product: create or replace   view INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.dim_product
  
  
  
  
  as (
    WITH deduplicated AS (

    SELECT
        sku,
        ANY_VALUE(product_name) AS product_name,
        ANY_VALUE(brand) AS brand,
        ANY_VALUE(category) AS category,
        ANY_VALUE(page_url) AS product_url,
        ANY_VALUE(country_of_origin) AS country_of_origin

    FROM INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog
    WHERE sku IS NOT NULL
    GROUP BY sku

)

SELECT
    MD5(sku) AS product_id,
    *
FROM deduplicated
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_product"} */;
[0m14:04:43.164553 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.413 seconds
[0m14:04:43.164553 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43d4bf9a-7f45-401c-9500-77ae5f03f453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201315F7E20>]}
[0m14:04:43.164553 [info ] [Thread-2 (]: 2 of 3 OK created sql view model ANALYTICS.dim_product ......................... [[32mSUCCESS 1[0m in 1.44s]
[0m14:04:43.164553 [debug] [Thread-2 (]: Finished running node model.dbt_project.dim_product
[0m14:04:43.164553 [debug] [Thread-2 (]: Began running node model.dbt_project.fct_product_snapshot
[0m14:04:43.164553 [info ] [Thread-2 (]: 3 of 3 START sql view model ANALYTICS.fct_product_snapshot ..................... [RUN]
[0m14:04:43.164553 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_product, now model.dbt_project.fct_product_snapshot)
[0m14:04:43.164553 [debug] [Thread-2 (]: Began compiling node model.dbt_project.fct_product_snapshot
[0m14:04:43.176610 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.fct_product_snapshot"
[0m14:04:43.178615 [debug] [Thread-2 (]: Began executing node model.dbt_project.fct_product_snapshot
[0m14:04:43.184393 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.fct_product_snapshot"
[0m14:04:43.186400 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.fct_product_snapshot"
[0m14:04:43.186400 [debug] [Thread-2 (]: On model.dbt_project.fct_product_snapshot: create or replace   view INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.fct_product_snapshot
  
  
  
  
  as (
    SELECT
    d.product_id,
    s.selling_price,
    s.tax_exclusive_price,
    s.avg_rating,
    s.review_count,
    s.in_stock,
    s.scraped_at
FROM INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog s
JOIN INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.dim_product d
    ON s.sku = d.sku
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_product_snapshot"} */;
[0m14:04:43.493160 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.309 seconds
[0m14:04:43.493160 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43d4bf9a-7f45-401c-9500-77ae5f03f453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201315D8760>]}
[0m14:04:43.493160 [info ] [Thread-2 (]: 3 of 3 OK created sql view model ANALYTICS.fct_product_snapshot ................ [[32mSUCCESS 1[0m in 0.33s]
[0m14:04:43.503693 [debug] [Thread-2 (]: Finished running node model.dbt_project.fct_product_snapshot
[0m14:04:43.503693 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:04:43.503693 [debug] [MainThread]: Connection 'list_INDUSTRIAL_PROCUREMENT_DB' was left open.
[0m14:04:43.503693 [debug] [MainThread]: On list_INDUSTRIAL_PROCUREMENT_DB: Close
[0m14:04:43.649325 [debug] [MainThread]: Connection 'list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS' was left open.
[0m14:04:43.649325 [debug] [MainThread]: On list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS: Close
[0m14:04:43.766225 [debug] [MainThread]: Connection 'model.dbt_project.fct_product_snapshot' was left open.
[0m14:04:43.766225 [debug] [MainThread]: On model.dbt_project.fct_product_snapshot: Close
[0m14:04:45.052571 [info ] [MainThread]: 
[0m14:04:45.052571 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 5.93 seconds (5.93s).
[0m14:04:45.052571 [debug] [MainThread]: Command end result
[0m14:04:45.084592 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\manifest.json
[0m14:04:45.084592 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\semantic_manifest.json
[0m14:04:45.100384 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\run_results.json
[0m14:04:45.100384 [info ] [MainThread]: 
[0m14:04:45.100384 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:04:45.100384 [info ] [MainThread]: 
[0m14:04:45.100384 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m14:04:45.100384 [debug] [MainThread]: Command `dbt run` succeeded at 14:04:45.100384 after 9.06 seconds
[0m14:04:45.100384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011D8D49A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011B264220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002012FDFC850>]}
[0m14:04:45.100384 [debug] [MainThread]: Flushing usage events
[0m14:04:46.485241 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:19:55.760915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAABFF45B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAAD0CBC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAAD0CBA90>]}


============================== 14:19:55.760915 | feb9daca-bb05-4549-bb50-8de082c9de91 ==============================
[0m14:19:55.760915 [info ] [MainThread]: Running with dbt=1.11.4
[0m14:19:55.776648 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jeeva\\.dbt', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jeeva\\Desktop\\data_ai_assignment\\dbt_project\\logs'}
[0m14:19:56.681290 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:19:56.681290 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:19:56.681290 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:19:56.969301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'feb9daca-bb05-4549-bb50-8de082c9de91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAAD0CBD30>]}
[0m14:19:57.048656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'feb9daca-bb05-4549-bb50-8de082c9de91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAAC97AFB0>]}
[0m14:19:57.054766 [info ] [MainThread]: Registered adapter: snowflake=1.11.2
[0m14:19:57.601199 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m14:19:57.973404 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:19:57.973404 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models\staging\stg_product_catalog.sql
[0m14:19:58.538523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'feb9daca-bb05-4549-bb50-8de082c9de91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABF57D330>]}
[0m14:19:58.682225 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\manifest.json
[0m14:19:58.682225 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\semantic_manifest.json
[0m14:19:58.714317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'feb9daca-bb05-4549-bb50-8de082c9de91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABF50AA40>]}
[0m14:19:58.727806 [info ] [MainThread]: Found 3 models, 9 data tests, 1 source, 522 macros
[0m14:19:58.727806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'feb9daca-bb05-4549-bb50-8de082c9de91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABE141720>]}
[0m14:19:58.730228 [info ] [MainThread]: 
[0m14:19:58.730228 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:19:58.730228 [info ] [MainThread]: 
[0m14:19:58.730228 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:19:58.730228 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_INDUSTRIAL_PROCUREMENT_DB'
[0m14:19:58.982054 [debug] [ThreadPool]: Using snowflake connection "list_INDUSTRIAL_PROCUREMENT_DB"
[0m14:19:58.984060 [debug] [ThreadPool]: On list_INDUSTRIAL_PROCUREMENT_DB: show terse schemas in database INDUSTRIAL_PROCUREMENT_DB
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_INDUSTRIAL_PROCUREMENT_DB"} */
[0m14:19:58.984060 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:19:59.881596 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.908 seconds
[0m14:19:59.894634 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS'
[0m14:19:59.920348 [debug] [ThreadPool]: Using snowflake connection "list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS"
[0m14:19:59.920348 [debug] [ThreadPool]: On list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS: show objects in INDUSTRIAL_PROCUREMENT_DB.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS"} */;
[0m14:19:59.920348 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:00.363982 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.446 seconds
[0m14:20:00.375730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'feb9daca-bb05-4549-bb50-8de082c9de91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAA97D96C0>]}
[0m14:20:00.375730 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_product_catalog
[0m14:20:00.375730 [info ] [Thread-2 (]: 1 of 3 START sql view model ANALYTICS.stg_product_catalog ...................... [RUN]
[0m14:20:00.375730 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_project.stg_product_catalog'
[0m14:20:00.375730 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_product_catalog
[0m14:20:00.391635 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_product_catalog"
[0m14:20:00.391635 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_product_catalog
[0m14:20:00.423437 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_product_catalog"
[0m14:20:00.423437 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.stg_product_catalog"
[0m14:20:00.439284 [debug] [Thread-2 (]: On model.dbt_project.stg_product_catalog: create or replace   view INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog
  
  
  
  
  as (
    WITH base AS (

    SELECT
        ingestion_id,

        raw_product_json:title::string               AS product_name,
        REPLACE(raw_product_json:productBrand::string, 'By ', '') AS brand,
        COALESCE(
            raw_product_json:addToCart:action:params:sku::string,
            raw_product_json:sku::string
        ) AS sku,
        raw_product_json:inStock::boolean            AS in_stock,

        NULLIF(raw_product_json:rating:average::float, 0) AS avg_rating,
        raw_product_json:rating:totalReviews::int AS review_count,

        raw_product_json:pricing:prices[0]:value::number(10,2) AS selling_price,
        raw_product_json:pricing:prices[1]:value::number(10,2) AS tax_exclusive_price,

        scraped_at,
        page_url,
        category,
        COALESCE(
            raw_product_json:skuLeadTime::string,
            raw_product_json:oosAvailable::string
        ) AS lead_time


    FROM INDUSTRIAL_PROCUREMENT_DB.RAW.product_ingestion
    WHERE raw_product_json:addToCart:action:params:sku IS NOT NULL


),

country AS (

    SELECT
        r.ingestion_id,
        nv.value:value::string AS country_of_origin

    FROM INDUSTRIAL_PROCUREMENT_DB.RAW.product_ingestion r,
    LATERAL FLATTEN(input => r.raw_product_json:familyData:nonVariants) nv
    WHERE nv.value:name::string = 'Country of Origin'
)

SELECT
    b.*,
    c.country_of_origin
FROM base b
LEFT JOIN country c
ON b.ingestion_id = c.ingestion_id
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_product_catalog"} */;
[0m14:20:00.439284 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:20:01.170007 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.730 seconds
[0m14:20:01.198469 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'feb9daca-bb05-4549-bb50-8de082c9de91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAAD0CAC80>]}
[0m14:20:01.198469 [info ] [Thread-2 (]: 1 of 3 OK created sql view model ANALYTICS.stg_product_catalog ................. [[32mSUCCESS 1[0m in 0.82s]
[0m14:20:01.198469 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_product_catalog
[0m14:20:01.198469 [debug] [Thread-2 (]: Began running node model.dbt_project.dim_product
[0m14:20:01.198469 [info ] [Thread-2 (]: 2 of 3 START sql view model ANALYTICS.dim_product .............................. [RUN]
[0m14:20:01.198469 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_product_catalog, now model.dbt_project.dim_product)
[0m14:20:01.198469 [debug] [Thread-2 (]: Began compiling node model.dbt_project.dim_product
[0m14:20:01.198469 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.dim_product"
[0m14:20:01.214215 [debug] [Thread-2 (]: Began executing node model.dbt_project.dim_product
[0m14:20:01.214215 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.dim_product"
[0m14:20:01.214215 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.dim_product"
[0m14:20:01.214215 [debug] [Thread-2 (]: On model.dbt_project.dim_product: create or replace   view INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.dim_product
  
  
  
  
  as (
    WITH deduplicated AS (

    SELECT
        sku,
        ANY_VALUE(product_name) AS product_name,
        ANY_VALUE(brand) AS brand,
        ANY_VALUE(category) AS category,
        ANY_VALUE(page_url) AS product_url,
        ANY_VALUE(country_of_origin) AS country_of_origin

    FROM INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog
    WHERE sku IS NOT NULL
    GROUP BY sku

)

SELECT
    MD5(sku) AS product_id,
    *
FROM deduplicated
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_product"} */;
[0m14:20:01.456133 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.242 seconds
[0m14:20:01.456133 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'feb9daca-bb05-4549-bb50-8de082c9de91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABFD26020>]}
[0m14:20:01.456133 [info ] [Thread-2 (]: 2 of 3 OK created sql view model ANALYTICS.dim_product ......................... [[32mSUCCESS 1[0m in 0.26s]
[0m14:20:01.456133 [debug] [Thread-2 (]: Finished running node model.dbt_project.dim_product
[0m14:20:01.472020 [debug] [Thread-2 (]: Began running node model.dbt_project.fct_product_snapshot
[0m14:20:01.472020 [info ] [Thread-2 (]: 3 of 3 START sql view model ANALYTICS.fct_product_snapshot ..................... [RUN]
[0m14:20:01.472020 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_product, now model.dbt_project.fct_product_snapshot)
[0m14:20:01.472020 [debug] [Thread-2 (]: Began compiling node model.dbt_project.fct_product_snapshot
[0m14:20:01.472020 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.fct_product_snapshot"
[0m14:20:01.472020 [debug] [Thread-2 (]: Began executing node model.dbt_project.fct_product_snapshot
[0m14:20:01.472020 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.fct_product_snapshot"
[0m14:20:01.472020 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.fct_product_snapshot"
[0m14:20:01.472020 [debug] [Thread-2 (]: On model.dbt_project.fct_product_snapshot: create or replace   view INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.fct_product_snapshot
  
  
  
  
  as (
    SELECT
    d.product_id,
    s.selling_price,
    s.tax_exclusive_price,
    s.avg_rating,
    s.review_count,
    s.in_stock,
    s.scraped_at
FROM INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog s
JOIN INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.dim_product d
    ON s.sku = d.sku
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_product_snapshot"} */;
[0m14:20:01.782393 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.304 seconds
[0m14:20:01.795296 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'feb9daca-bb05-4549-bb50-8de082c9de91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABFD25660>]}
[0m14:20:01.795296 [info ] [Thread-2 (]: 3 of 3 OK created sql view model ANALYTICS.fct_product_snapshot ................ [[32mSUCCESS 1[0m in 0.32s]
[0m14:20:01.795296 [debug] [Thread-2 (]: Finished running node model.dbt_project.fct_product_snapshot
[0m14:20:01.795296 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:20:01.795296 [debug] [MainThread]: Connection 'list_INDUSTRIAL_PROCUREMENT_DB' was left open.
[0m14:20:01.795296 [debug] [MainThread]: On list_INDUSTRIAL_PROCUREMENT_DB: Close
[0m14:20:01.930740 [debug] [MainThread]: Connection 'list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS' was left open.
[0m14:20:01.932748 [debug] [MainThread]: On list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS: Close
[0m14:20:02.071202 [debug] [MainThread]: Connection 'model.dbt_project.fct_product_snapshot' was left open.
[0m14:20:02.071202 [debug] [MainThread]: On model.dbt_project.fct_product_snapshot: Close
[0m14:20:02.218483 [info ] [MainThread]: 
[0m14:20:02.218483 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 3.49 seconds (3.49s).
[0m14:20:02.235678 [debug] [MainThread]: Command end result
[0m14:20:02.280388 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\manifest.json
[0m14:20:02.280388 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\semantic_manifest.json
[0m14:20:02.296306 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\run_results.json
[0m14:20:02.296306 [info ] [MainThread]: 
[0m14:20:02.296306 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:20:02.296306 [info ] [MainThread]: 
[0m14:20:02.296306 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m14:20:02.296306 [debug] [MainThread]: Command `dbt run` succeeded at 14:20:02.296306 after 6.64 seconds
[0m14:20:02.296306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAABFF45B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABF5B58A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAAC97AFB0>]}
[0m14:20:02.296306 [debug] [MainThread]: Flushing usage events
[0m14:20:03.632621 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:22:36.793575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230FA2E4A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230FB3ABC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230FB3ABF10>]}


============================== 14:22:36.807659 | 233861c5-17a9-4959-afa9-b39385aa6edd ==============================
[0m14:22:36.807659 [info ] [MainThread]: Running with dbt=1.11.4
[0m14:22:36.807659 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jeeva\\.dbt', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jeeva\\Desktop\\data_ai_assignment\\dbt_project\\logs'}
[0m14:22:37.696068 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:22:37.696068 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:22:37.696068 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:22:38.000082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '233861c5-17a9-4959-afa9-b39385aa6edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230FB322D10>]}
[0m14:22:38.078199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '233861c5-17a9-4959-afa9-b39385aa6edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002308BDDB940>]}
[0m14:22:38.078199 [info ] [MainThread]: Registered adapter: snowflake=1.11.2
[0m14:22:38.649700 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m14:22:39.047528 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:22:39.047528 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models\marts\fct_product_snapshot.sql
[0m14:22:39.047528 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models\marts\dim_product.sql
[0m14:22:39.521649 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on
'fct_product_snapshot' in package 'dbt_project' (models\schema.yml). Arguments
to generic tests should be nested under the `arguments` property.
[0m14:22:39.521649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '233861c5-17a9-4959-afa9-b39385aa6edd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002308C763010>]}
[0m14:22:39.700474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '233861c5-17a9-4959-afa9-b39385aa6edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002308D87E050>]}
[0m14:22:39.843489 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\manifest.json
[0m14:22:39.843489 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\semantic_manifest.json
[0m14:22:39.890862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '233861c5-17a9-4959-afa9-b39385aa6edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002308C435030>]}
[0m14:22:39.890862 [info ] [MainThread]: Found 3 models, 9 data tests, 1 source, 522 macros
[0m14:22:39.890862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '233861c5-17a9-4959-afa9-b39385aa6edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002308C435000>]}
[0m14:22:39.890862 [info ] [MainThread]: 
[0m14:22:39.890862 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:22:39.890862 [info ] [MainThread]: 
[0m14:22:39.890862 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:22:39.890862 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_INDUSTRIAL_PROCUREMENT_DB'
[0m14:22:40.145748 [debug] [ThreadPool]: Using snowflake connection "list_INDUSTRIAL_PROCUREMENT_DB"
[0m14:22:40.149630 [debug] [ThreadPool]: On list_INDUSTRIAL_PROCUREMENT_DB: show terse schemas in database INDUSTRIAL_PROCUREMENT_DB
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_INDUSTRIAL_PROCUREMENT_DB"} */
[0m14:22:40.149630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:40.878123 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.728 seconds
[0m14:22:40.880131 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS'
[0m14:22:40.896237 [debug] [ThreadPool]: Using snowflake connection "list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS"
[0m14:22:40.896237 [debug] [ThreadPool]: On list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS: show objects in INDUSTRIAL_PROCUREMENT_DB.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS"} */;
[0m14:22:40.896237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:41.337204 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.436 seconds
[0m14:22:41.344979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '233861c5-17a9-4959-afa9-b39385aa6edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230F7AB8DC0>]}
[0m14:22:41.353013 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_product_catalog
[0m14:22:41.353013 [info ] [Thread-2 (]: 1 of 3 START sql view model ANALYTICS.stg_product_catalog ...................... [RUN]
[0m14:22:41.355021 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_project.stg_product_catalog'
[0m14:22:41.357029 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_product_catalog
[0m14:22:41.366817 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_product_catalog"
[0m14:22:41.366817 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_product_catalog
[0m14:22:41.408266 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_product_catalog"
[0m14:22:41.408266 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.stg_product_catalog"
[0m14:22:41.408266 [debug] [Thread-2 (]: On model.dbt_project.stg_product_catalog: create or replace   view INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog
  
  
  
  
  as (
    WITH base AS (

    SELECT
        ingestion_id,

        raw_product_json:title::string               AS product_name,
        REPLACE(raw_product_json:productBrand::string, 'By ', '') AS brand,
        COALESCE(
            raw_product_json:addToCart:action:params:sku::string,
            raw_product_json:sku::string
        ) AS sku,
        raw_product_json:inStock::boolean            AS in_stock,

        NULLIF(raw_product_json:rating:average::float, 0) AS avg_rating,
        raw_product_json:rating:totalReviews::int AS review_count,

        raw_product_json:pricing:prices[0]:value::number(10,2) AS selling_price,
        raw_product_json:pricing:prices[1]:value::number(10,2) AS tax_exclusive_price,

        scraped_at,
        page_url,
        category,
        COALESCE(
            raw_product_json:skuLeadTime::string,
            raw_product_json:oosAvailable::string
        ) AS lead_time


    FROM INDUSTRIAL_PROCUREMENT_DB.RAW.product_ingestion
    WHERE raw_product_json:addToCart:action:params:sku IS NOT NULL


),

country AS (

    SELECT
        r.ingestion_id,
        nv.value:value::string AS country_of_origin

    FROM INDUSTRIAL_PROCUREMENT_DB.RAW.product_ingestion r,
    LATERAL FLATTEN(input => r.raw_product_json:familyData:nonVariants) nv
    WHERE nv.value:name::string = 'Country of Origin'
)

SELECT
    b.*,
    c.country_of_origin
FROM base b
LEFT JOIN country c
ON b.ingestion_id = c.ingestion_id
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_product_catalog"} */;
[0m14:22:41.408266 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:22:42.130367 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.712 seconds
[0m14:22:42.173838 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '233861c5-17a9-4959-afa9-b39385aa6edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230FB3A9060>]}
[0m14:22:42.189714 [info ] [Thread-2 (]: 1 of 3 OK created sql view model ANALYTICS.stg_product_catalog ................. [[32mSUCCESS 1[0m in 0.82s]
[0m14:22:42.189714 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_product_catalog
[0m14:22:42.189714 [debug] [Thread-2 (]: Began running node model.dbt_project.dim_product
[0m14:22:42.189714 [info ] [Thread-2 (]: 2 of 3 START sql view model ANALYTICS.dim_product .............................. [RUN]
[0m14:22:42.189714 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_product_catalog, now model.dbt_project.dim_product)
[0m14:22:42.189714 [debug] [Thread-2 (]: Began compiling node model.dbt_project.dim_product
[0m14:22:42.189714 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.dim_product"
[0m14:22:42.189714 [debug] [Thread-2 (]: Began executing node model.dbt_project.dim_product
[0m14:22:42.189714 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.dim_product"
[0m14:22:42.205724 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.dim_product"
[0m14:22:42.205724 [debug] [Thread-2 (]: On model.dbt_project.dim_product: create or replace   view INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.dim_product
  
  
  
  
  as (
    WITH deduplicated AS (

    SELECT
        sku,
        ANY_VALUE(product_name) AS product_name,
        ANY_VALUE(brand) AS brand,
        ANY_VALUE(category) AS category,
        ANY_VALUE(page_url) AS product_url,
        ANY_VALUE(country_of_origin) AS country_of_origin
        ANY_VALUE(lead_time) AS lead_time

    FROM INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog
    WHERE sku IS NOT NULL
    GROUP BY sku

)

SELECT
    MD5(sku) AS product_id,
    *
FROM deduplicated
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_product"} */;
[0m14:22:42.290037 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01c25674-3202-54a3-0000-0013dc7e8e01
[0m14:22:42.290037 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 8 unexpected 'ANY_VALUE'.
syntax error line 16 at position 18 unexpected 'lead_time'.
syntax error line 16 at position 29 unexpected 'AS'.
[0m14:22:42.301896 [debug] [Thread-2 (]: Database Error in model dim_product (models\marts\dim_product.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 8 unexpected 'ANY_VALUE'.
  syntax error line 16 at position 18 unexpected 'lead_time'.
  syntax error line 16 at position 29 unexpected 'AS'.
  compiled code at target\run\dbt_project\models\marts\dim_product.sql
[0m14:22:42.301896 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '233861c5-17a9-4959-afa9-b39385aa6edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002308E05DF00>]}
[0m14:22:42.301896 [error] [Thread-2 (]: 2 of 3 ERROR creating sql view model ANALYTICS.dim_product ..................... [[31mERROR[0m in 0.11s]
[0m14:22:42.301896 [debug] [Thread-2 (]: Finished running node model.dbt_project.dim_product
[0m14:22:42.301896 [debug] [Thread-5 (]: Marking all children of 'model.dbt_project.dim_product' to be skipped because of status 'error'.  Reason: Database Error in model dim_product (models\marts\dim_product.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 8 unexpected 'ANY_VALUE'.
  syntax error line 16 at position 18 unexpected 'lead_time'.
  syntax error line 16 at position 29 unexpected 'AS'.
  compiled code at target\run\dbt_project\models\marts\dim_product.sql.
[0m14:22:42.301896 [debug] [Thread-2 (]: Began running node model.dbt_project.fct_product_snapshot
[0m14:22:42.318009 [info ] [Thread-2 (]: 3 of 3 SKIP relation ANALYTICS.fct_product_snapshot ............................ [[33mSKIP[0m]
[0m14:22:42.318009 [debug] [Thread-2 (]: Finished running node model.dbt_project.fct_product_snapshot
[0m14:22:42.318009 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:22:42.318009 [debug] [MainThread]: Connection 'list_INDUSTRIAL_PROCUREMENT_DB' was left open.
[0m14:22:42.318009 [debug] [MainThread]: On list_INDUSTRIAL_PROCUREMENT_DB: Close
[0m14:22:42.446755 [debug] [MainThread]: Connection 'list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS' was left open.
[0m14:22:42.446755 [debug] [MainThread]: On list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS: Close
[0m14:22:42.591623 [debug] [MainThread]: Connection 'model.dbt_project.dim_product' was left open.
[0m14:22:42.591623 [debug] [MainThread]: On model.dbt_project.dim_product: Close
[0m14:22:42.720385 [info ] [MainThread]: 
[0m14:22:42.720385 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 2.83 seconds (2.83s).
[0m14:22:42.720385 [debug] [MainThread]: Command end result
[0m14:22:42.752451 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\manifest.json
[0m14:22:42.768262 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\semantic_manifest.json
[0m14:22:42.768262 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\run_results.json
[0m14:22:42.768262 [info ] [MainThread]: 
[0m14:22:42.768262 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:22:42.768262 [info ] [MainThread]: 
[0m14:22:42.768262 [error] [MainThread]: [31mFailure in model dim_product (models\marts\dim_product.sql)[0m
[0m14:22:42.783969 [error] [MainThread]:   Database Error in model dim_product (models\marts\dim_product.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 8 unexpected 'ANY_VALUE'.
  syntax error line 16 at position 18 unexpected 'lead_time'.
  syntax error line 16 at position 29 unexpected 'AS'.
  compiled code at target\run\dbt_project\models\marts\dim_product.sql
[0m14:22:42.785090 [info ] [MainThread]: 
[0m14:22:42.785090 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\marts\dim_product.sql
[0m14:22:42.785090 [info ] [MainThread]: 
[0m14:22:42.785090 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=3
[0m14:22:42.785090 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m14:22:42.785090 [debug] [MainThread]: Command `dbt run` failed at 14:22:42.785090 after 6.09 seconds
[0m14:22:42.785090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230FA2E4A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002308C4125F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002308C4120B0>]}
[0m14:22:42.785090 [debug] [MainThread]: Flushing usage events
[0m14:22:44.097646 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:23:24.582750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D39260BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D3A32BD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D3A32BFA0>]}


============================== 14:23:24.582750 | 743eb0f1-04a9-491b-b95b-03dacc6d9771 ==============================
[0m14:23:24.582750 [info ] [MainThread]: Running with dbt=1.11.4
[0m14:23:24.595819 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jeeva\\.dbt', 'invocation_command': 'dbt run', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jeeva\\Desktop\\data_ai_assignment\\dbt_project\\logs'}
[0m14:23:25.485312 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m14:23:25.485312 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m14:23:25.485312 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m14:23:25.771693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '743eb0f1-04a9-491b-b95b-03dacc6d9771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D4AD4AD70>]}
[0m14:23:25.851432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '743eb0f1-04a9-491b-b95b-03dacc6d9771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D39C48D90>]}
[0m14:23:25.851432 [info ] [MainThread]: Registered adapter: snowflake=1.11.2
[0m14:23:26.394846 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m14:23:26.761023 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:23:26.776717 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models\marts\fct_product_snapshot.sql
[0m14:23:26.776717 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models\marts\dim_product.sql
[0m14:23:27.251504 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on
'fct_product_snapshot' in package 'dbt_project' (models\schema.yml). Arguments
to generic tests should be nested under the `arguments` property.
[0m14:23:27.253253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '743eb0f1-04a9-491b-b95b-03dacc6d9771', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D4B6F1C30>]}
[0m14:23:27.410974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '743eb0f1-04a9-491b-b95b-03dacc6d9771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D4C7F21D0>]}
[0m14:23:27.553307 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\manifest.json
[0m14:23:27.553307 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\semantic_manifest.json
[0m14:23:27.584775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '743eb0f1-04a9-491b-b95b-03dacc6d9771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D4B3A44F0>]}
[0m14:23:27.584775 [info ] [MainThread]: Found 3 models, 9 data tests, 1 source, 522 macros
[0m14:23:27.584775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '743eb0f1-04a9-491b-b95b-03dacc6d9771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D4B3A72B0>]}
[0m14:23:27.591506 [info ] [MainThread]: 
[0m14:23:27.591506 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:23:27.591506 [info ] [MainThread]: 
[0m14:23:27.591506 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:23:27.601769 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_INDUSTRIAL_PROCUREMENT_DB'
[0m14:23:27.839968 [debug] [ThreadPool]: Using snowflake connection "list_INDUSTRIAL_PROCUREMENT_DB"
[0m14:23:27.843973 [debug] [ThreadPool]: On list_INDUSTRIAL_PROCUREMENT_DB: show terse schemas in database INDUSTRIAL_PROCUREMENT_DB
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_INDUSTRIAL_PROCUREMENT_DB"} */
[0m14:23:27.843973 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:28.585732 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.749 seconds
[0m14:23:28.598424 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS'
[0m14:23:28.629969 [debug] [ThreadPool]: Using snowflake connection "list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS"
[0m14:23:28.629969 [debug] [ThreadPool]: On list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS: show objects in INDUSTRIAL_PROCUREMENT_DB.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS"} */;
[0m14:23:28.629969 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:29.032757 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.400 seconds
[0m14:23:29.032757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '743eb0f1-04a9-491b-b95b-03dacc6d9771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D3623AEF0>]}
[0m14:23:29.048883 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_product_catalog
[0m14:23:29.048883 [info ] [Thread-2 (]: 1 of 3 START sql view model ANALYTICS.stg_product_catalog ...................... [RUN]
[0m14:23:29.050305 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_project.stg_product_catalog'
[0m14:23:29.050305 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_product_catalog
[0m14:23:29.050305 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_product_catalog"
[0m14:23:29.050305 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_product_catalog
[0m14:23:29.096196 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_product_catalog"
[0m14:23:29.096196 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.stg_product_catalog"
[0m14:23:29.096196 [debug] [Thread-2 (]: On model.dbt_project.stg_product_catalog: create or replace   view INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog
  
  
  
  
  as (
    WITH base AS (

    SELECT
        ingestion_id,

        raw_product_json:title::string               AS product_name,
        REPLACE(raw_product_json:productBrand::string, 'By ', '') AS brand,
        COALESCE(
            raw_product_json:addToCart:action:params:sku::string,
            raw_product_json:sku::string
        ) AS sku,
        raw_product_json:inStock::boolean            AS in_stock,

        NULLIF(raw_product_json:rating:average::float, 0) AS avg_rating,
        raw_product_json:rating:totalReviews::int AS review_count,

        raw_product_json:pricing:prices[0]:value::number(10,2) AS selling_price,
        raw_product_json:pricing:prices[1]:value::number(10,2) AS tax_exclusive_price,

        scraped_at,
        page_url,
        category,
        COALESCE(
            raw_product_json:skuLeadTime::string,
            raw_product_json:oosAvailable::string
        ) AS lead_time


    FROM INDUSTRIAL_PROCUREMENT_DB.RAW.product_ingestion
    WHERE raw_product_json:addToCart:action:params:sku IS NOT NULL


),

country AS (

    SELECT
        r.ingestion_id,
        nv.value:value::string AS country_of_origin

    FROM INDUSTRIAL_PROCUREMENT_DB.RAW.product_ingestion r,
    LATERAL FLATTEN(input => r.raw_product_json:familyData:nonVariants) nv
    WHERE nv.value:name::string = 'Country of Origin'
)

SELECT
    b.*,
    c.country_of_origin
FROM base b
LEFT JOIN country c
ON b.ingestion_id = c.ingestion_id
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_product_catalog"} */;
[0m14:23:29.096196 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:23:29.631663 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.535 seconds
[0m14:23:29.660556 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '743eb0f1-04a9-491b-b95b-03dacc6d9771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D3A29CD30>]}
[0m14:23:29.660556 [info ] [Thread-2 (]: 1 of 3 OK created sql view model ANALYTICS.stg_product_catalog ................. [[32mSUCCESS 1[0m in 0.61s]
[0m14:23:29.660556 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_product_catalog
[0m14:23:29.660556 [debug] [Thread-2 (]: Began running node model.dbt_project.dim_product
[0m14:23:29.660556 [info ] [Thread-2 (]: 2 of 3 START sql view model ANALYTICS.dim_product .............................. [RUN]
[0m14:23:29.660556 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_product_catalog, now model.dbt_project.dim_product)
[0m14:23:29.660556 [debug] [Thread-2 (]: Began compiling node model.dbt_project.dim_product
[0m14:23:29.676247 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.dim_product"
[0m14:23:29.676247 [debug] [Thread-2 (]: Began executing node model.dbt_project.dim_product
[0m14:23:29.676247 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.dim_product"
[0m14:23:29.676247 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.dim_product"
[0m14:23:29.676247 [debug] [Thread-2 (]: On model.dbt_project.dim_product: create or replace   view INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.dim_product
  
  
  
  
  as (
    WITH deduplicated AS (

    SELECT
        sku,
        ANY_VALUE(product_name) AS product_name,
        ANY_VALUE(brand) AS brand,
        ANY_VALUE(category) AS category,
        ANY_VALUE(page_url) AS product_url,
        ANY_VALUE(country_of_origin) AS country_of_origin,
        ANY_VALUE(lead_time) AS lead_time

    FROM INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog
    WHERE sku IS NOT NULL
    GROUP BY sku

)

SELECT
    MD5(sku) AS product_id,
    *
FROM deduplicated
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_product"} */;
[0m14:23:29.904600 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.223 seconds
[0m14:23:29.904600 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '743eb0f1-04a9-491b-b95b-03dacc6d9771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D4CE6AF50>]}
[0m14:23:29.904600 [info ] [Thread-2 (]: 2 of 3 OK created sql view model ANALYTICS.dim_product ......................... [[32mSUCCESS 1[0m in 0.24s]
[0m14:23:29.917225 [debug] [Thread-2 (]: Finished running node model.dbt_project.dim_product
[0m14:23:29.917225 [debug] [Thread-2 (]: Began running node model.dbt_project.fct_product_snapshot
[0m14:23:29.917225 [info ] [Thread-2 (]: 3 of 3 START sql view model ANALYTICS.fct_product_snapshot ..................... [RUN]
[0m14:23:29.917225 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_product, now model.dbt_project.fct_product_snapshot)
[0m14:23:29.917225 [debug] [Thread-2 (]: Began compiling node model.dbt_project.fct_product_snapshot
[0m14:23:29.925801 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.fct_product_snapshot"
[0m14:23:29.925801 [debug] [Thread-2 (]: Began executing node model.dbt_project.fct_product_snapshot
[0m14:23:29.929813 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.fct_product_snapshot"
[0m14:23:29.931817 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.fct_product_snapshot"
[0m14:23:29.933323 [debug] [Thread-2 (]: On model.dbt_project.fct_product_snapshot: create or replace   view INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.fct_product_snapshot
  
  
  
  
  as (
    SELECT
    d.product_id,
    s.selling_price,
    s.tax_exclusive_price,
    s.avg_rating,
    s.review_count,
    s.in_stock,
    s.scraped_at
FROM INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog s
JOIN INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.dim_product d
    ON s.sku = d.sku
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_product_snapshot"} */;
[0m14:23:30.239541 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.319 seconds
[0m14:23:30.255611 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '743eb0f1-04a9-491b-b95b-03dacc6d9771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D4CE69D50>]}
[0m14:23:30.255611 [info ] [Thread-2 (]: 3 of 3 OK created sql view model ANALYTICS.fct_product_snapshot ................ [[32mSUCCESS 1[0m in 0.34s]
[0m14:23:30.255611 [debug] [Thread-2 (]: Finished running node model.dbt_project.fct_product_snapshot
[0m14:23:30.255611 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:23:30.255611 [debug] [MainThread]: Connection 'list_INDUSTRIAL_PROCUREMENT_DB' was left open.
[0m14:23:30.255611 [debug] [MainThread]: On list_INDUSTRIAL_PROCUREMENT_DB: Close
[0m14:23:30.384597 [debug] [MainThread]: Connection 'list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS' was left open.
[0m14:23:30.386610 [debug] [MainThread]: On list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS: Close
[0m14:23:30.513078 [debug] [MainThread]: Connection 'model.dbt_project.fct_product_snapshot' was left open.
[0m14:23:30.515755 [debug] [MainThread]: On model.dbt_project.fct_product_snapshot: Close
[0m14:23:30.625606 [info ] [MainThread]: 
[0m14:23:30.625606 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 3.03 seconds (3.03s).
[0m14:23:30.641322 [debug] [MainThread]: Command end result
[0m14:23:30.673101 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\manifest.json
[0m14:23:30.673101 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\semantic_manifest.json
[0m14:23:30.688829 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\run_results.json
[0m14:23:30.688829 [info ] [MainThread]: 
[0m14:23:30.688829 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:23:30.688829 [info ] [MainThread]: 
[0m14:23:30.688829 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m14:23:30.688829 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m14:23:30.688829 [debug] [MainThread]: Command `dbt run` succeeded at 14:23:30.688829 after 6.21 seconds
[0m14:23:30.688829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D39260BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D39C48D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D4B385750>]}
[0m14:23:30.688829 [debug] [MainThread]: Flushing usage events
[0m14:23:32.089049 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:29:42.178921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002025A64B850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002025B9D0A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002025B9D0850>]}


============================== 15:29:42.178921 | fcb4d62e-40d9-4315-9285-47c554cd533d ==============================
[0m15:29:42.178921 [info ] [MainThread]: Running with dbt=1.11.4
[0m15:29:42.178921 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jeeva\\.dbt', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jeeva\\Desktop\\data_ai_assignment\\dbt_project\\logs'}
[0m15:29:43.146303 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m15:29:43.146303 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m15:29:43.146303 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m15:29:43.509685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fcb4d62e-40d9-4315-9285-47c554cd533d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202585418A0>]}
[0m15:29:43.607204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fcb4d62e-40d9-4315-9285-47c554cd533d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002025B266800>]}
[0m15:29:43.607204 [info ] [MainThread]: Registered adapter: snowflake=1.11.2
[0m15:29:44.142015 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m15:29:44.515275 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:29:44.515275 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models\marts\fct_product_snapshot.sql
[0m15:29:44.517281 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models\marts\dim_product.sql
[0m15:29:44.963389 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on
'fct_product_snapshot' in package 'dbt_project' (models\schema.yml). Arguments
to generic tests should be nested under the `arguments` property.
[0m15:29:44.969730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fcb4d62e-40d9-4315-9285-47c554cd533d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002026E26A650>]}
[0m15:29:45.121765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fcb4d62e-40d9-4315-9285-47c554cd533d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002026E3BC130>]}
[0m15:29:45.267380 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\manifest.json
[0m15:29:45.271666 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\semantic_manifest.json
[0m15:29:45.295501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fcb4d62e-40d9-4315-9285-47c554cd533d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002026DF250F0>]}
[0m15:29:45.295501 [info ] [MainThread]: Found 3 models, 9 data tests, 1 source, 522 macros
[0m15:29:45.295501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcb4d62e-40d9-4315-9285-47c554cd533d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002026DF4B910>]}
[0m15:29:45.295501 [info ] [MainThread]: 
[0m15:29:45.295501 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:29:45.311598 [info ] [MainThread]: 
[0m15:29:45.311598 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:29:45.311598 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_INDUSTRIAL_PROCUREMENT_DB'
[0m15:29:45.562413 [debug] [ThreadPool]: Using snowflake connection "list_INDUSTRIAL_PROCUREMENT_DB"
[0m15:29:45.562413 [debug] [ThreadPool]: On list_INDUSTRIAL_PROCUREMENT_DB: show terse schemas in database INDUSTRIAL_PROCUREMENT_DB
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_INDUSTRIAL_PROCUREMENT_DB"} */
[0m15:29:45.562413 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:46.432724 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.883 seconds
[0m15:29:46.448455 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS'
[0m15:29:46.465923 [debug] [ThreadPool]: Using snowflake connection "list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS"
[0m15:29:46.465923 [debug] [ThreadPool]: On list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS: show objects in INDUSTRIAL_PROCUREMENT_DB.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS"} */;
[0m15:29:46.467927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:46.873395 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.408 seconds
[0m15:29:46.873395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcb4d62e-40d9-4315-9285-47c554cd533d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202584A2FB0>]}
[0m15:29:46.883554 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_product_catalog
[0m15:29:46.883554 [info ] [Thread-2 (]: 1 of 3 START sql view model ANALYTICS.stg_product_catalog ...................... [RUN]
[0m15:29:46.883554 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_project.stg_product_catalog'
[0m15:29:46.883554 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_product_catalog
[0m15:29:46.899389 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_product_catalog"
[0m15:29:46.899389 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_product_catalog
[0m15:29:46.931013 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_product_catalog"
[0m15:29:46.931013 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.stg_product_catalog"
[0m15:29:46.931013 [debug] [Thread-2 (]: On model.dbt_project.stg_product_catalog: create or replace   view INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog
  
  
  
  
  as (
    WITH base AS (

    SELECT
        ingestion_id,

        raw_product_json:title::string               AS product_name,
        REPLACE(raw_product_json:productBrand::string, 'By ', '') AS brand,
        COALESCE(
            raw_product_json:addToCart:action:params:sku::string,
            raw_product_json:sku::string
        ) AS sku,
        raw_product_json:inStock::boolean            AS in_stock,

        NULLIF(raw_product_json:rating:average::float, 0) AS avg_rating,
        raw_product_json:rating:totalReviews::int AS review_count,

        raw_product_json:pricing:prices[0]:value::number(10,2) AS selling_price,
        raw_product_json:pricing:prices[1]:value::number(10,2) AS tax_exclusive_price,

        scraped_at,
        page_url,
        category,
        COALESCE(
            raw_product_json:skuLeadTime::string,
            raw_product_json:oosAvailable::string
        ) AS lead_time


    FROM INDUSTRIAL_PROCUREMENT_DB.RAW.product_ingestion
    WHERE raw_product_json:addToCart:action:params:sku IS NOT NULL


),

country AS (

    SELECT
        r.ingestion_id,
        nv.value:value::string AS country_of_origin

    FROM INDUSTRIAL_PROCUREMENT_DB.RAW.product_ingestion r,
    LATERAL FLATTEN(input => r.raw_product_json:familyData:nonVariants) nv
    WHERE nv.value:name::string = 'Country of Origin'
)

SELECT
    b.*,
    c.country_of_origin
FROM base b
LEFT JOIN country c
ON b.ingestion_id = c.ingestion_id
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_product_catalog"} */;
[0m15:29:46.931013 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:29:47.459872 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.521 seconds
[0m15:29:47.483045 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcb4d62e-40d9-4315-9285-47c554cd533d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002025953F880>]}
[0m15:29:47.483045 [info ] [Thread-2 (]: 1 of 3 OK created sql view model ANALYTICS.stg_product_catalog ................. [[32mSUCCESS 1[0m in 0.60s]
[0m15:29:47.483045 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_product_catalog
[0m15:29:47.496526 [debug] [Thread-2 (]: Began running node model.dbt_project.dim_product
[0m15:29:47.496526 [info ] [Thread-2 (]: 2 of 3 START sql view model ANALYTICS.dim_product .............................. [RUN]
[0m15:29:47.496526 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_product_catalog, now model.dbt_project.dim_product)
[0m15:29:47.496526 [debug] [Thread-2 (]: Began compiling node model.dbt_project.dim_product
[0m15:29:47.496526 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.dim_product"
[0m15:29:47.496526 [debug] [Thread-2 (]: Began executing node model.dbt_project.dim_product
[0m15:29:47.496526 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.dim_product"
[0m15:29:47.512603 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.dim_product"
[0m15:29:47.512603 [debug] [Thread-2 (]: On model.dbt_project.dim_product: create or replace   view INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.dim_product
  
  
  
  
  as (
    WITH deduplicated AS (

    SELECT
        sku,
        ANY_VALUE(product_name) AS product_name,
        ANY_VALUE(brand) AS brand,
        ANY_VALUE(category) AS category,
        ANY_VALUE(page_url) AS product_url,
        ANY_VALUE(country_of_origin) AS country_of_origin,
        ANY_VALUE(lead_time) AS lead_time,
        ANY_VALUE(avg_rating) AS avg_rating

    FROM INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog
    WHERE sku IS NOT NULL
    GROUP BY sku

)

SELECT
    MD5(sku) AS product_id,
    *
FROM deduplicated
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_product"} */;
[0m15:29:47.770415 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.260 seconds
[0m15:29:47.770415 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcb4d62e-40d9-4315-9285-47c554cd533d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002026EB7D5D0>]}
[0m15:29:47.770415 [info ] [Thread-2 (]: 2 of 3 OK created sql view model ANALYTICS.dim_product ......................... [[32mSUCCESS 1[0m in 0.27s]
[0m15:29:47.770415 [debug] [Thread-2 (]: Finished running node model.dbt_project.dim_product
[0m15:29:47.770415 [debug] [Thread-2 (]: Began running node model.dbt_project.fct_product_snapshot
[0m15:29:47.770415 [info ] [Thread-2 (]: 3 of 3 START sql view model ANALYTICS.fct_product_snapshot ..................... [RUN]
[0m15:29:47.770415 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_product, now model.dbt_project.fct_product_snapshot)
[0m15:29:47.770415 [debug] [Thread-2 (]: Began compiling node model.dbt_project.fct_product_snapshot
[0m15:29:47.786089 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.fct_product_snapshot"
[0m15:29:47.786089 [debug] [Thread-2 (]: Began executing node model.dbt_project.fct_product_snapshot
[0m15:29:47.786089 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.fct_product_snapshot"
[0m15:29:47.786089 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.fct_product_snapshot"
[0m15:29:47.786089 [debug] [Thread-2 (]: On model.dbt_project.fct_product_snapshot: create or replace   view INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.fct_product_snapshot
  
  
  
  
  as (
    SELECT
    d.product_id,
    s.selling_price,
    s.tax_exclusive_price,
    s.avg_rating,
    s.review_count,
    s.in_stock,
    s.scraped_at
FROM INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog s
JOIN INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.dim_product d
    ON s.sku = d.sku
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_product_snapshot"} */;
[0m15:29:48.107913 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.313 seconds
[0m15:29:48.107913 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcb4d62e-40d9-4315-9285-47c554cd533d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002026EB7D5D0>]}
[0m15:29:48.107913 [info ] [Thread-2 (]: 3 of 3 OK created sql view model ANALYTICS.fct_product_snapshot ................ [[32mSUCCESS 1[0m in 0.34s]
[0m15:29:48.107913 [debug] [Thread-2 (]: Finished running node model.dbt_project.fct_product_snapshot
[0m15:29:48.107913 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:29:48.107913 [debug] [MainThread]: Connection 'list_INDUSTRIAL_PROCUREMENT_DB' was left open.
[0m15:29:48.107913 [debug] [MainThread]: On list_INDUSTRIAL_PROCUREMENT_DB: Close
[0m15:29:48.236686 [debug] [MainThread]: Connection 'list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS' was left open.
[0m15:29:48.236686 [debug] [MainThread]: On list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS: Close
[0m15:29:48.355628 [debug] [MainThread]: Connection 'model.dbt_project.fct_product_snapshot' was left open.
[0m15:29:48.355628 [debug] [MainThread]: On model.dbt_project.fct_product_snapshot: Close
[0m15:29:48.495501 [info ] [MainThread]: 
[0m15:29:48.508950 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 3.18 seconds (3.18s).
[0m15:29:48.511381 [debug] [MainThread]: Command end result
[0m15:29:48.559039 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\manifest.json
[0m15:29:48.574698 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\semantic_manifest.json
[0m15:29:48.574698 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\run_results.json
[0m15:29:48.574698 [info ] [MainThread]: 
[0m15:29:48.574698 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:29:48.574698 [info ] [MainThread]: 
[0m15:29:48.574698 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m15:29:48.574698 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:29:48.574698 [debug] [MainThread]: Command `dbt run` succeeded at 15:29:48.574698 after 6.55 seconds
[0m15:29:48.590345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002025A64B850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202585418A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002026DF0E6E0>]}
[0m15:29:48.590345 [debug] [MainThread]: Flushing usage events
[0m15:29:49.889114 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:32:27.739679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD30B8C610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD31C4FCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD31C4FAF0>]}


============================== 15:32:27.739679 | 0152b528-224b-4d52-bc9f-a4543e818c4b ==============================
[0m15:32:27.739679 [info ] [MainThread]: Running with dbt=1.11.4
[0m15:32:27.755566 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jeeva\\.dbt', 'invocation_command': 'dbt run', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jeeva\\Desktop\\data_ai_assignment\\dbt_project\\logs'}
[0m15:32:28.722104 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m15:32:28.722104 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m15:32:28.722104 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m15:32:29.085821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0152b528-224b-4d52-bc9f-a4543e818c4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD2E514A60>]}
[0m15:32:29.180656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0152b528-224b-4d52-bc9f-a4543e818c4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD42B34370>]}
[0m15:32:29.182432 [info ] [MainThread]: Registered adapter: snowflake=1.11.2
[0m15:32:29.725343 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m15:32:30.012114 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:32:30.014119 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models\marts\fct_product_snapshot.sql
[0m15:32:30.014119 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models\marts\dim_product.sql
[0m15:32:30.449673 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on
'fct_product_snapshot' in package 'dbt_project' (models\schema.yml). Arguments
to generic tests should be nested under the `arguments` property.
[0m15:32:30.449673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0152b528-224b-4d52-bc9f-a4543e818c4b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD44214B80>]}
[0m15:32:30.687741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0152b528-224b-4d52-bc9f-a4543e818c4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD44623FA0>]}
[0m15:32:30.829586 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\manifest.json
[0m15:32:30.845370 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\semantic_manifest.json
[0m15:32:30.879431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0152b528-224b-4d52-bc9f-a4543e818c4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD44647D60>]}
[0m15:32:30.879431 [info ] [MainThread]: Found 3 models, 9 data tests, 1 source, 522 macros
[0m15:32:30.879431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0152b528-224b-4d52-bc9f-a4543e818c4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD441B40D0>]}
[0m15:32:30.879431 [info ] [MainThread]: 
[0m15:32:30.879431 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:32:30.879431 [info ] [MainThread]: 
[0m15:32:30.879431 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:32:30.893176 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_INDUSTRIAL_PROCUREMENT_DB'
[0m15:32:31.130874 [debug] [ThreadPool]: Using snowflake connection "list_INDUSTRIAL_PROCUREMENT_DB"
[0m15:32:31.130874 [debug] [ThreadPool]: On list_INDUSTRIAL_PROCUREMENT_DB: show terse schemas in database INDUSTRIAL_PROCUREMENT_DB
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_INDUSTRIAL_PROCUREMENT_DB"} */
[0m15:32:31.130874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:33.448456 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 62.312 seconds
[0m15:33:33.452913 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:33:33.452913 [debug] [MainThread]: Connection 'list_INDUSTRIAL_PROCUREMENT_DB' was left open.
[0m15:33:33.452913 [debug] [MainThread]: On list_INDUSTRIAL_PROCUREMENT_DB: Close
[0m15:33:33.581322 [info ] [MainThread]: 
[0m15:33:33.581322 [info ] [MainThread]: Finished running  in 0 hours 1 minutes and 2.70 seconds (62.70s).
[0m15:33:33.596079 [error] [MainThread]: Encountered an error:

[0m15:33:33.598109 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\jeeva\miniconda3\envs\data_ai_assessment\lib\site-packages\dbt\cli\requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\jeeva\miniconda3\envs\data_ai_assessment\lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\jeeva\miniconda3\envs\data_ai_assessment\lib\site-packages\dbt\cli\requires.py", line 276, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\jeeva\miniconda3\envs\data_ai_assessment\lib\site-packages\dbt\cli\requires.py", line 321, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\jeeva\miniconda3\envs\data_ai_assessment\lib\site-packages\dbt\cli\requires.py", line 391, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\jeeva\miniconda3\envs\data_ai_assessment\lib\site-packages\dbt\cli\requires.py", line 368, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\jeeva\miniconda3\envs\data_ai_assessment\lib\site-packages\dbt\cli\requires.py", line 408, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\jeeva\miniconda3\envs\data_ai_assessment\lib\site-packages\dbt\cli\main.py", line 587, in run
    results = task.run()
  File "C:\Users\jeeva\miniconda3\envs\data_ai_assessment\lib\site-packages\dbt\task\runnable.py", line 626, in run
    result = self.execute_with_hooks(selected_uids)
  File "C:\Users\jeeva\miniconda3\envs\data_ai_assessment\lib\site-packages\dbt\task\runnable.py", line 559, in execute_with_hooks
    before_run_status = self.before_run(adapter, selected_uids)
  File "C:\Users\jeeva\miniconda3\envs\data_ai_assessment\lib\site-packages\dbt\task\run.py", line 1117, in before_run
    self.create_schemas(adapter, required_schemas)
  File "C:\Users\jeeva\miniconda3\envs\data_ai_assessment\lib\site-packages\dbt\task\runnable.py", line 733, in create_schemas
    for ls_future in as_completed(list_futures):
  File "C:\Users\jeeva\miniconda3\envs\data_ai_assessment\lib\concurrent\futures\_base.py", line 245, in as_completed
    waiter.event.wait(wait_timeout)
  File "C:\Users\jeeva\miniconda3\envs\data_ai_assessment\lib\threading.py", line 607, in wait
    signaled = self._cond.wait(timeout)
  File "C:\Users\jeeva\miniconda3\envs\data_ai_assessment\lib\threading.py", line 320, in wait
    waiter.acquire()
KeyboardInterrupt

[0m15:33:33.598109 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:33:33.598109 [debug] [MainThread]: Command `dbt run` failed at 15:33:33.598109 after 65.96 seconds
[0m15:33:33.598109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD30B8C610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD44647970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD446A0FD0>]}
[0m15:33:33.609241 [debug] [MainThread]: Flushing usage events
[0m15:33:34.930277 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:33:44.437103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B93E5C3E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B93F960FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B93F960DF0>]}


============================== 15:33:44.437103 | 1cb65ed6-d47d-4b02-a58a-f69d089938c4 ==============================
[0m15:33:44.437103 [info ] [MainThread]: Running with dbt=1.11.4
[0m15:33:44.437103 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jeeva\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jeeva\\Desktop\\data_ai_assignment\\dbt_project\\logs'}
[0m15:33:45.404217 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m15:33:45.404217 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m15:33:45.404217 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m15:33:45.782837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1cb65ed6-d47d-4b02-a58a-f69d089938c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9509D9870>]}
[0m15:33:45.863112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1cb65ed6-d47d-4b02-a58a-f69d089938c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B93F224310>]}
[0m15:33:45.863112 [info ] [MainThread]: Registered adapter: snowflake=1.11.2
[0m15:33:46.387738 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m15:33:46.690600 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:33:46.690600 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:33:46.690600 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:33:46.769504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1cb65ed6-d47d-4b02-a58a-f69d089938c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B951F34B80>]}
[0m15:33:46.917535 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\manifest.json
[0m15:33:46.919541 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\semantic_manifest.json
[0m15:33:46.941568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1cb65ed6-d47d-4b02-a58a-f69d089938c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B951F177C0>]}
[0m15:33:46.941568 [info ] [MainThread]: Found 3 models, 9 data tests, 1 source, 522 macros
[0m15:33:46.941568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cb65ed6-d47d-4b02-a58a-f69d089938c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B951E9E140>]}
[0m15:33:46.941568 [info ] [MainThread]: 
[0m15:33:46.941568 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:33:46.957214 [info ] [MainThread]: 
[0m15:33:46.957214 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:33:46.957214 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_INDUSTRIAL_PROCUREMENT_DB'
[0m15:33:47.198123 [debug] [ThreadPool]: Using snowflake connection "list_INDUSTRIAL_PROCUREMENT_DB"
[0m15:33:47.199886 [debug] [ThreadPool]: On list_INDUSTRIAL_PROCUREMENT_DB: show terse schemas in database INDUSTRIAL_PROCUREMENT_DB
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_INDUSTRIAL_PROCUREMENT_DB"} */
[0m15:33:47.199886 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:48.060019 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.860 seconds
[0m15:33:48.064040 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS'
[0m15:33:48.075729 [debug] [ThreadPool]: Using snowflake connection "list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS"
[0m15:33:48.091807 [debug] [ThreadPool]: On list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS: show objects in INDUSTRIAL_PROCUREMENT_DB.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS"} */;
[0m15:33:48.091807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:48.754613 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.664 seconds
[0m15:33:48.774145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cb65ed6-d47d-4b02-a58a-f69d089938c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B93B8759C0>]}
[0m15:33:48.777160 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_product_catalog
[0m15:33:48.777160 [info ] [Thread-2 (]: 1 of 3 START sql view model ANALYTICS.stg_product_catalog ...................... [RUN]
[0m15:33:48.777160 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_project.stg_product_catalog'
[0m15:33:48.777160 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_product_catalog
[0m15:33:48.786492 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_product_catalog"
[0m15:33:48.786492 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_product_catalog
[0m15:33:48.818209 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_product_catalog"
[0m15:33:48.818209 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.stg_product_catalog"
[0m15:33:48.818209 [debug] [Thread-2 (]: On model.dbt_project.stg_product_catalog: create or replace   view INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog
  
  
  
  
  as (
    WITH base AS (

    SELECT
        ingestion_id,

        raw_product_json:title::string               AS product_name,
        REPLACE(raw_product_json:productBrand::string, 'By ', '') AS brand,
        COALESCE(
            raw_product_json:addToCart:action:params:sku::string,
            raw_product_json:sku::string
        ) AS sku,
        raw_product_json:inStock::boolean            AS in_stock,

        NULLIF(raw_product_json:rating:average::float, 0) AS avg_rating,
        raw_product_json:rating:totalReviews::int AS review_count,

        raw_product_json:pricing:prices[0]:value::number(10,2) AS selling_price,
        raw_product_json:pricing:prices[1]:value::number(10,2) AS tax_exclusive_price,

        scraped_at,
        page_url,
        category,
        COALESCE(
            raw_product_json:skuLeadTime::string,
            raw_product_json:oosAvailable::string
        ) AS lead_time


    FROM INDUSTRIAL_PROCUREMENT_DB.RAW.product_ingestion
    WHERE raw_product_json:addToCart:action:params:sku IS NOT NULL


),

country AS (

    SELECT
        r.ingestion_id,
        nv.value:value::string AS country_of_origin

    FROM INDUSTRIAL_PROCUREMENT_DB.RAW.product_ingestion r,
    LATERAL FLATTEN(input => r.raw_product_json:familyData:nonVariants) nv
    WHERE nv.value:name::string = 'Country of Origin'
)

SELECT
    b.*,
    c.country_of_origin
FROM base b
LEFT JOIN country c
ON b.ingestion_id = c.ingestion_id
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_product_catalog"} */;
[0m15:33:48.818209 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:33:49.381557 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.562 seconds
[0m15:33:49.413527 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb65ed6-d47d-4b02-a58a-f69d089938c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B93F962D70>]}
[0m15:33:49.413527 [info ] [Thread-2 (]: 1 of 3 OK created sql view model ANALYTICS.stg_product_catalog ................. [[32mSUCCESS 1[0m in 0.64s]
[0m15:33:49.413527 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_product_catalog
[0m15:33:49.413527 [debug] [Thread-2 (]: Began running node model.dbt_project.dim_product
[0m15:33:49.413527 [info ] [Thread-2 (]: 2 of 3 START sql view model ANALYTICS.dim_product .............................. [RUN]
[0m15:33:49.429512 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_product_catalog, now model.dbt_project.dim_product)
[0m15:33:49.429512 [debug] [Thread-2 (]: Began compiling node model.dbt_project.dim_product
[0m15:33:49.429512 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.dim_product"
[0m15:33:49.429512 [debug] [Thread-2 (]: Began executing node model.dbt_project.dim_product
[0m15:33:49.429512 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.dim_product"
[0m15:33:49.429512 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.dim_product"
[0m15:33:49.429512 [debug] [Thread-2 (]: On model.dbt_project.dim_product: create or replace   view INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.dim_product
  
  
  
  
  as (
    WITH deduplicated AS (

    SELECT
        sku,
        ANY_VALUE(product_name) AS product_name,
        ANY_VALUE(brand) AS brand,
        ANY_VALUE(category) AS category,
        ANY_VALUE(page_url) AS product_url,
        ANY_VALUE(country_of_origin) AS country_of_origin,
        ANY_VALUE(lead_time) AS lead_time,
        ANY_VALUE(avg_rating) AS avg_rating,
        ANY_VALUE(review_count) AS review_count

    FROM INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog
    WHERE sku IS NOT NULL
    GROUP BY sku

)

SELECT
    MD5(sku) AS product_id,
    *
FROM deduplicated
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_product"} */;
[0m15:33:49.671912 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.241 seconds
[0m15:33:49.687792 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb65ed6-d47d-4b02-a58a-f69d089938c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B952768220>]}
[0m15:33:49.687792 [info ] [Thread-2 (]: 2 of 3 OK created sql view model ANALYTICS.dim_product ......................... [[32mSUCCESS 1[0m in 0.26s]
[0m15:33:49.687792 [debug] [Thread-2 (]: Finished running node model.dbt_project.dim_product
[0m15:33:49.687792 [debug] [Thread-2 (]: Began running node model.dbt_project.fct_product_snapshot
[0m15:33:49.687792 [info ] [Thread-2 (]: 3 of 3 START sql view model ANALYTICS.fct_product_snapshot ..................... [RUN]
[0m15:33:49.687792 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_product, now model.dbt_project.fct_product_snapshot)
[0m15:33:49.687792 [debug] [Thread-2 (]: Began compiling node model.dbt_project.fct_product_snapshot
[0m15:33:49.698560 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.fct_product_snapshot"
[0m15:33:49.700568 [debug] [Thread-2 (]: Began executing node model.dbt_project.fct_product_snapshot
[0m15:33:49.705586 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.fct_product_snapshot"
[0m15:33:49.707591 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.fct_product_snapshot"
[0m15:33:49.707591 [debug] [Thread-2 (]: On model.dbt_project.fct_product_snapshot: create or replace   view INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.fct_product_snapshot
  
  
  
  
  as (
    SELECT
    d.product_id,
    s.selling_price,
    s.tax_exclusive_price,
    s.avg_rating,
    s.review_count,
    s.in_stock,
    s.scraped_at
FROM INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog s
JOIN INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.dim_product d
    ON s.sku = d.sku
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_product_snapshot"} */;
[0m15:33:50.553865 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.859 seconds
[0m15:33:50.569824 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cb65ed6-d47d-4b02-a58a-f69d089938c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B950A59810>]}
[0m15:33:50.569824 [info ] [Thread-2 (]: 3 of 3 OK created sql view model ANALYTICS.fct_product_snapshot ................ [[32mSUCCESS 1[0m in 0.88s]
[0m15:33:50.569824 [debug] [Thread-2 (]: Finished running node model.dbt_project.fct_product_snapshot
[0m15:33:50.569824 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:33:50.569824 [debug] [MainThread]: Connection 'list_INDUSTRIAL_PROCUREMENT_DB' was left open.
[0m15:33:50.569824 [debug] [MainThread]: On list_INDUSTRIAL_PROCUREMENT_DB: Close
[0m15:33:50.698610 [debug] [MainThread]: Connection 'list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS' was left open.
[0m15:33:50.698610 [debug] [MainThread]: On list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS: Close
[0m15:33:50.813763 [debug] [MainThread]: Connection 'model.dbt_project.fct_product_snapshot' was left open.
[0m15:33:50.813763 [debug] [MainThread]: On model.dbt_project.fct_product_snapshot: Close
[0m15:33:50.949278 [info ] [MainThread]: 
[0m15:33:50.949278 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 3.99 seconds (3.99s).
[0m15:33:50.951287 [debug] [MainThread]: Command end result
[0m15:33:50.987192 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\manifest.json
[0m15:33:50.991207 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\semantic_manifest.json
[0m15:33:51.000985 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\run_results.json
[0m15:33:51.000985 [info ] [MainThread]: 
[0m15:33:51.002993 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:33:51.002993 [info ] [MainThread]: 
[0m15:33:51.005002 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m15:33:51.005002 [debug] [MainThread]: Command `dbt run` succeeded at 15:33:51.005002 after 6.67 seconds
[0m15:33:51.007010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B93E5C3E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9509D9870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B951E9E140>]}
[0m15:33:51.007010 [debug] [MainThread]: Flushing usage events
[0m15:33:52.293802 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:57:03.520476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221AD9D4FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221AE87F790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221AE87FAF0>]}


============================== 15:57:03.520476 | 5200abc0-a1c8-415e-b861-4aef1a28934e ==============================
[0m15:57:03.520476 [info ] [MainThread]: Running with dbt=1.11.4
[0m15:57:03.520476 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\jeeva\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jeeva\\Desktop\\data_ai_assignment\\dbt_project\\logs'}
[0m15:57:04.486859 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m15:57:04.486859 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m15:57:04.486859 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m15:57:04.852362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5200abc0-a1c8-415e-b861-4aef1a28934e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221BF987430>]}
[0m15:57:04.948275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5200abc0-a1c8-415e-b861-4aef1a28934e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221AE87FC40>]}
[0m15:57:04.950303 [info ] [MainThread]: Registered adapter: snowflake=1.11.2
[0m15:57:05.479371 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m15:57:05.763082 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:57:05.763082 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:57:05.765088 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:57:05.843995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5200abc0-a1c8-415e-b861-4aef1a28934e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C1065C60>]}
[0m15:57:05.992041 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\manifest.json
[0m15:57:05.992041 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\semantic_manifest.json
[0m15:57:06.024100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5200abc0-a1c8-415e-b861-4aef1a28934e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C1045960>]}
[0m15:57:06.024100 [info ] [MainThread]: Found 3 models, 9 data tests, 1 source, 522 macros
[0m15:57:06.024100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5200abc0-a1c8-415e-b861-4aef1a28934e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C1004F40>]}
[0m15:57:06.027216 [info ] [MainThread]: 
[0m15:57:06.027216 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:57:06.029358 [info ] [MainThread]: 
[0m15:57:06.030083 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:57:06.030083 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_INDUSTRIAL_PROCUREMENT_DB'
[0m15:57:06.274302 [debug] [ThreadPool]: Using snowflake connection "list_INDUSTRIAL_PROCUREMENT_DB"
[0m15:57:06.277924 [debug] [ThreadPool]: On list_INDUSTRIAL_PROCUREMENT_DB: show terse schemas in database INDUSTRIAL_PROCUREMENT_DB
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_INDUSTRIAL_PROCUREMENT_DB"} */
[0m15:57:06.277924 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:07.083527 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.811 seconds
[0m15:57:07.083527 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS'
[0m15:57:07.099216 [debug] [ThreadPool]: Using snowflake connection "list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS"
[0m15:57:07.099216 [debug] [ThreadPool]: On list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS: show objects in INDUSTRIAL_PROCUREMENT_DB.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS"} */;
[0m15:57:07.099216 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:07.807417 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.708 seconds
[0m15:57:07.822503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5200abc0-a1c8-415e-b861-4aef1a28934e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221AEA41360>]}
[0m15:57:07.822503 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_product_catalog
[0m15:57:07.822503 [info ] [Thread-2 (]: 1 of 3 START sql view model ANALYTICS.stg_product_catalog ...................... [RUN]
[0m15:57:07.822503 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_project.stg_product_catalog'
[0m15:57:07.822503 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_product_catalog
[0m15:57:07.838378 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_product_catalog"
[0m15:57:07.838378 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_product_catalog
[0m15:57:07.869902 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_product_catalog"
[0m15:57:07.869902 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.stg_product_catalog"
[0m15:57:07.869902 [debug] [Thread-2 (]: On model.dbt_project.stg_product_catalog: create or replace   view INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog
  
  
  
  
  as (
    WITH base AS (

    SELECT
        ingestion_id,

        raw_product_json:title::string               AS product_name,
        REPLACE(raw_product_json:productBrand::string, 'By ', '') AS brand,
        COALESCE(
            raw_product_json:addToCart:action:params:sku::string,
            raw_product_json:sku::string
        ) AS sku,
        raw_product_json:inStock::boolean            AS in_stock,

        NULLIF(raw_product_json:rating:average::float, 0) AS avg_rating,
        raw_product_json:rating:totalReviews::int AS review_count,

        raw_product_json:pricing:prices[0]:value::number(10,2) AS selling_price,
        raw_product_json:pricing:prices[1]:value::number(10,2) AS tax_exclusive_price,

        scraped_at,
        page_url,
        category,
        COALESCE(
            raw_product_json:skuLeadTime::string,
            raw_product_json:oosAvailable::string
        ) AS lead_time


    FROM INDUSTRIAL_PROCUREMENT_DB.RAW.product_ingestion
    WHERE raw_product_json:addToCart:action:params:sku IS NOT NULL


),

country AS (

    SELECT
        r.ingestion_id,
        nv.value:value::string AS country_of_origin

    FROM INDUSTRIAL_PROCUREMENT_DB.RAW.product_ingestion r,
    LATERAL FLATTEN(input => r.raw_product_json:familyData:nonVariants) nv
    WHERE nv.value:name::string = 'Country of Origin'
)

SELECT
    b.*,
    c.country_of_origin
FROM base b
LEFT JOIN country c
ON b.ingestion_id = c.ingestion_id
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_product_catalog"} */;
[0m15:57:07.869902 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:57:08.448783 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.568 seconds
[0m15:57:08.480462 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5200abc0-a1c8-415e-b861-4aef1a28934e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C171DE40>]}
[0m15:57:08.480462 [info ] [Thread-2 (]: 1 of 3 OK created sql view model ANALYTICS.stg_product_catalog ................. [[32mSUCCESS 1[0m in 0.64s]
[0m15:57:08.480462 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_product_catalog
[0m15:57:08.480462 [debug] [Thread-2 (]: Began running node model.dbt_project.dim_product
[0m15:57:08.480462 [info ] [Thread-2 (]: 2 of 3 START sql view model ANALYTICS.dim_product .............................. [RUN]
[0m15:57:08.480462 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_product_catalog, now model.dbt_project.dim_product)
[0m15:57:08.480462 [debug] [Thread-2 (]: Began compiling node model.dbt_project.dim_product
[0m15:57:08.491757 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.dim_product"
[0m15:57:08.493762 [debug] [Thread-2 (]: Began executing node model.dbt_project.dim_product
[0m15:57:08.499952 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.dim_product"
[0m15:57:08.501958 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.dim_product"
[0m15:57:08.501958 [debug] [Thread-2 (]: On model.dbt_project.dim_product: create or replace   view INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.dim_product
  
  
  
  
  as (
    WITH deduplicated AS (

    SELECT
        sku,
        ANY_VALUE(product_name) AS product_name,
        ANY_VALUE(brand) AS brand,
        ANY_VALUE(category) AS category,
        ANY_VALUE(page_url) AS product_url,
        ANY_VALUE(country_of_origin) AS country_of_origin,
        ANY_VALUE(lead_time) AS lead_time,
        ANY_VALUE(avg_rating) AS avg_rating,
        ANY_VALUE(review_count) AS review_count

    FROM INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog
    WHERE sku IS NOT NULL
    GROUP BY sku

)

SELECT
    MD5(sku) AS product_id,
    *
FROM deduplicated
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_product"} */;
[0m15:57:08.736825 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.243 seconds
[0m15:57:08.736825 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5200abc0-a1c8-415e-b861-4aef1a28934e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221AC623E50>]}
[0m15:57:08.736825 [info ] [Thread-2 (]: 2 of 3 OK created sql view model ANALYTICS.dim_product ......................... [[32mSUCCESS 1[0m in 0.26s]
[0m15:57:08.752889 [debug] [Thread-2 (]: Finished running node model.dbt_project.dim_product
[0m15:57:08.752889 [debug] [Thread-2 (]: Began running node model.dbt_project.fct_product_snapshot
[0m15:57:08.752889 [info ] [Thread-2 (]: 3 of 3 START sql view model ANALYTICS.fct_product_snapshot ..................... [RUN]
[0m15:57:08.752889 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_product, now model.dbt_project.fct_product_snapshot)
[0m15:57:08.752889 [debug] [Thread-2 (]: Began compiling node model.dbt_project.fct_product_snapshot
[0m15:57:08.752889 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.fct_product_snapshot"
[0m15:57:08.752889 [debug] [Thread-2 (]: Began executing node model.dbt_project.fct_product_snapshot
[0m15:57:08.752889 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.fct_product_snapshot"
[0m15:57:08.752889 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.fct_product_snapshot"
[0m15:57:08.768645 [debug] [Thread-2 (]: On model.dbt_project.fct_product_snapshot: create or replace   view INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.fct_product_snapshot
  
  
  
  
  as (
    SELECT
    d.product_id,
    s.selling_price,
    s.tax_exclusive_price,
    s.avg_rating,
    s.review_count,
    s.in_stock,
    s.scraped_at
FROM INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog s
JOIN INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.dim_product d
    ON s.sku = d.sku
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_product_snapshot"} */;
[0m15:57:09.103369 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.333 seconds
[0m15:57:09.108600 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5200abc0-a1c8-415e-b861-4aef1a28934e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C18529B0>]}
[0m15:57:09.108600 [info ] [Thread-2 (]: 3 of 3 OK created sql view model ANALYTICS.fct_product_snapshot ................ [[32mSUCCESS 1[0m in 0.36s]
[0m15:57:09.108600 [debug] [Thread-2 (]: Finished running node model.dbt_project.fct_product_snapshot
[0m15:57:09.124314 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:57:09.124314 [debug] [MainThread]: Connection 'list_INDUSTRIAL_PROCUREMENT_DB' was left open.
[0m15:57:09.124314 [debug] [MainThread]: On list_INDUSTRIAL_PROCUREMENT_DB: Close
[0m15:57:09.252983 [debug] [MainThread]: Connection 'list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS' was left open.
[0m15:57:09.252983 [debug] [MainThread]: On list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS: Close
[0m15:57:09.368141 [debug] [MainThread]: Connection 'model.dbt_project.fct_product_snapshot' was left open.
[0m15:57:09.368141 [debug] [MainThread]: On model.dbt_project.fct_product_snapshot: Close
[0m15:57:09.492880 [info ] [MainThread]: 
[0m15:57:09.492880 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 3.46 seconds (3.46s).
[0m15:57:09.492880 [debug] [MainThread]: Command end result
[0m15:57:09.524897 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\manifest.json
[0m15:57:09.524897 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\semantic_manifest.json
[0m15:57:09.540828 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\run_results.json
[0m15:57:09.540828 [info ] [MainThread]: 
[0m15:57:09.540828 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:57:09.540828 [info ] [MainThread]: 
[0m15:57:09.540828 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m15:57:09.540828 [debug] [MainThread]: Command `dbt run` succeeded at 15:57:09.540828 after 6.14 seconds
[0m15:57:09.540828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221AD9D4FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221AE7F1C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C10654B0>]}
[0m15:57:09.540828 [debug] [MainThread]: Flushing usage events
[0m15:57:10.879373 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:24:01.385977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E463B17A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E464EA0B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E464EA09A0>]}


============================== 16:24:01.385977 | 4a115343-40df-4413-b9a4-3b52af0a0b21 ==============================
[0m16:24:01.385977 [info ] [MainThread]: Running with dbt=1.11.4
[0m16:24:01.401837 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jeeva\\.dbt', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jeeva\\Desktop\\data_ai_assignment\\dbt_project\\logs'}
[0m16:24:02.400940 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m16:24:02.400940 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m16:24:02.400940 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m16:24:02.781075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a115343-40df-4413-b9a4-3b52af0a0b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E464EA1300>]}
[0m16:24:02.859917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a115343-40df-4413-b9a4-3b52af0a0b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E464C200D0>]}
[0m16:24:02.859917 [info ] [MainThread]: Registered adapter: snowflake=1.11.2
[0m16:24:03.412295 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m16:24:03.710429 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:24:03.710429 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models\marts\fct_product_snapshot.sql
[0m16:24:03.712435 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models\marts\dim_product.sql
[0m16:24:04.154182 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on
'fct_product_snapshot' in package 'dbt_project' (models\schema.yml). Arguments
to generic tests should be nested under the `arguments` property.
[0m16:24:04.154182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4a115343-40df-4413-b9a4-3b52af0a0b21', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E47751D0C0>]}
[0m16:24:04.315540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a115343-40df-4413-b9a4-3b52af0a0b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E477888130>]}
[0m16:24:04.455347 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\manifest.json
[0m16:24:04.455347 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\semantic_manifest.json
[0m16:24:04.497902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a115343-40df-4413-b9a4-3b52af0a0b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E4773F55A0>]}
[0m16:24:04.497902 [info ] [MainThread]: Found 3 models, 9 data tests, 1 source, 522 macros
[0m16:24:04.497902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a115343-40df-4413-b9a4-3b52af0a0b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E47741A3E0>]}
[0m16:24:04.501067 [info ] [MainThread]: 
[0m16:24:04.502822 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:24:04.502822 [info ] [MainThread]: 
[0m16:24:04.502822 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:24:04.502822 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_INDUSTRIAL_PROCUREMENT_DB'
[0m16:24:04.755757 [debug] [ThreadPool]: Using snowflake connection "list_INDUSTRIAL_PROCUREMENT_DB"
[0m16:24:04.755757 [debug] [ThreadPool]: On list_INDUSTRIAL_PROCUREMENT_DB: show terse schemas in database INDUSTRIAL_PROCUREMENT_DB
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_INDUSTRIAL_PROCUREMENT_DB"} */
[0m16:24:04.755757 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:24:05.508626 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.742 seconds
[0m16:24:05.513205 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS'
[0m16:24:05.540074 [debug] [ThreadPool]: Using snowflake connection "list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS"
[0m16:24:05.540074 [debug] [ThreadPool]: On list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS: show objects in INDUSTRIAL_PROCUREMENT_DB.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS"} */;
[0m16:24:05.540074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:24:06.299645 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.769 seconds
[0m16:24:06.315689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a115343-40df-4413-b9a4-3b52af0a0b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E460DCB010>]}
[0m16:24:06.315689 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_product_catalog
[0m16:24:06.315689 [info ] [Thread-2 (]: 1 of 3 START sql view model ANALYTICS.stg_product_catalog ...................... [RUN]
[0m16:24:06.315689 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.dbt_project.stg_product_catalog'
[0m16:24:06.315689 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_product_catalog
[0m16:24:06.331572 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_product_catalog"
[0m16:24:06.331572 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_product_catalog
[0m16:24:06.371329 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_product_catalog"
[0m16:24:06.373334 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.stg_product_catalog"
[0m16:24:06.375340 [debug] [Thread-2 (]: On model.dbt_project.stg_product_catalog: create or replace   view INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog
  
  
  
  
  as (
    WITH base AS (

    SELECT
        ingestion_id,

        raw_product_json:title::string               AS product_name,
        REPLACE(raw_product_json:productBrand::string, 'By ', '') AS brand,
        COALESCE(
            raw_product_json:addToCart:action:params:sku::string,
            raw_product_json:sku::string
        ) AS sku,
        raw_product_json:inStock::boolean            AS in_stock,

        NULLIF(raw_product_json:rating:average::float, 0) AS avg_rating,
        raw_product_json:rating:totalReviews::int AS review_count,

        raw_product_json:pricing:prices[0]:value::number(10,2) AS selling_price,
        raw_product_json:pricing:prices[1]:value::number(10,2) AS tax_exclusive_price,

        scraped_at,
        page_url,
        category,
        COALESCE(
            raw_product_json:skuLeadTime::string,
            raw_product_json:oosAvailable::string
        ) AS lead_time


    FROM INDUSTRIAL_PROCUREMENT_DB.RAW.product_ingestion
    WHERE raw_product_json:addToCart:action:params:sku IS NOT NULL


),

country AS (

    SELECT
        r.ingestion_id,
        nv.value:value::string AS country_of_origin

    FROM INDUSTRIAL_PROCUREMENT_DB.RAW.product_ingestion r,
    LATERAL FLATTEN(input => r.raw_product_json:familyData:nonVariants) nv
    WHERE nv.value:name::string = 'Country of Origin'
)

SELECT
    b.*,
    c.country_of_origin
FROM base b
LEFT JOIN country c
ON b.ingestion_id = c.ingestion_id
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_product_catalog"} */;
[0m16:24:06.375340 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:24:06.894919 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.520 seconds
[0m16:24:06.926679 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a115343-40df-4413-b9a4-3b52af0a0b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E464EA2920>]}
[0m16:24:06.926679 [info ] [Thread-2 (]: 1 of 3 OK created sql view model ANALYTICS.stg_product_catalog ................. [[32mSUCCESS 1[0m in 0.60s]
[0m16:24:06.926679 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_product_catalog
[0m16:24:06.926679 [debug] [Thread-2 (]: Began running node model.dbt_project.dim_product
[0m16:24:06.926679 [info ] [Thread-2 (]: 2 of 3 START sql view model ANALYTICS.dim_product .............................. [RUN]
[0m16:24:06.926679 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_product_catalog, now model.dbt_project.dim_product)
[0m16:24:06.926679 [debug] [Thread-2 (]: Began compiling node model.dbt_project.dim_product
[0m16:24:06.938103 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.dim_product"
[0m16:24:06.938103 [debug] [Thread-2 (]: Began executing node model.dbt_project.dim_product
[0m16:24:06.944121 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.dim_product"
[0m16:24:06.946127 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.dim_product"
[0m16:24:06.946127 [debug] [Thread-2 (]: On model.dbt_project.dim_product: create or replace   view INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.dim_product
  
  
  
  
  as (
    

WITH deduplicated AS (

    SELECT
        sku,

        ANY_VALUE(product_name) AS product_name,
        ANY_VALUE(brand) AS brand,
        ANY_VALUE(category) AS category,
        ANY_VALUE(page_url) AS product_url,

        -- Country cleaning
        COALESCE(ANY_VALUE(country_of_origin), 'Not Applicable') AS country_of_origin,

        -- Lead time text
        ANY_VALUE(lead_time) AS raw_lead_time,

        -- Rating cleaning
        COALESCE(ANY_VALUE(avg_rating), 0) AS avg_rating,
        COALESCE(ANY_VALUE(review_count), 0) AS review_count

    FROM INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog
    WHERE sku IS NOT NULL
    GROUP BY sku
),

leadtime_cleaned AS (

    SELECT
        sku,
        product_name,
        brand,
        category,
        product_url,
        country_of_origin,
        avg_rating,
        review_count,

        ---------------------------------------------------
        -- Convert lead time text → numeric days
        ---------------------------------------------------
        CASE
            -- "Ships within 24 hrs"
            WHEN raw_lead_time ILIKE '%hrs%' THEN
                CEIL(TRY_TO_NUMBER(REGEXP_SUBSTR(raw_lead_time, '\\d+')) / 24)

            -- "Ships within 2 days"
            WHEN raw_lead_time ILIKE '%days%' THEN
                TRY_TO_NUMBER(REGEXP_SUBSTR(raw_lead_time, '\\d+'))

            -- Unknown lead time
            ELSE NULL
        END AS lead_time_days

    FROM deduplicated
)

SELECT
    MD5(sku) AS product_id,
    sku,
    product_name,
    brand,
    category,
    product_url,
    country_of_origin,
    lead_time_days,
    avg_rating,
    review_count
FROM leadtime_cleaned
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_product"} */;
[0m16:24:07.163797 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.215 seconds
[0m16:24:07.177954 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a115343-40df-4413-b9a4-3b52af0a0b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E478041450>]}
[0m16:24:07.179971 [info ] [Thread-2 (]: 2 of 3 OK created sql view model ANALYTICS.dim_product ......................... [[32mSUCCESS 1[0m in 0.25s]
[0m16:24:07.183617 [debug] [Thread-2 (]: Finished running node model.dbt_project.dim_product
[0m16:24:07.183617 [debug] [Thread-2 (]: Began running node model.dbt_project.fct_product_snapshot
[0m16:24:07.188129 [info ] [Thread-2 (]: 3 of 3 START sql view model ANALYTICS.fct_product_snapshot ..................... [RUN]
[0m16:24:07.188129 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_product, now model.dbt_project.fct_product_snapshot)
[0m16:24:07.188129 [debug] [Thread-2 (]: Began compiling node model.dbt_project.fct_product_snapshot
[0m16:24:07.188129 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.fct_product_snapshot"
[0m16:24:07.188129 [debug] [Thread-2 (]: Began executing node model.dbt_project.fct_product_snapshot
[0m16:24:07.199544 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.fct_product_snapshot"
[0m16:24:07.199544 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.fct_product_snapshot"
[0m16:24:07.199544 [debug] [Thread-2 (]: On model.dbt_project.fct_product_snapshot: create or replace   view INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.fct_product_snapshot
  
  
  
  
  as (
    SELECT
    d.product_id,
    s.selling_price,
    s.tax_exclusive_price,
    s.avg_rating,
    s.review_count,
    s.in_stock,
    s.scraped_at
FROM INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog s
JOIN INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.dim_product d
    ON s.sku = d.sku
  )
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.fct_product_snapshot"} */;
[0m16:24:07.492388 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.288 seconds
[0m16:24:07.492388 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a115343-40df-4413-b9a4-3b52af0a0b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E477F32020>]}
[0m16:24:07.492388 [info ] [Thread-2 (]: 3 of 3 OK created sql view model ANALYTICS.fct_product_snapshot ................ [[32mSUCCESS 1[0m in 0.30s]
[0m16:24:07.492388 [debug] [Thread-2 (]: Finished running node model.dbt_project.fct_product_snapshot
[0m16:24:07.492388 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:24:07.492388 [debug] [MainThread]: Connection 'list_INDUSTRIAL_PROCUREMENT_DB' was left open.
[0m16:24:07.492388 [debug] [MainThread]: On list_INDUSTRIAL_PROCUREMENT_DB: Close
[0m16:24:07.619266 [debug] [MainThread]: Connection 'list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS' was left open.
[0m16:24:07.619266 [debug] [MainThread]: On list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS: Close
[0m16:24:07.763470 [debug] [MainThread]: Connection 'model.dbt_project.fct_product_snapshot' was left open.
[0m16:24:07.771325 [debug] [MainThread]: On model.dbt_project.fct_product_snapshot: Close
[0m16:24:07.907606 [info ] [MainThread]: 
[0m16:24:07.907606 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 3.40 seconds (3.40s).
[0m16:24:07.923401 [debug] [MainThread]: Command end result
[0m16:24:07.955248 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\manifest.json
[0m16:24:07.955248 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\semantic_manifest.json
[0m16:24:07.971104 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\run_results.json
[0m16:24:07.971104 [info ] [MainThread]: 
[0m16:24:07.971104 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:24:07.971104 [info ] [MainThread]: 
[0m16:24:07.971104 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m16:24:07.971104 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:24:07.971104 [debug] [MainThread]: Command `dbt run` succeeded at 16:24:07.971104 after 6.70 seconds
[0m16:24:07.971104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E463B17A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E464C200D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E4773DE9B0>]}
[0m16:24:07.971104 [debug] [MainThread]: Flushing usage events
[0m16:24:09.315570 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:44:36.443979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228BF18FC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C0520F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C0520D30>]}


============================== 21:44:36.443979 | 1975d7c1-df2a-4d75-bc9a-ff447427d36f ==============================
[0m21:44:36.443979 [info ] [MainThread]: Running with dbt=1.11.4
[0m21:44:36.443979 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jeeva\\.dbt', 'invocation_command': 'dbt test', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jeeva\\Desktop\\data_ai_assignment\\dbt_project\\logs'}
[0m21:44:37.442084 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m21:44:37.442084 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m21:44:37.442084 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m21:44:37.808896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1975d7c1-df2a-4d75-bc9a-ff447427d36f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228D1416E00>]}
[0m21:44:37.904843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1975d7c1-df2a-4d75-bc9a-ff447427d36f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228BFD86860>]}
[0m21:44:37.904843 [info ] [MainThread]: Registered adapter: snowflake=1.11.2
[0m21:44:38.446662 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m21:44:38.766280 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:44:38.766280 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m21:44:38.768286 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:44:38.845188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1975d7c1-df2a-4d75-bc9a-ff447427d36f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228D2AF4A90>]}
[0m21:44:38.995229 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\manifest.json
[0m21:44:38.997235 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\semantic_manifest.json
[0m21:44:39.035213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1975d7c1-df2a-4d75-bc9a-ff447427d36f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228D2A723B0>]}
[0m21:44:39.035213 [info ] [MainThread]: Found 3 models, 9 data tests, 1 source, 522 macros
[0m21:44:39.035213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1975d7c1-df2a-4d75-bc9a-ff447427d36f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228D166AA40>]}
[0m21:44:39.035213 [info ] [MainThread]: 
[0m21:44:39.035213 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:44:39.035213 [info ] [MainThread]: 
[0m21:44:39.035213 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:44:39.050711 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS'
[0m21:44:39.290001 [debug] [ThreadPool]: Using snowflake connection "list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS"
[0m21:44:39.290001 [debug] [ThreadPool]: On list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS: show objects in INDUSTRIAL_PROCUREMENT_DB.ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS"} */;
[0m21:44:39.290001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:44:40.903116 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.622 seconds
[0m21:44:40.913934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1975d7c1-df2a-4d75-bc9a-ff447427d36f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228D2A723B0>]}
[0m21:44:40.913934 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_dim_product_product_id.02b1f06816
[0m21:44:40.913934 [info ] [Thread-2 (]: 1 of 9 START test not_null_dim_product_product_id .............................. [RUN]
[0m21:44:40.913934 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_project.not_null_dim_product_product_id.02b1f06816'
[0m21:44:40.913934 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_dim_product_product_id.02b1f06816
[0m21:44:40.945439 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_product_product_id.02b1f06816"
[0m21:44:40.947446 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_dim_product_product_id.02b1f06816
[0m21:44:40.975260 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_dim_product_product_id.02b1f06816"
[0m21:44:40.977006 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_project.not_null_dim_product_product_id.02b1f06816"
[0m21:44:40.977006 [debug] [Thread-2 (]: On test.dbt_project.not_null_dim_product_product_id.02b1f06816: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.dim_product
where product_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_dim_product_product_id.02b1f06816"} */
[0m21:44:40.977006 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:44:42.609910 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.636 seconds
[0m21:44:42.621140 [info ] [Thread-2 (]: 1 of 9 PASS not_null_dim_product_product_id .................................... [[32mPASS[0m in 1.71s]
[0m21:44:42.621140 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_dim_product_product_id.02b1f06816
[0m21:44:42.621140 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_dim_product_sku.deecb558ac
[0m21:44:42.621140 [info ] [Thread-2 (]: 2 of 9 START test not_null_dim_product_sku ..................................... [RUN]
[0m21:44:42.621140 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_product_product_id.02b1f06816, now test.dbt_project.not_null_dim_product_sku.deecb558ac)
[0m21:44:42.621140 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_dim_product_sku.deecb558ac
[0m21:44:42.637068 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_product_sku.deecb558ac"
[0m21:44:42.637068 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_dim_product_sku.deecb558ac
[0m21:44:42.637068 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_dim_product_sku.deecb558ac"
[0m21:44:42.637068 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_project.not_null_dim_product_sku.deecb558ac"
[0m21:44:42.637068 [debug] [Thread-2 (]: On test.dbt_project.not_null_dim_product_sku.deecb558ac: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sku
from INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.dim_product
where sku is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_dim_product_sku.deecb558ac"} */
[0m21:44:42.809075 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.168 seconds
[0m21:44:42.814576 [info ] [Thread-2 (]: 2 of 9 PASS not_null_dim_product_sku ........................................... [[32mPASS[0m in 0.19s]
[0m21:44:42.814576 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_dim_product_sku.deecb558ac
[0m21:44:42.821181 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_fct_product_snapshot_product_id.404631bb0e
[0m21:44:42.821181 [info ] [Thread-2 (]: 3 of 9 START test not_null_fct_product_snapshot_product_id ..................... [RUN]
[0m21:44:42.821181 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_product_sku.deecb558ac, now test.dbt_project.not_null_fct_product_snapshot_product_id.404631bb0e)
[0m21:44:42.825778 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_fct_product_snapshot_product_id.404631bb0e
[0m21:44:42.835837 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_fct_product_snapshot_product_id.404631bb0e"
[0m21:44:42.837846 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_fct_product_snapshot_product_id.404631bb0e
[0m21:44:42.843871 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_fct_product_snapshot_product_id.404631bb0e"
[0m21:44:42.845621 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_project.not_null_fct_product_snapshot_product_id.404631bb0e"
[0m21:44:42.845621 [debug] [Thread-2 (]: On test.dbt_project.not_null_fct_product_snapshot_product_id.404631bb0e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.fct_product_snapshot
where product_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_fct_product_snapshot_product_id.404631bb0e"} */
[0m21:44:43.829343 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.991 seconds
[0m21:44:43.829343 [info ] [Thread-2 (]: 3 of 9 PASS not_null_fct_product_snapshot_product_id ........................... [[32mPASS[0m in 1.01s]
[0m21:44:43.843350 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_fct_product_snapshot_product_id.404631bb0e
[0m21:44:43.843350 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_fct_product_snapshot_scraped_at.55b12f8257
[0m21:44:43.843350 [info ] [Thread-2 (]: 4 of 9 START test not_null_fct_product_snapshot_scraped_at ..................... [RUN]
[0m21:44:43.843350 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_fct_product_snapshot_product_id.404631bb0e, now test.dbt_project.not_null_fct_product_snapshot_scraped_at.55b12f8257)
[0m21:44:43.843350 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_fct_product_snapshot_scraped_at.55b12f8257
[0m21:44:43.843350 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_fct_product_snapshot_scraped_at.55b12f8257"
[0m21:44:43.843350 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_fct_product_snapshot_scraped_at.55b12f8257
[0m21:44:43.859311 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_fct_product_snapshot_scraped_at.55b12f8257"
[0m21:44:43.859311 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_project.not_null_fct_product_snapshot_scraped_at.55b12f8257"
[0m21:44:43.859311 [debug] [Thread-2 (]: On test.dbt_project.not_null_fct_product_snapshot_scraped_at.55b12f8257: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select scraped_at
from INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.fct_product_snapshot
where scraped_at is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_fct_product_snapshot_scraped_at.55b12f8257"} */
[0m21:44:44.069150 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.205 seconds
[0m21:44:44.081042 [info ] [Thread-2 (]: 4 of 9 PASS not_null_fct_product_snapshot_scraped_at ........................... [[32mPASS[0m in 0.24s]
[0m21:44:44.086624 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_fct_product_snapshot_scraped_at.55b12f8257
[0m21:44:44.086624 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_product_catalog_ingestion_id.4f666912e8
[0m21:44:44.086624 [info ] [Thread-2 (]: 5 of 9 START test not_null_stg_product_catalog_ingestion_id .................... [RUN]
[0m21:44:44.086624 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_fct_product_snapshot_scraped_at.55b12f8257, now test.dbt_project.not_null_stg_product_catalog_ingestion_id.4f666912e8)
[0m21:44:44.086624 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_product_catalog_ingestion_id.4f666912e8
[0m21:44:44.086624 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_product_catalog_ingestion_id.4f666912e8"
[0m21:44:44.086624 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_product_catalog_ingestion_id.4f666912e8
[0m21:44:44.102489 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_product_catalog_ingestion_id.4f666912e8"
[0m21:44:44.102489 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_project.not_null_stg_product_catalog_ingestion_id.4f666912e8"
[0m21:44:44.102489 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_product_catalog_ingestion_id.4f666912e8: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ingestion_id
from INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog
where ingestion_id is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_product_catalog_ingestion_id.4f666912e8"} */
[0m21:44:44.264758 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.160 seconds
[0m21:44:44.264758 [info ] [Thread-2 (]: 5 of 9 PASS not_null_stg_product_catalog_ingestion_id .......................... [[32mPASS[0m in 0.18s]
[0m21:44:44.280619 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_product_catalog_ingestion_id.4f666912e8
[0m21:44:44.280619 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_product_catalog_sku.af3b21f368
[0m21:44:44.280619 [info ] [Thread-2 (]: 6 of 9 START test not_null_stg_product_catalog_sku ............................. [RUN]
[0m21:44:44.280619 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_product_catalog_ingestion_id.4f666912e8, now test.dbt_project.not_null_stg_product_catalog_sku.af3b21f368)
[0m21:44:44.280619 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_product_catalog_sku.af3b21f368
[0m21:44:44.296555 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_product_catalog_sku.af3b21f368"
[0m21:44:44.296555 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_product_catalog_sku.af3b21f368
[0m21:44:44.296555 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_product_catalog_sku.af3b21f368"
[0m21:44:44.296555 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_project.not_null_stg_product_catalog_sku.af3b21f368"
[0m21:44:44.296555 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_product_catalog_sku.af3b21f368: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sku
from INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog
where sku is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_product_catalog_sku.af3b21f368"} */
[0m21:44:44.441306 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.139 seconds
[0m21:44:44.457048 [info ] [Thread-2 (]: 6 of 9 PASS not_null_stg_product_catalog_sku ................................... [[32mPASS[0m in 0.18s]
[0m21:44:44.457048 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_product_catalog_sku.af3b21f368
[0m21:44:44.457048 [debug] [Thread-2 (]: Began running node test.dbt_project.relationships_fct_product_snapshot_product_id__product_id__ref_dim_product_.b5b14dc249
[0m21:44:44.457048 [info ] [Thread-2 (]: 7 of 9 START test relationships_fct_product_snapshot_product_id__product_id__ref_dim_product_  [RUN]
[0m21:44:44.472979 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_product_catalog_sku.af3b21f368, now test.dbt_project.relationships_fct_product_snapshot_product_id__product_id__ref_dim_product_.b5b14dc249)
[0m21:44:44.472979 [debug] [Thread-2 (]: Began compiling node test.dbt_project.relationships_fct_product_snapshot_product_id__product_id__ref_dim_product_.b5b14dc249
[0m21:44:44.489138 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.relationships_fct_product_snapshot_product_id__product_id__ref_dim_product_.b5b14dc249"
[0m21:44:44.489138 [debug] [Thread-2 (]: Began executing node test.dbt_project.relationships_fct_product_snapshot_product_id__product_id__ref_dim_product_.b5b14dc249
[0m21:44:44.489138 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.relationships_fct_product_snapshot_product_id__product_id__ref_dim_product_.b5b14dc249"
[0m21:44:44.489138 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_project.relationships_fct_product_snapshot_product_id__product_id__ref_dim_product_.b5b14dc249"
[0m21:44:44.489138 [debug] [Thread-2 (]: On test.dbt_project.relationships_fct_product_snapshot_product_id__product_id__ref_dim_product_.b5b14dc249: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.fct_product_snapshot
    where product_id is not null
),

parent as (
    select product_id as to_field
    from INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.dim_product
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_fct_product_snapshot_product_id__product_id__ref_dim_product_.b5b14dc249"} */
[0m21:44:45.036790 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.547 seconds
[0m21:44:45.052624 [info ] [Thread-2 (]: 7 of 9 PASS relationships_fct_product_snapshot_product_id__product_id__ref_dim_product_  [[32mPASS[0m in 0.58s]
[0m21:44:45.052624 [debug] [Thread-2 (]: Finished running node test.dbt_project.relationships_fct_product_snapshot_product_id__product_id__ref_dim_product_.b5b14dc249
[0m21:44:45.052624 [debug] [Thread-2 (]: Began running node test.dbt_project.unique_dim_product_product_id.46495bf7fe
[0m21:44:45.052624 [info ] [Thread-2 (]: 8 of 9 START test unique_dim_product_product_id ................................ [RUN]
[0m21:44:45.052624 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_fct_product_snapshot_product_id__product_id__ref_dim_product_.b5b14dc249, now test.dbt_project.unique_dim_product_product_id.46495bf7fe)
[0m21:44:45.052624 [debug] [Thread-2 (]: Began compiling node test.dbt_project.unique_dim_product_product_id.46495bf7fe
[0m21:44:45.068785 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.unique_dim_product_product_id.46495bf7fe"
[0m21:44:45.068785 [debug] [Thread-2 (]: Began executing node test.dbt_project.unique_dim_product_product_id.46495bf7fe
[0m21:44:45.068785 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.unique_dim_product_product_id.46495bf7fe"
[0m21:44:45.068785 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_project.unique_dim_product_product_id.46495bf7fe"
[0m21:44:45.068785 [debug] [Thread-2 (]: On test.dbt_project.unique_dim_product_product_id.46495bf7fe: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.dim_product
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_dim_product_product_id.46495bf7fe"} */
[0m21:44:45.373013 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.290 seconds
[0m21:44:45.376797 [info ] [Thread-2 (]: 8 of 9 PASS unique_dim_product_product_id ...................................... [[32mPASS[0m in 0.32s]
[0m21:44:45.376797 [debug] [Thread-2 (]: Finished running node test.dbt_project.unique_dim_product_product_id.46495bf7fe
[0m21:44:45.376797 [debug] [Thread-2 (]: Began running node test.dbt_project.unique_stg_product_catalog_ingestion_id.99dfc026eb
[0m21:44:45.379767 [info ] [Thread-2 (]: 9 of 9 START test unique_stg_product_catalog_ingestion_id ...................... [RUN]
[0m21:44:45.379767 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_dim_product_product_id.46495bf7fe, now test.dbt_project.unique_stg_product_catalog_ingestion_id.99dfc026eb)
[0m21:44:45.379767 [debug] [Thread-2 (]: Began compiling node test.dbt_project.unique_stg_product_catalog_ingestion_id.99dfc026eb
[0m21:44:45.386556 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.unique_stg_product_catalog_ingestion_id.99dfc026eb"
[0m21:44:45.388562 [debug] [Thread-2 (]: Began executing node test.dbt_project.unique_stg_product_catalog_ingestion_id.99dfc026eb
[0m21:44:45.392577 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.unique_stg_product_catalog_ingestion_id.99dfc026eb"
[0m21:44:45.394583 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_project.unique_stg_product_catalog_ingestion_id.99dfc026eb"
[0m21:44:45.394583 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_product_catalog_ingestion_id.99dfc026eb: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    ingestion_id as unique_field,
    count(*) as n_records

from INDUSTRIAL_PROCUREMENT_DB.ANALYTICS.stg_product_catalog
where ingestion_id is not null
group by ingestion_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_product_catalog_ingestion_id.99dfc026eb"} */
[0m21:44:45.660250 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.264 seconds
[0m21:44:45.665795 [info ] [Thread-2 (]: 9 of 9 PASS unique_stg_product_catalog_ingestion_id ............................ [[32mPASS[0m in 0.29s]
[0m21:44:45.665795 [debug] [Thread-2 (]: Finished running node test.dbt_project.unique_stg_product_catalog_ingestion_id.99dfc026eb
[0m21:44:45.665795 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:44:45.665795 [debug] [MainThread]: Connection 'list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS' was left open.
[0m21:44:45.665795 [debug] [MainThread]: On list_INDUSTRIAL_PROCUREMENT_DB_ANALYTICS: Close
[0m21:44:45.844053 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_product_catalog_ingestion_id.99dfc026eb' was left open.
[0m21:44:45.844053 [debug] [MainThread]: On test.dbt_project.unique_stg_product_catalog_ingestion_id.99dfc026eb: Close
[0m21:44:46.020325 [info ] [MainThread]: 
[0m21:44:46.020325 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 6.99 seconds (6.99s).
[0m21:44:46.020325 [debug] [MainThread]: Command end result
[0m21:44:46.086078 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\manifest.json
[0m21:44:46.086078 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\semantic_manifest.json
[0m21:44:46.104489 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\target\run_results.json
[0m21:44:46.104489 [info ] [MainThread]: 
[0m21:44:46.104489 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:44:46.104489 [info ] [MainThread]: 
[0m21:44:46.108157 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m21:44:46.110168 [debug] [MainThread]: Command `dbt test` succeeded at 21:44:46.108157 after 9.78 seconds
[0m21:44:46.110168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228BF18FC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228D1432230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228D2B2BA90>]}
[0m21:44:46.110168 [debug] [MainThread]: Flushing usage events
[0m21:44:47.546538 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:54:13.569159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F93DD6560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F95128250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F95128070>]}


============================== 21:54:13.569159 | 1b181cf7-caaa-40a5-b75b-9cc431358285 ==============================
[0m21:54:13.569159 [info ] [MainThread]: Running with dbt=1.11.4
[0m21:54:13.569159 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\jeeva\\.dbt', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt debug', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\jeeva\\Desktop\\data_ai_assignment\\dbt_project\\logs'}
[0m21:54:13.600739 [info ] [MainThread]: dbt version: 1.11.4
[0m21:54:13.600739 [info ] [MainThread]: python version: 3.10.19
[0m21:54:13.600739 [info ] [MainThread]: python path: C:\Users\jeeva\miniconda3\envs\data_ai_assessment\python.exe
[0m21:54:13.600739 [info ] [MainThread]: os info: Windows-10-10.0.26200-SP0
[0m21:54:14.568243 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m21:54:14.568243 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m21:54:14.568243 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m21:54:14.663151 [info ] [MainThread]: Using profiles dir at C:\Users\jeeva\.dbt
[0m21:54:14.663151 [info ] [MainThread]: Using profiles.yml file at C:\Users\jeeva\.dbt\profiles.yml
[0m21:54:14.663151 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\jeeva\Desktop\data_ai_assignment\dbt_project\dbt_project.yml
[0m21:54:14.663151 [info ] [MainThread]: adapter type: snowflake
[0m21:54:14.663151 [info ] [MainThread]: adapter version: 1.11.2
[0m21:54:14.884940 [info ] [MainThread]: Configuration:
[0m21:54:14.884940 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:54:14.884940 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:54:14.900962 [info ] [MainThread]: Required dependencies:
[0m21:54:14.900962 [debug] [MainThread]: Executing "git --help"
[0m21:54:14.952578 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Set `HEAD` or the index to a known state\n   switch     Switch branches\n   tag        Create, list, delete or verify tags\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:54:14.952578 [debug] [MainThread]: STDERR: "b''"
[0m21:54:14.952578 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:54:14.952578 [info ] [MainThread]: Connection:
[0m21:54:14.952578 [info ] [MainThread]:   account: rlxazxg-ow84266
[0m21:54:14.952578 [info ] [MainThread]:   user: dbtuser
[0m21:54:14.952578 [info ] [MainThread]:   database: INDUSTRIAL_PROCUREMENT_DB
[0m21:54:14.952578 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m21:54:14.952578 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m21:54:14.952578 [info ] [MainThread]:   schema: ANALYTICS
[0m21:54:14.952578 [info ] [MainThread]:   authenticator: None
[0m21:54:14.952578 [info ] [MainThread]:   oauth_client_id: None
[0m21:54:14.952578 [info ] [MainThread]:   query_tag: None
[0m21:54:14.952578 [info ] [MainThread]:   client_session_keep_alive: False
[0m21:54:14.952578 [info ] [MainThread]:   host: None
[0m21:54:14.964257 [info ] [MainThread]:   port: None
[0m21:54:14.964257 [info ] [MainThread]:   proxy_host: None
[0m21:54:14.964257 [info ] [MainThread]:   proxy_port: None
[0m21:54:14.964257 [info ] [MainThread]:   protocol: None
[0m21:54:14.964257 [info ] [MainThread]:   connect_retries: 1
[0m21:54:14.964257 [info ] [MainThread]:   connect_timeout: None
[0m21:54:14.964257 [info ] [MainThread]:   retry_on_database_errors: False
[0m21:54:14.964257 [info ] [MainThread]:   retry_all: False
[0m21:54:14.964257 [info ] [MainThread]:   insecure_mode: False
[0m21:54:14.964257 [info ] [MainThread]:   reuse_connections: True
[0m21:54:14.964257 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m21:54:14.964257 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m21:54:14.964257 [info ] [MainThread]: Registered adapter: snowflake=1.11.2
[0m21:54:15.505584 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m21:54:15.741587 [debug] [MainThread]: Using snowflake connection "debug"
[0m21:54:15.741587 [debug] [MainThread]: On debug: select 1 as id
[0m21:54:15.741587 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:54:16.482320 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.755 seconds
[0m21:54:16.498219 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:54:16.498219 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:54:16.498219 [debug] [MainThread]: Command `dbt debug` succeeded at 21:54:16.498219 after 3.05 seconds
[0m21:54:16.498219 [debug] [MainThread]: Connection 'debug' was left open.
[0m21:54:16.498219 [debug] [MainThread]: On debug: Close
[0m21:54:16.627330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F93DD6560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FA60EBE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FA5CE13C0>]}
[0m21:54:16.627330 [debug] [MainThread]: Flushing usage events
[0m21:54:17.953397 [debug] [MainThread]: An error was encountered while trying to flush usage events
